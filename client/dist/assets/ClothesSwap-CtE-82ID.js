import{_ as L,c as k,o as x,a as s,b as h,p as _,q as I,s as w,T as a}from"./index-C86wnvRP.js";import"./UnifiedImageProcessingTemplate.vue_vue_type_style_index_0_scoped_1007aace_lang-DFlU2A78.js";import{U as E}from"./UnifiedImageProcessingTemplate-4EyDP7sV.js";import"./MobileActionButton-LKZSR4NQ.js";import"./SvgIcon-BzDbydhb.js";const M={__name:"ClothesSwap",setup(C,{expose:f}){f(),console.log("ClothesSwap组件已加载，ComfyUI服务已导入");const c=s(null),o=s(null),i=s(null),l=s(null),r=s(!1),t=s(""),g=s(""),m=s(""),d=s(0),p=s(null),U=(e,n)=>{console.log("上传变化:",e,n),e==="main-image"&&(o.value=n,l.value=null)},y=async()=>{if(!o.value){a.fail("请先上传人物照片");return}r.value=!0,t.value="正在初始化...",p.value=Date.now();try{console.log("🚀 开始一键褪衣处理");const e=await w(o.value,(n,u)=>{t.value=n,d.value=u||0,console.log(`📊 处理状态: ${n}, 进度: ${u}%`)});if(e.success&&e.resultImage){console.log("✅ 处理成功，显示结果"),l.value=e.resultImage,i.value=e.originalImage||o.value,g.value=e.promptId||"";const n=Date.now(),u=Math.round((n-p.value)/1e3);m.value=`${u}秒`;const D=e.pointsConsumed?`（消耗${e.pointsConsumed}点）`:"";a.success(`🎉 处理完成！${D}`),console.log("✅ 褪衣处理完成")}else throw console.error("❌ 处理失败，结果无效"),new Error(e.error||"褪衣处理失败")}catch(e){console.error("❌ 褪衣处理失败:",e),I(e,"褪衣处理")||a.fail(`处理失败: ${e.message}`)}finally{r.value=!1,t.value="",d.value=0}},T=()=>{if(o.value=null,i.value=null,l.value=null,t.value="",g.value="",m.value="",c.value){const{uploadData:e}=c.value;e["main-image"]&&(e["main-image"]=null)}a.success("已重置，可以重新选择图片")},P=e=>{if(!e)return;const n=document.createElement("a");n.href=e,n.download=`clothes_swap_result_${Date.now()}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),a.success("图片下载已开始")},S=e=>{console.log("用户登录成功:",e)},b=()=>{console.log("用户已登出")};h(()=>{console.log("ClothesSwap组件已挂载，ComfyUI服务已准备就绪")}),_(()=>{r.value&&(r.value=!1)});const v={templateRef:c,selectedImage:o,originalImageForComparison:i,resultImage:l,isLoading:r,processingStatus:t,promptId:g,processingTime:m,progressPercent:d,startTime:p,handleUploadChange:U,processImage:y,resetProcess:T,handleDownload:P,handleUserLogin:S,handleUserLogout:b,ref:s,onMounted:h,onUnmounted:_,get Toast(){return a},get UnifiedImageProcessingTemplate(){return E},get processUndressImage(){return w},get handleError(){return I}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}};function R(C,f,c,o,i,l){return x(),k(o.UnifiedImageProcessingTemplate,{"function-id":"clothes-swap","title-icon-name":"undress-woman","title-icon-color":"var(--van-primary-color)","process-button-icon-name":"undress-woman","is-processing":o.isLoading,progress:o.progressPercent,"processing-description":o.processingStatus,"processing-info":{promptId:o.promptId,processingTime:o.processingTime},"result-data":o.resultImage,"original-image-for-comparison":o.originalImageForComparison,onLogin:o.handleUserLogin,onLogout:o.handleUserLogout,onProcess:o.processImage,onReset:o.resetProcess,onDownload:o.handleDownload,onUploadChange:o.handleUploadChange,ref:"templateRef"},null,8,["is-processing","progress","processing-description","processing-info","result-data","original-image-for-comparison"])}const q=L(M,[["render",R],["__scopeId","data-v-66df3ef7"],["__file","D:/workspace/AIMagic/client/src/views/ClothesSwap.vue"]]);export{q as default};
