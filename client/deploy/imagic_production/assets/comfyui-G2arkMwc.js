const w={4:{inputs:{ckpt_name:"uberRealisticPornMerge_v23FinalSD.safetensors"},class_type:"CheckpointLoaderSimple",_meta:{title:"CheckpointåŠ è½½å™¨ï¼ˆç®€æ˜“ï¼‰"}},20:{inputs:{vae_name:"SD/vae-ft-mse-840000-ema-pruned.safetensors"},class_type:"VAELoader",_meta:{title:"åŠ è½½VAE"}},49:{inputs:{image:"3094c87b9fe9c00f76146f32f36c3beb4839.jpeg"},class_type:"LoadImage",_meta:{title:"åŠ è½½å›¾åƒ"}},107:{inputs:{preset:"PLUS (high strength)",model:["664",0]},class_type:"IPAdapterUnifiedLoader",_meta:{title:"IPAdapteråŠ è½½å™¨"}},115:{inputs:{weight:.8,weight_type:"style transfer",combine_embeds:"concat",start_at:0,end_at:1,embeds_scaling:"V only",model:["107",0],ipadapter:["107",1],image:["319",0],image_negative:["116",0],clip_vision:["194",0]},class_type:"IPAdapterAdvanced",_meta:{title:"åº”ç”¨IPAdapterï¼ˆé«˜çº§ï¼‰"}},116:{inputs:{type:"dissolve",strength:.6,blur:3},class_type:"IPAdapterNoise",_meta:{title:"IPAdapterå™ªæ³¢"}},173:{inputs:{samples:["174",3],vae:["20",0]},class_type:"VAEDecode",_meta:{title:"VAEè§£ç "}},174:{inputs:{add_noise:"enable",noise_seed:815242277936545,steps:35,cfg:3.5,sampler_name:"dpmpp_2m_sde",scheduler:"karras",start_at_step:0,end_at_step:1e4,return_with_leftover_noise:"disable",preview_method:"auto",vae_decode:"false",model:["190",0],positive:["190",1],negative:["190",2],latent_image:["190",3]},class_type:"KSampler Adv. (Efficient)",_meta:{title:"Ké‡‡æ ·å™¨(é«˜çº§æ•ˆç‡)"}},176:{inputs:{kernel:10,sigma:10,inpaint:["173",0],original:["259",0],mask:["177",0],origin:["264",2]},class_type:"BlendInpaint",_meta:{title:"å±€éƒ¨é‡ç»˜ï¼ˆèåˆï¼‰"}},177:{inputs:{expand:5,tapered_corners:!0,mask:["606",0]},class_type:"GrowMask",_meta:{title:"æ‰©å±•é®ç½©"}},186:{inputs:{brushnet:"brushnet_segmentation_mask_fp16.safetensors",dtype:"float16"},class_type:"BrushNetLoader",_meta:{title:"BrushNetï¼ˆåŠ è½½ï¼‰"}},190:{inputs:{scale:.8,start_at:5,end_at:1e4,model:["115",0],vae:["20",0],image:["264",0],mask:["606",0],brushnet:["186",0],positive:["706",0],negative:["706",1]},class_type:"BrushNet",_meta:{title:"BrushNetï¼ˆåº”ç”¨ï¼‰"}},194:{inputs:{clip_name:"CLIP-ViT-H-14-laion2B-s32B-b79K.safetensors"},class_type:"CLIPVisionLoader",_meta:{title:"åŠ è½½CLIPè§†è§‰"}},234:{inputs:{mask_opacity:1,mask_color:"255, 255, 255",pass_through:!1,image:["264",0],mask:["606",0]},class_type:"ImageAndMaskPreview",_meta:{title:"å›¾åƒä¸é®ç½©é¢„è§ˆ"}},257:{inputs:{python_expression:"( (512 + (0 if c > 0 else c)) **2 / (a * b) ) ** 0.5",print_to_console:"True",a:["266",0],b:["266",1],c:["623",0]},class_type:"Evaluate Integers",_meta:{title:"æ•´æ•°è¿ç®—"}},259:{inputs:{upscale_method:"lanczos",scale_by:["257",1],image:["552",0]},class_type:"ImageScaleBy",_meta:{title:"ç¼©æ”¾å›¾åƒï¼ˆæ¯”ä¾‹ï¼‰"}},260:{inputs:{mask:["703",0]},class_type:"MaskToImage",_meta:{title:"é®ç½©è½¬æ¢ä¸ºå›¾åƒ"}},261:{inputs:{upscale_method:"lanczos",scale_by:["257",1],image:["260",0]},class_type:"ImageScaleBy",_meta:{title:"ç¼©æ”¾å›¾åƒï¼ˆæ¯”ä¾‹ï¼‰"}},262:{inputs:{channel:"red",image:["261",0]},class_type:"ImageToMask",_meta:{title:"å›¾åƒè½¬æ¢ä¸ºé®ç½©"}},264:{inputs:{width:["575",0],height:["576",0],image:["259",0],mask:["262",0]},class_type:"CutForInpaint",_meta:{title:"å±€éƒ¨é‡ç»˜ï¼ˆè£å‰ªï¼‰"}},265:{inputs:{image_crop_multi:1,mask_crop_multi:1,bbox_smooth_alpha:1,image:["552",0],mask:["512",0]},class_type:"easy imageCropFromMask",_meta:{title:"é®ç½©è£å‰ªå›¾åƒ"}},266:{inputs:{image:["265",0]},class_type:"easy imageSize",_meta:{title:"å›¾åƒå°ºå¯¸"}},285:{inputs:{text:`completely_nude:1.5,bald_girl, ruanyi0336,
`,token_normalization:"none",weight_interpretation:"A1111",speak_and_recognation:{__value__:[!1,!0]},clip:["664",1]},class_type:"BNK_CLIPTextEncodeAdvanced",_meta:{title:"CLIPæ–‡æœ¬ç¼–ç å™¨(BNK)"}},286:{inputs:{text:`clothing,public_hair,navel_piercing

(deformed iris, deformed pupils, semi-realistic, cgi, 3d, render, sketch, cartoon, drawing, anime), text, cropped, out of frame, worst quality, low quality, jpeg artifacts, ugly, duplicate, morbid, mutilated, extra fingers, mutated hands, poorly drawn hands, poorly drawn face, mutation, deformed, blurry, dehydrated, bad anatomy, bad proportions, extra limbs, cloned face, disfigured, gross proportions, malformed limbs, missing arms, missing legs, extra arms, extra legs, fused fingers, too many fingers, long neck,`,token_normalization:"none",weight_interpretation:"A1111",speak_and_recognation:{__value__:[!1,!0]},clip:["664",1]},class_type:"BNK_CLIPTextEncodeAdvanced",_meta:{title:"CLIPæ–‡æœ¬ç¼–ç å™¨(BNK)"}},319:{inputs:{interpolation:"LANCZOS",crop_position:"center",sharpening:.15,image:["531",0]},class_type:"PrepImageForClipVision",_meta:{title:"CLIPè§†è§‰å›¾åƒå¤„ç†"}},481:{inputs:{expand:15,incremental_expandrate:0,tapered_corners:!0,flip_input:!1,blur_radius:5,lerp_alpha:1,decay_factor:1,fill_holes:!0,mask:["545",0]},class_type:"GrowMaskWithBlur",_meta:{title:"é®ç½©æ¨¡ç³Šç”Ÿé•¿"}},492:{inputs:{x:0,y:0,operation:"add",destination:["721",1],source:["556",0]},class_type:"MaskComposite",_meta:{title:"åˆæˆé®ç½©"}},496:{inputs:{directory:"/workspace/input",image_load_cap:1,skip_first_images:54,select_every_nth:1},class_type:"VHS_LoadImagesPath",_meta:{title:"åŠ è½½å›¾åƒï¼ˆè·¯å¾„ï¼‰"}},512:{inputs:{erode_dilate:0,fill_holes:0,remove_isolated_pixels:10,smooth:0,blur:0,mask:["481",0]},class_type:"MaskFix+",_meta:{title:"é®ç½©ä¿®å¤"}},531:{inputs:{image_crop_multi:1,mask_crop_multi:1,bbox_smooth_alpha:1,image:["552",0],mask:["719",1]},class_type:"easy imageCropFromMask",_meta:{title:"é®ç½©è£å‰ªå›¾åƒ"}},545:{inputs:{boolean:["549",0],on_true:["492",0],on_false:["556",0]},class_type:"easy ifElse",_meta:{title:"æ˜¯å¦åˆ¤æ–­"}},549:{inputs:{value:!0},class_type:"easy boolean",_meta:{title:"å¸ƒå°”"}},552:{inputs:{boolean:["553",0],on_true:["496",0],on_false:["49",0]},class_type:"easy ifElse",_meta:{title:"æ˜¯å¦åˆ¤æ–­"}},553:{inputs:{value:!1},class_type:"easy boolean",_meta:{title:"å¸ƒå°”"}},556:{inputs:{boolean:["553",0],on_true:["496",1],on_false:["49",1]},class_type:"easy ifElse",_meta:{title:"æ˜¯å¦åˆ¤æ–­"}},562:{inputs:{mask_opacity:1,mask_color:"255, 255, 255",pass_through:!1,image:["552",0],mask:["492",0]},class_type:"ImageAndMaskPreview",_meta:{title:"å›¾åƒä¸é®ç½©é¢„è§ˆ"}},563:{inputs:{detect_hand:"enable",detect_body:"enable",detect_face:"enable",resolution:["626",0],bbox_detector:"yolox_l.onnx",pose_estimator:"dw-ll_ucoco_384_bs5.torchscript.pt",scale_stick_for_xinsr_cn:"disable",image:["264",0]},class_type:"DWPreprocessor",_meta:{title:"DWå§¿æ€é¢„å¤„ç†å™¨"}},572:{inputs:{image:["552",0]},class_type:"easy imageSize",_meta:{title:"å›¾åƒå°ºå¯¸"}},573:{inputs:{upscale_method:"lanczos",width:["572",0],height:["572",1],crop:"disabled",image:["176",0]},class_type:"ImageScale",_meta:{title:"ç¼©æ”¾å›¾åƒ"}},575:{inputs:{expression:`a * b + 10


`,speak_and_recognation:{__value__:[!1,!0]},a:["583",0],b:["257",1]},class_type:"MathExpression|pysssss",_meta:{title:"æ•°å­¦è¡¨è¾¾å¼"}},576:{inputs:{expression:`a * b + 10
`,speak_and_recognation:{__value__:[!1,!0]},a:["583",1],b:["257",1]},class_type:"MathExpression|pysssss",_meta:{title:"æ•°å­¦è¡¨è¾¾å¼"}},583:{inputs:{image:["594",0]},class_type:"easy imageSize",_meta:{title:"å›¾åƒå°ºå¯¸"}},585:{inputs:{x:0,y:0,operation:"add",destination:["722",1],source:["512",0]},class_type:"MaskComposite",_meta:{title:"åˆæˆé®ç½©"}},588:{inputs:{image:["594",0]},class_type:"easy imageSize",_meta:{title:"å›¾åƒå°ºå¯¸"}},590:{inputs:{mask_opacity:1,mask_color:"255, 255, 255",pass_through:!1,image:["552",0],mask:["703",0]},class_type:"ImageAndMaskPreview",_meta:{title:"å›¾åƒä¸é®ç½©é¢„è§ˆ"}},594:{inputs:{image_crop_multi:1,mask_crop_multi:1,bbox_smooth_alpha:1,image:["552",0],mask:["703",0]},class_type:"easy imageCropFromMask",_meta:{title:"é®ç½©è£å‰ªå›¾åƒ"}},596:{inputs:{width:["588",0],height:["588",1],image:["552",0],mask:["703",0]},class_type:"CutForInpaint",_meta:{title:"å±€éƒ¨é‡ç»˜ï¼ˆè£å‰ªï¼‰"}},602:{inputs:{width:["575",0],height:["576",0],image:["604",0],mask:["262",0]},class_type:"CutForInpaint",_meta:{title:"å±€éƒ¨é‡ç»˜ï¼ˆè£å‰ªï¼‰"}},603:{inputs:{mask:["512",0]},class_type:"MaskToImage",_meta:{title:"é®ç½©è½¬æ¢ä¸ºå›¾åƒ"}},604:{inputs:{upscale_method:"lanczos",scale_by:["257",1],image:["603",0]},class_type:"ImageScaleBy",_meta:{title:"ç¼©æ”¾å›¾åƒï¼ˆæ¯”ä¾‹ï¼‰"}},606:{inputs:{channel:"red",image:["602",0]},class_type:"ImageToMask",_meta:{title:"å›¾åƒè½¬æ¢ä¸ºé®ç½©"}},611:{inputs:{mask_opacity:1,mask_color:"255, 255, 255",pass_through:!0,image:["612",0],mask:["612",1]},class_type:"ImageAndMaskPreview",_meta:{title:"å›¾åƒä¸é®ç½©é¢„è§ˆ"}},612:{inputs:{image_crop_multi:1,mask_crop_multi:1,bbox_smooth_alpha:1,image:["264",0],mask:["606",0]},class_type:"easy imageCropFromMask",_meta:{title:"é®ç½©è£å‰ªå›¾åƒ"}},619:{inputs:{image:["611",0]},class_type:"easy imageSize",_meta:{title:"å›¾åƒå°ºå¯¸"}},623:{inputs:{expression:`((c**2) * b / a)**0.5 - 512



`,speak_and_recognation:{__value__:[!1,!0]},a:["628",0],b:["624",0],c:["630",0]},class_type:"MathExpression|pysssss",_meta:{title:"æ•°å­¦è¡¨è¾¾å¼"}},624:{inputs:{expression:`a * b 

`,speak_and_recognation:{__value__:[!1,!0]},a:["266",0],b:["266",1]},class_type:"MathExpression|pysssss",_meta:{title:"æ•°å­¦è¡¨è¾¾å¼"}},626:{inputs:{image:["264",0]},class_type:"easy imageSize",_meta:{title:"å›¾åƒå°ºå¯¸"}},628:{inputs:{expression:`a * b 

`,speak_and_recognation:{__value__:[!1,!0]},a:["583",0],b:["583",1]},class_type:"MathExpression|pysssss",_meta:{title:"æ•°å­¦è¡¨è¾¾å¼"}},630:{inputs:{value:1024},class_type:"easy int",_meta:{title:"æ•´æ•°"}},664:{inputs:{PowerLoraLoaderHeaderWidget:{type:"PowerLoraLoaderHeaderWidget"},lora_1:{on:!0,lora:"0336-One-line-crotch-pantyhose_v1_pony.safetensors",strength:1},"â• Add Lora":"",model:["4",0],clip:["4",1]},class_type:"Power Lora Loader (rgthree)",_meta:{title:"å¼ºåŠ›LoRAåŠ è½½å™¨"}},691:{inputs:{x:0,y:0,operation:"subtract",destination:["492",0],source:["719",1]},class_type:"MaskComposite",_meta:{title:"åˆæˆé®ç½©"}},692:{inputs:{mask_opacity:1,mask_color:"255, 255, 255",pass_through:!1,image:["552",0],mask:["691",0]},class_type:"ImageAndMaskPreview",_meta:{title:"å›¾åƒä¸é®ç½©é¢„è§ˆ"}},703:{inputs:{x:0,y:0,operation:"add",destination:["721",1],source:["585",0]},class_type:"MaskComposite",_meta:{title:"åˆæˆé®ç½©"}},705:{inputs:{control_net_name:"SD15/control_v11p_sd15_openpose_fp16.safetensors"},class_type:"ControlNetLoader",_meta:{title:"åŠ è½½ControlNetæ¨¡å‹"}},706:{inputs:{strength:1,start_percent:0,end_percent:1,positive:["285",0],negative:["286",0],control_net:["705",0],image:["563",0]},class_type:"ControlNetApplyAdvanced",_meta:{title:"åº”ç”¨ControlNetï¼ˆæ—§ç‰ˆé«˜çº§ï¼‰"}},710:{inputs:{images:["573",0]},class_type:"PreviewImage",_meta:{title:"é¢„è§ˆå›¾åƒ"}},713:{inputs:{rgthree_comparer:{images:[{name:"A",selected:!0,url:"/api/view?filename=rgthree.compare._temp_dgmxs_00001_.png&type=temp&subfolder=&rand=0.18539012641484653"},{name:"B",selected:!0,url:"/api/view?filename=rgthree.compare._temp_dgmxs_00002_.png&type=temp&subfolder=&rand=0.04662468838155842"}]},image_a:["573",0],image_b:["49",0]},class_type:"Image Comparer (rgthree)",_meta:{title:"å›¾åƒæ¯”è¾ƒå™¨"}},719:{inputs:{prompt:"face",threshold:.3,sam_model:["727",0],grounding_dino_model:["724",0],image:["552",0]},class_type:"GroundingDinoSAMSegment (segment anything)",_meta:{title:"G-DinoSAMè¯­ä¹‰åˆ†å‰²"}},721:{inputs:{prompt:"clothing",threshold:.3,sam_model:["727",0],grounding_dino_model:["724",0],image:["552",0]},class_type:"GroundingDinoSAMSegment (segment anything)",_meta:{title:"G-DinoSAMè¯­ä¹‰åˆ†å‰²"}},722:{inputs:{prompt:"girl",threshold:.3,sam_model:["727",0],grounding_dino_model:["724",0],image:["552",0]},class_type:"GroundingDinoSAMSegment (segment anything)",_meta:{title:"G-DinoSAMè¯­ä¹‰åˆ†å‰²"}},724:{inputs:{model_name:"GroundingDINO_SwinB (938MB)"},class_type:"GroundingDinoModelLoader (segment anything)",_meta:{title:"G-Dinoæ¨¡å‹åŠ è½½å™¨"}},727:{inputs:{model_name:"sam_hq_vit_h (2.57GB)"},class_type:"SAMModelLoader (segment anything)",_meta:{title:"SAMæ¨¡å‹åŠ è½½å™¨"}}},f={COMFYUI_SERVER_URL:"https://dzqgp58z0s-8188.cnb.run",USE_PROXY:!0,PROXY_SERVER_URL:"http://localhost:3008/api",CLIENT_ID:"abc1373d4ad648a3a81d0587fbe5534b",TIMEOUT:3e5};function u(){const t=localStorage.getItem("comfyui_config");if(t)try{const e=JSON.parse(t);return{...f,...e}}catch(e){console.warn("è§£æä¿å­˜çš„é…ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:",e)}return{...f}}function k(t){try{localStorage.setItem("comfyui_config",JSON.stringify(t)),console.log("ComfyUIé…ç½®å·²ä¿å­˜:",t)}catch(e){console.error("ä¿å­˜é…ç½®å¤±è´¥:",e)}}function x(t){const n={...u(),...t};return k(n),n}function M(){return u()}function y(){const t=u();return t.USE_PROXY?t.PROXY_SERVER_URL:t.COMFYUI_SERVER_URL}function A(){return localStorage.removeItem("comfyui_config"),{...f}}function P(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}async function b(t){try{const e=u(),n=y();if(console.log("ğŸ”„ ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ å›¾ç‰‡åˆ°ComfyUIæœåŠ¡å™¨"),console.log("ğŸ“¡ APIåœ°å€:",`${n}/upload/image`),console.log("ğŸ”§ ä½¿ç”¨ä»£ç†:",e.USE_PROXY?"æ˜¯":"å¦"),!t||!t.startsWith("data:image/"))throw new Error("æ— æ•ˆçš„base64å›¾ç‰‡æ ¼å¼");const a=t.split(",")[1],s=t.split(",")[0].split(":")[1].split(";")[0],i=s.split("/")[1]||"jpg",p=`upload_${Date.now()}_${Math.random().toString(36).substring(7)}.${i}`,r=atob(a),_=new Array(r.length);for(let o=0;o<r.length;o++)_[o]=r.charCodeAt(o);const c=new Uint8Array(_),m=new Blob([c],{type:s});console.log("ğŸ“¤ ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯:",{filename:p,type:s,size:`${(m.size/1024).toFixed(2)} KB`});const g=[{name:"æ ‡å‡†FormDataä¸Šä¼ ",method:async()=>{const o=new FormData;return o.append("image",m,p),o.append("type","input"),o.append("subfolder",""),o.append("overwrite","false"),fetch(`${n}/upload/image`,{method:"POST",body:o,mode:"cors",credentials:"omit"})}},{name:"ç®€åŒ–FormDataä¸Šä¼ ",method:async()=>{const o=new FormData;return o.append("image",m,p),fetch(`${n}/upload/image`,{method:"POST",body:o,mode:"cors",credentials:"omit"})}},{name:"æ— CORSæ¨¡å¼ä¸Šä¼ ",method:async()=>{const o=new FormData;return o.append("image",m,p),o.append("type","input"),fetch(`${e.BASE_URL}/upload/image`,{method:"POST",body:o,mode:"no-cors"})}}];let h=null;for(const o of g)try{console.log(`ğŸ”„ å°è¯•: ${o.name}`);const l=await o.method();if(console.log("ğŸ“¥ ä¸Šä¼ å“åº”çŠ¶æ€:",l.status,l.statusText),l.ok){const d=await l.json();if(console.log("âœ… å›¾ç‰‡ä¸Šä¼ æˆåŠŸ:",d),!d.name)throw new Error("ä¸Šä¼ å“åº”ä¸­ç¼ºå°‘æ–‡ä»¶å");return d.name}else if(l.status!==0){const d=await l.text();console.error(`âŒ ${o.name} å¤±è´¥:`,d),h=new Error(`${o.name} å¤±è´¥: ${l.status} ${l.statusText} - ${d}`)}}catch(l){console.error(`âŒ ${o.name} é”™è¯¯:`,l),h=l;continue}throw h||new Error("æ‰€æœ‰ä¸Šä¼ æ–¹æ³•éƒ½å¤±è´¥äº†")}catch(e){throw console.error("âŒ å›¾ç‰‡ä¸Šä¼ å¤±è´¥:",e),e.message.includes("CORS")?new Error("å›¾ç‰‡ä¸Šä¼ å¤±è´¥: CORSé”™è¯¯ - ComfyUIæœåŠ¡å™¨å¯èƒ½æ²¡æœ‰è®¾ç½®æ­£ç¡®çš„è·¨åŸŸå¤´"):e.message.includes("network")?new Error("å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ç½‘ç»œé”™è¯¯ - è¯·æ£€æŸ¥ComfyUIæœåŠ¡å™¨æ˜¯å¦è¿è¡Œæ­£å¸¸"):new Error(`å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ${e.message}`)}}function I(t){try{const e=JSON.parse(JSON.stringify(w));if(e[49]&&e[49].class_type==="LoadImage")e[49].inputs.image=t,console.log("èŠ‚ç‚¹49å›¾ç‰‡è®¾ç½®ä¸º:",t);else throw new Error("å·¥ä½œæµä¸­æœªæ‰¾åˆ°èŠ‚ç‚¹49æˆ–èŠ‚ç‚¹ç±»å‹ä¸æ­£ç¡®");if(e[174]&&e[174].inputs){const n=Math.floor(Math.random()*1e15);e[174].inputs.noise_seed=n,console.log("éšæœºç§å­è®¾ç½®ä¸º:",n)}return console.log("å·¥ä½œæµé…ç½®å®Œæˆ"),e}catch(e){throw console.error("å·¥ä½œæµåˆ›å»ºå¤±è´¥:",e),new Error(`å·¥ä½œæµåˆ›å»ºå¤±è´¥: ${e.message}`)}}async function S(t){var e,n;try{const a=u(),s=y();console.log("ğŸ”„ ç¬¬äºŒæ­¥ï¼šæäº¤å·¥ä½œæµåˆ°ComfyUI"),console.log("ğŸ“¡ APIåœ°å€:",`${s}/prompt`),console.log("ğŸ”§ ä½¿ç”¨ä»£ç†:",a.USE_PROXY?"æ˜¯":"å¦");const i={client_id:a.CLIENT_ID,prompt:t};console.log("ğŸ“‹ è¯·æ±‚ä½“ç»“æ„:",{client_id:i.client_id,prompt_keys:Object.keys(i.prompt),node_49_exists:!!i.prompt[49],node_49_image:(n=(e=i.prompt[49])==null?void 0:e.inputs)==null?void 0:n.image});const p=`${s}/prompt`;console.log("ğŸŒ è°ƒç”¨å·¥ä½œæµAPI:",p);const r=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),mode:"cors",credentials:"omit"});if(console.log("ğŸ“¥ å·¥ä½œæµå“åº”çŠ¶æ€:",r.status,r.statusText),!r.ok){const c=await r.text();throw console.error("âŒ å·¥ä½œæµæäº¤å¤±è´¥å“åº”:",c),new Error(`å·¥ä½œæµæäº¤å¤±è´¥: ${r.status} ${r.statusText} - ${c}`)}const _=await r.json();if(console.log("âœ… å·¥ä½œæµæäº¤æˆåŠŸ:",_),!_.prompt_id)throw new Error("å·¥ä½œæµå“åº”ä¸­ç¼ºå°‘prompt_id");return _.prompt_id}catch(a){throw console.error("âŒ å·¥ä½œæµæäº¤å¤±è´¥:",a),new Error(`å·¥ä½œæµæäº¤å¤±è´¥: ${a.message}`)}}async function C(t){try{const e=u(),n=y();console.log("ğŸ” æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€:",`${n}/history/${t}`);const a=await fetch(`${n}/history/${t}`);if(!a.ok)throw new Error(`çŠ¶æ€æŸ¥è¯¢å¤±è´¥: ${a.status} ${a.statusText}`);return(await a.json())[t]||null}catch(e){throw console.error("çŠ¶æ€æŸ¥è¯¢å¤±è´¥:",e),new Error(`çŠ¶æ€æŸ¥è¯¢å¤±è´¥: ${e.message}`)}}async function E(t){try{const e=u(),n=y(),a=t.outputs;let s=null;if(a[710]&&a[710].images&&a[710].images.length>0)s=a[710].images[0],console.log("ğŸ“· æ‰¾åˆ°èŠ‚ç‚¹710çš„å¤„ç†ç»“æœå›¾ç‰‡:",s);else{console.log("âš ï¸ èŠ‚ç‚¹710æ— è¾“å‡ºï¼ŒæŸ¥æ‰¾å…¶ä»–èŠ‚ç‚¹...");for(const c in a){const m=a[c];if(m.images&&m.images.length>0){s=m.images[0],console.log(`ğŸ“· æ‰¾åˆ°èŠ‚ç‚¹${c}çš„å›¾ç‰‡:`,s);break}}}if(!s)throw console.error("âŒ æ‰€æœ‰èŠ‚ç‚¹è¾“å‡º:",JSON.stringify(a,null,2)),new Error("æœªæ‰¾åˆ°ç”Ÿæˆçš„å›¾ç‰‡");console.log("ğŸ“· æœ€ç»ˆé€‰æ‹©çš„å›¾ç‰‡:",s);const i=new URLSearchParams({filename:s.filename,type:s.type,subfolder:s.subfolder||""}),p=`${n}/view?${i.toString()}`;console.log("ğŸŒ è·å–å›¾ç‰‡URL:",p);const r=await fetch(p);if(!r.ok)throw new Error(`å›¾ç‰‡è·å–å¤±è´¥: ${r.status}`);const _=await r.blob();return new Promise((c,m)=>{const g=new FileReader;g.onload=()=>c(g.result),g.onerror=m,g.readAsDataURL(_)})}catch(e){throw console.error("å›¾ç‰‡è·å–å¤±è´¥:",e),new Error(`å›¾ç‰‡è·å–å¤±è´¥: ${e.message}`)}}async function v(t,e=3e5){const n=Date.now(),a=2e3;for(;Date.now()-n<e;){const s=await C(t);if(s){if(s.status&&s.status.completed)return s;if(s.status&&s.status.status_str==="error")throw new Error(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${JSON.stringify(s.status)}`)}await new Promise(i=>setTimeout(i,a))}throw new Error("ä»»åŠ¡æ‰§è¡Œè¶…æ—¶")}async function L(t){try{if(console.log("ğŸš€ å¼€å§‹å¤„ç†æ¢è¡£è¯·æ±‚..."),console.log("ğŸ“‹ æµç¨‹ï¼šç¬¬ä¸€æ­¥ä¸Šä¼ å›¾ç‰‡ â†’ ç¬¬äºŒæ­¥æäº¤å·¥ä½œæµ"),console.log("ğŸ” éªŒè¯å›¾ç‰‡æ•°æ®æ ¼å¼..."),!t||!t.startsWith("data:image/"))throw new Error("æ— æ•ˆçš„å›¾ç‰‡æ•°æ®æ ¼å¼");console.log("ğŸ“¤ ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ å›¾ç‰‡åˆ° /api/upload/image");const e=await b(t);console.log("âœ… ç¬¬ä¸€æ­¥å®Œæˆï¼Œè·å¾—æ–‡ä»¶å:",e),console.log("ğŸ”§ é…ç½®å·¥ä½œæµï¼Œå…³è”å›¾ç‰‡åˆ°èŠ‚ç‚¹49...");const n=I(e);console.log("ğŸš€ ç¬¬äºŒæ­¥ï¼šæäº¤å·¥ä½œæµåˆ° /api/prompt");const a=await S(n);console.log("âœ… ç¬¬äºŒæ­¥å®Œæˆï¼Œè·å¾—ä»»åŠ¡ID:",a),console.log("â³ ç­‰å¾…ComfyUIå¤„ç†ä»»åŠ¡...");const s=await v(a);console.log("âœ… ä»»åŠ¡å¤„ç†å®Œæˆ"),console.log("ğŸ“¥ è·å–ç”Ÿæˆçš„å›¾ç‰‡...");const i=await E(s);return console.log("ğŸ‰ æ¢è¡£å¤„ç†å®Œå…¨æˆåŠŸï¼"),{success:!0,resultImage:i,promptId:a,uploadedImageName:e,message:"æ¢è¡£å¤„ç†å®Œæˆ"}}catch(e){return console.error("âŒ æ¢è¡£å¤„ç†å¤±è´¥:",e),{success:!1,error:e.message,message:"æ¢è¡£å¤„ç†å¤±è´¥"}}}export{P as generateClientId,y as getApiBaseUrl,M as getCurrentConfig,L as processUndressImage,A as resetToDefaultConfig,x as updateComfyUIConfig};
