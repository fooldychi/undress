import{r as c,c as _,w as M,a as v,b as E,o as f,d as s,e as d,v as g,f as I,g as V,t as U,n as L,h as Y,i as $,u as x}from"./index-gs9uwCed.js";import{resetToDefaultConfig as P,updateComfyUIConfig as w,getCurrentConfig as X}from"./comfyui-G2arkMwc.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"modal-body"},N={class:"config-section"},h={class:"config-section"},z={class:"config-section"},F={class:"config-section"},A={class:"config-section"},q=["disabled"],B={key:0,class:"loading-spinner"},H={class:"result-icon"},j={class:"result-text"},G={class:"config-section"},W={class:"preset-buttons"},J={class:"modal-footer"},K=["disabled"],Q={__name:"ConfigModal",props:{visible:{type:Boolean,default:!1}},emits:["close","saved"],setup(p,{emit:m}){const u=p,r=m,l=c({COMFYUI_SERVER_URL:"",USE_PROXY:!0,PROXY_SERVER_URL:"http://localhost:3008/api",CLIENT_ID:"",TIMEOUT:3e5}),i=_({get:()=>Math.floor(l.value.TIMEOUT/1e3),set:a=>{l.value.TIMEOUT=a*1e3}}),e=c(!1),o=c(null),R=_(()=>l.value.COMFYUI_SERVER_URL&&l.value.COMFYUI_SERVER_URL.startsWith("http")&&l.value.CLIENT_ID&&l.value.TIMEOUT>0);M(()=>u.visible,a=>{a&&(y(),o.value=null)});const y=()=>{const a=X();l.value={...a}},T=async()=>{if(!R.value){o.value={success:!1,error:"请填写有效的配置信息"};return}e.value=!0,o.value=null;try{const a=l.value.USE_PROXY?`${l.value.PROXY_SERVER_URL}/system_stats`:`${l.value.COMFYUI_SERVER_URL}/system_stats`;console.log("测试连接:",a,"使用代理:",l.value.USE_PROXY);const t=await fetch(a,{method:"GET",signal:AbortSignal.timeout(1e4)});if(t.ok){const n=await t.json();o.value={success:!0,data:n}}else throw new Error(`HTTP ${t.status}: ${t.statusText}`)}catch(a){o.value={success:!1,error:a.message||"连接失败"}}finally{e.value=!1}},b=a=>{switch(a){case"default":l.value={COMFYUI_SERVER_URL:"https://dzqgp58z0s-8188.cnb.run",USE_PROXY:!0,PROXY_SERVER_URL:"http://localhost:3008/api",CLIENT_ID:"abc1373d4ad648a3a81d0587fbe5534b",TIMEOUT:3e5};break;case"local":l.value={COMFYUI_SERVER_URL:"http://localhost:8188",USE_PROXY:!1,PROXY_SERVER_URL:"http://localhost:3008/api",CLIENT_ID:"local_client_id",TIMEOUT:3e5};break;case"current":l.value={COMFYUI_SERVER_URL:"https://dzqgp58z0s-8188.cnb.run",USE_PROXY:!0,PROXY_SERVER_URL:"http://localhost:3008/api",CLIENT_ID:"abc1373d4ad648a3a81d0587fbe5534b",TIMEOUT:3e5};break}o.value=null},S=()=>{R.value&&(w(l.value),r("saved",l.value),C())},k=()=>{const a=P();l.value={...a},o.value=null},C=()=>{r("close")};return(a,t)=>p.visible?(f(),v("div",{key:0,class:"modal-overlay",onClick:C},[s("div",{class:"modal-content",onClick:t[7]||(t[7]=Y(()=>{},["stop"]))},[s("div",{class:"modal-header"},[t[8]||(t[8]=s("h2",null,"ComfyUI 服务器配置",-1)),s("button",{class:"close-btn",onClick:C},"×")]),s("div",D,[t[19]||(t[19]=s("p",{style:{"margin-bottom":"20px",color:"#666","font-size":"14px"}}," 配置原始ComfyUI服务器地址（如: https://dzqgp58z0s-8188.cnb.run） ",-1)),s("div",N,[t[9]||(t[9]=s("label",{for:"comfyui-url"},"ComfyUI服务器地址:",-1)),d(s("input",{id:"comfyui-url","onUpdate:modelValue":t[0]||(t[0]=n=>l.value.COMFYUI_SERVER_URL=n),type:"url",placeholder:"https://dzqgp58z0s-8188.cnb.run",class:"config-input"},null,512),[[g,l.value.COMFYUI_SERVER_URL]]),t[10]||(t[10]=s("small",{class:"help-text"},"原始ComfyUI服务器的完整URL地址",-1))]),s("div",h,[s("label",null,[d(s("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=n=>l.value.USE_PROXY=n),style:{"margin-right":"8px"}},null,512),[[V,l.value.USE_PROXY]]),t[11]||(t[11]=I(" 使用代理服务器（推荐） "))]),t[12]||(t[12]=s("small",{class:"help-text"},"启用代理服务器可以避免CORS跨域问题，提高连接稳定性",-1))]),s("div",z,[t[13]||(t[13]=s("label",{for:"client-id"},"客户端ID:",-1)),d(s("input",{id:"client-id","onUpdate:modelValue":t[2]||(t[2]=n=>l.value.CLIENT_ID=n),type:"text",placeholder:"abc1373d4ad648a3a81d0587fbe5534b",class:"config-input"},null,512),[[g,l.value.CLIENT_ID]]),t[14]||(t[14]=s("small",{class:"help-text"},"用于标识客户端的唯一ID",-1))]),s("div",F,[t[15]||(t[15]=s("label",{for:"timeout"},"请求超时 (秒):",-1)),d(s("input",{id:"timeout","onUpdate:modelValue":t[3]||(t[3]=n=>i.value=n),type:"number",min:"30",max:"600",class:"config-input"},null,512),[[g,i.value,void 0,{number:!0}]]),t[16]||(t[16]=s("small",{class:"help-text"},"API请求的超时时间，建议300秒",-1))]),s("div",A,[t[17]||(t[17]=s("h3",null,"连接测试",-1)),s("button",{onClick:T,disabled:e.value,class:"test-btn"},[e.value?(f(),v("span",B)):E("",!0),I(" "+U(e.value?"测试中...":"测试连接"),1)],8,q),o.value?(f(),v("div",{key:0,class:L(["test-result",{success:o.value.success,error:!o.value.success}])},[s("div",H,U(o.value.success?"✅":"❌"),1),s("div",j,U(o.value.success?"连接成功！":`连接失败: ${o.value.error}`),1)],2)):E("",!0)]),s("div",G,[t[18]||(t[18]=s("h3",null,"预设配置",-1)),s("div",W,[s("button",{onClick:t[4]||(t[4]=n=>b("default")),class:"preset-btn"},"默认配置"),s("button",{onClick:t[5]||(t[5]=n=>b("local")),class:"preset-btn"},"本地开发"),s("button",{onClick:t[6]||(t[6]=n=>b("current")),class:"preset-btn"},"当前地址")])])]),s("div",J,[s("button",{onClick:k,class:"btn btn-secondary"},"重置默认"),s("button",{onClick:S,class:"btn btn-primary",disabled:!R.value},"保存配置",8,K)])])])):E("",!0)}},Z=O(Q,[["__scopeId","data-v-007319ef"]]),ss={class:"home"},ts={class:"container"},es={class:"main"},ls={class:"features"},os={class:"footer"},as={class:"footer-actions"},ns={__name:"HomePage",setup(p){const m=x(),u=c(!1),r=i=>{try{console.log("导航到:",i),m.push(i)}catch(e){console.error("导航失败:",e),alert(`导航到 ${i} 失败，请刷新页面重试`)}},l=i=>{console.log("配置已保存:",i),u.value=!1,alert("配置已保存")};return(i,e)=>(f(),v("div",ss,[s("div",ts,[e[9]||(e[9]=s("header",{class:"header"},[s("h1",{class:"title"},[s("span",{class:"logo"},"🎨"),I(" Imagic - 测试版 ")]),s("p",{class:"subtitle"},"AI驱动的图像处理应用 (Vue正常工作!)")],-1)),s("main",es,[s("div",ls,[s("div",{class:"feature-card",onClick:e[0]||(e[0]=o=>r("/clothes-swap"))},e[5]||(e[5]=[s("div",{class:"feature-icon"},"👔",-1),s("h2",{class:"feature-title"},"一键换衣",-1),s("p",{class:"feature-description"},"智能识别人物轮廓，快速更换照片中的服装款式",-1),s("div",{class:"feature-arrow"},"→",-1)])),s("div",{class:"feature-card",onClick:e[1]||(e[1]=o=>r("/text-to-image"))},e[6]||(e[6]=[s("div",{class:"feature-icon"},"🖼️",-1),s("h2",{class:"feature-title"},"文生图",-1),s("p",{class:"feature-description"},"通过自然语言描述，AI生成高质量的创意图像",-1),s("div",{class:"feature-arrow"},"→",-1)])),s("div",{class:"feature-card",onClick:e[2]||(e[2]=o=>r("/face-swap"))},e[7]||(e[7]=[s("div",{class:"feature-icon"},"😀",-1),s("h2",{class:"feature-title"},"极速换脸",-1),s("p",{class:"feature-description"},"精准面部识别技术，实现自然的人脸替换效果",-1),s("div",{class:"feature-arrow"},"→",-1)]))])]),s("footer",os,[e[8]||(e[8]=s("p",null,"© 2024 Imagic. 基于ComfyUI工作流的AI图像处理平台",-1)),s("div",as,[s("button",{onClick:e[3]||(e[3]=o=>u.value=!u.value),class:"config-btn"},"⚙️ 配置")])]),$(Z,{visible:u.value,onClose:e[4]||(e[4]=o=>u.value=!1),onSaved:l},null,8,["visible"])])]))}},ds=O(ns,[["__scopeId","data-v-788f641e"]]);export{ds as default};
