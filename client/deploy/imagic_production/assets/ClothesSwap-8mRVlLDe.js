import{r as t,j as A,k as $,a as o,o as l,d as s,b as u,i as X,l as z,m as j,f as k,t as p,n as M,p as x,q as F,_ as G}from"./index-gs9uwCed.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"feature-page"},J={class:"container"},K={class:"page-header"},O={class:"page-content"},Q={key:0,class:"upload-section"},W={class:"upload-card"},Y={for:"image-upload",class:"upload-area"},Z={key:0,class:"upload-placeholder"},ee={key:1,class:"image-preview"},se=["src"],ae={key:0,class:"action-section"},te=["disabled"],oe={key:0,class:"loading"},le={key:1,class:"prompt-id"},ne={key:1,class:"result-section"},ie={class:"result-card"},re={class:"comparison-wrapper"},ce={class:"image-layer original-layer"},de=["src"],ue=["src"],ve={class:"process-info"},me={class:"info-item"},pe={class:"info-value"},ge={key:0,class:"info-item"},fe={class:"info-value"},_e={class:"toast-content"},he={class:"toast-message"},ye={__name:"ClothesSwap",setup(be){let h=null;const T=async()=>{try{return h=(await G(()=>import("./comfyui-G2arkMwc.js"),[],import.meta.url)).processUndressImage,console.log("ComfyUIæœåŠ¡åŠ è½½æˆåŠŸ"),!0}catch(a){return console.error("ComfyUIæœåŠ¡åŠ è½½å¤±è´¥:",a),!1}},c=t(null),n=t(null),g=t(!1),i=t(""),v=t(""),y=t(""),d=t(50),b=t(!1),w=t(null),f=t(null),_=t(!1),C=t(""),I=t("success"),U=a=>{const e=a.target.files[0];if(e){if(e.size>10*1024*1024){alert("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB");return}const r=new FileReader;r.onload=m=>{c.value=m.target.result,n.value=null},r.readAsDataURL(e)}},P=async()=>{if(c.value){g.value=!0,i.value="æ­£åœ¨åŠ è½½æœåŠ¡...",f.value=Date.now();try{if(console.log("ğŸš€ å¼€å§‹ä¸€é”®æ¢è¡£å¤„ç†"),!h&&(i.value="æ­£åœ¨åŠ è½½ComfyUIæœåŠ¡...",!await T()))throw new Error("ComfyUIæœåŠ¡åŠ è½½å¤±è´¥");i.value="å¼€å§‹å¤„ç†å›¾ç‰‡...";const a=await h(c.value);if(a&&a.success){if(n.value=a.resultImage,v.value=a.promptId||"",i.value="",f.value){const e=Math.round((Date.now()-f.value)/1e3);y.value=`${e}ç§’`}S("ğŸ‰ å¤„ç†å®Œæˆï¼å¯ä»¥æ‹–æ‹½ä¸­é—´çº¿å¯¹æ¯”æ•ˆæœ","success"),console.log("ğŸ‰ æ¢è¡£å¤„ç†æˆåŠŸ")}else throw new Error((a==null?void 0:a.error)||"å¤„ç†å¤±è´¥")}catch(a){console.error("âŒ å¤„ç†å¤±è´¥:",a),i.value=`âŒ å¤„ç†å¤±è´¥: ${a.message}`;let e="å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•";a.message.includes("ä¸Šä¼ ")?e="å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥":a.message.includes("è¶…æ—¶")?e="å¤„ç†è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•":a.message.includes("å·¥ä½œæµ")?e="æœåŠ¡å™¨å¤„ç†å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•":a.message.includes("ç½‘ç»œ")?e="ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ":a.message.includes("åŠ è½½")&&(e="æœåŠ¡åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•"),alert(e)}finally{g.value=!1}}},S=(a,e="success")=>{C.value=a,I.value=e,_.value=!0,setTimeout(()=>{_.value=!1},3e3)},E=a=>{a.preventDefault(),b.value=!0;const e=m=>{if(!b.value||!w.value)return;const D=w.value.getBoundingClientRect(),R=(m.clientX||m.touches&&m.touches[0].clientX)-D.left,V=Math.max(0,Math.min(100,R/D.width*100));d.value=V},r=()=>{b.value=!1,document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",r)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",r),document.addEventListener("touchmove",e),document.addEventListener("touchend",r)},B=()=>{if(!n.value)return;const a=document.createElement("a");a.href=n.value,a.download=`clothes-swap-result-${Date.now()}.jpg`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},N=()=>{c.value=null,n.value=null,i.value="",v.value="",y.value="",d.value=50,f.value=null;const a=document.getElementById("image-upload");a&&(a.value="")},L=a=>{n.value&&(a.key==="ArrowLeft"?d.value=Math.max(0,d.value-5):a.key==="ArrowRight"&&(d.value=Math.min(100,d.value+5)))};return A(()=>{document.addEventListener("keydown",L)}),$(()=>{document.removeEventListener("keydown",L)}),(a,e)=>{const r=j("router-link");return l(),o("div",H,[s("div",J,[s("header",K,[X(r,{to:"/",class:"back-btn"},{default:z(()=>e[1]||(e[1]=[s("span",{class:"back-icon"},"â†",-1),k(" è¿”å›é¦–é¡µ ")])),_:1,__:[1]}),e[2]||(e[2]=s("h1",{class:"page-title"},[s("span",{class:"page-icon"},"ğŸ‘”"),k(" ä¸€é”®æ¢è¡£ ")],-1)),e[3]||(e[3]=s("p",{class:"page-description"},"ä¸Šä¼ äººç‰©ç…§ç‰‡ï¼ŒAIå°†ä¸ºæ‚¨æ™ºèƒ½æ›´æ¢æœè£…",-1))]),s("main",O,[n.value?u("",!0):(l(),o("div",Q,[s("div",W,[s("input",{type:"file",accept:"image/*",onChange:U,id:"image-upload",class:"hidden"},null,32),s("label",Y,[c.value?(l(),o("div",ee,[s("img",{src:c.value,alt:"é¢„è§ˆå›¾",class:"preview-image"},null,8,se),e[5]||(e[5]=s("div",{class:"image-overlay"},[s("span",null,"ç‚¹å‡»æ›´æ¢å›¾ç‰‡")],-1))])):(l(),o("div",Z,e[4]||(e[4]=[s("div",{class:"upload-icon"},"ğŸ“·",-1),s("h3",null,"é€‰æ‹©å›¾ç‰‡",-1),s("p",null,"æ”¯æŒ JPGã€PNG æ ¼å¼ï¼Œå»ºè®®å°ºå¯¸ 512x512 ä»¥ä¸Š",-1)])))])]),c.value?(l(),o("div",ae,[s("button",{onClick:P,disabled:g.value,class:"btn btn-primary process-btn"},[g.value?(l(),o("span",oe)):u("",!0),k(" "+p(g.value?"å¤„ç†ä¸­...":"å¼€å§‹æ¢è¡£"),1)],8,te),i.value?(l(),o("div",{key:0,class:M(["status-message",{error:i.value.includes("å¤±è´¥")}])},p(i.value),3)):u("",!0),v.value?(l(),o("div",le,[s("small",null,"ä»»åŠ¡ID: "+p(v.value),1)])):u("",!0)])):u("",!0)])),n.value?(l(),o("div",ne,[s("div",ie,[e[11]||(e[11]=s("h3",{class:"result-title"},"æ‹–æ‹½ä¸­é—´çº¿å¯¹æ¯”æ•ˆæœ",-1)),s("div",{class:"image-comparison-container",ref_key:"comparisonContainer",ref:w},[s("div",re,[s("div",ce,[s("img",{src:c.value,alt:"åŸå›¾",class:"comparison-image"},null,8,de),e[6]||(e[6]=s("div",{class:"image-label original-label"},"åŸå›¾",-1))]),s("div",{class:"image-layer result-layer",style:x({clipPath:`inset(0 ${100-d.value}% 0 0)`})},[s("img",{src:n.value,alt:"å¤„ç†ç»“æœ",class:"comparison-image"},null,8,ue),e[7]||(e[7]=s("div",{class:"image-label result-label"},"å¤„ç†ç»“æœ",-1))],4),s("div",{class:"comparison-slider",style:x({left:d.value+"%"}),onMousedown:E,onTouchstart:E},e[8]||(e[8]=[F('<div class="slider-line" data-v-acba8d95></div><div class="slider-handle" data-v-acba8d95><div class="slider-arrow left" data-v-acba8d95>â—€</div><div class="slider-circle" data-v-acba8d95></div><div class="slider-arrow right" data-v-acba8d95>â–¶</div></div>',2)]),36)])],512),s("div",{class:"result-actions"},[s("button",{onClick:B,class:"btn btn-primary download-btn"}," ğŸ“¥ ä¸‹è½½å¤„ç†ç»“æœ "),s("button",{onClick:N,class:"btn btn-secondary"}," ğŸ”„ é‡æ–°é€‰æ‹©å›¾ç‰‡ ")]),s("div",ve,[s("div",me,[e[9]||(e[9]=s("span",{class:"info-label"},"å¤„ç†æ—¶é—´:",-1)),s("span",pe,p(y.value||"æœªçŸ¥"),1)]),v.value?(l(),o("div",ge,[e[10]||(e[10]=s("span",{class:"info-label"},"ä»»åŠ¡ID:",-1)),s("span",fe,p(v.value),1)])):u("",!0)])])])):u("",!0)])]),_.value?(l(),o("div",{key:0,class:M(["toast",I.value])},[s("div",_e,[s("span",he,p(C.value),1),s("button",{onClick:e[0]||(e[0]=m=>_.value=!1),class:"toast-close"},"Ã—")])],2)):u("",!0)])}}},Ie=q(ye,[["__scopeId","data-v-acba8d95"]]);export{Ie as default};
