import{_ as x,c as E,o as A,b as n,e as I,d as U,q as P,s as y,x as C,T as t}from"./index-B9-9S23K.js";import"./UnifiedImageProcessingTemplate.vue_vue_type_style_index_0_scoped_1007aace_lang-BKBt1ioy.js";import{U as M}from"./UnifiedImageProcessingTemplate-CT25CNty.js";import"./MobileActionButton-ThDW0Sz7.js";import"./SvgIcon-C5m6uGUh.js";const R={__name:"FaceSwap",setup(S,{expose:h}){h(),console.log("FaceSwapUnifiedç»„ä»¶å·²åŠ è½½ï¼ŒComfyUIæœåŠ¡å·²å¯¼å…¥");const g=n(null),o=n([]),l=n(null),p=n(null),r=n(null),i=n(!1),u=n(""),d=n(""),f=n(""),m=n(0),v=n(null),w=I(()=>o.value.length>0&&l.value!==null),T=(e,a)=>{if(e==="face-photos"){let s=Array.isArray(a)?a.map(c=>c.url||c):[];if(s.length>0&&s.length<4){const c=s[s.length-1];for(;s.length<4;)s.push(c)}o.value=s,r.value!==null&&(r.value=null),a.length>0&&t.success(`å·²é€‰æ‹© ${a.length} å¼ ç…§ç‰‡${a.length<4?"ï¼Œè‡ªåŠ¨è¡¥é½è‡³4å¼ ":""}`)}else e==="target-image"&&(l.value=a,r.value!==null&&(r.value=null))},F=async()=>{if(!w.value){t.fail("è¯·å…ˆä¸Šä¼ äººè„¸ç…§ç‰‡å’Œç›®æ ‡å›¾ç‰‡");return}i.value=!0,u.value="æ­£åœ¨åˆå§‹åŒ–...",m.value=0,v.value=Date.now();try{console.log("ðŸš€ å¼€å§‹æžé€Ÿæ¢è„¸å¤„ç†");const e=await C({facePhotos:o.value,targetImage:l.value,onProgress:(a,s)=>{u.value=a,m.value=s||0}});if(e.success&&e.imageUrl){r.value=e.imageUrl,p.value=e.targetImageUrl||l.value,d.value=e.promptId||"";const a=Date.now(),s=Math.round((a-v.value)/1e3);f.value=`${s}ç§’`;const c=e.pointsConsumed?`
æ¶ˆè€—${e.pointsConsumed}ç‚¹ç§¯åˆ†`:"";t.success(`ðŸŽ‰ æ¢è„¸å®Œæˆï¼${c}`),console.log("âœ… æ¢è„¸å¤„ç†å®Œæˆ")}else throw new Error(e.error||"æ¢è„¸å¤„ç†å¤±è´¥")}catch(e){console.error("âŒ æ¢è„¸å¤„ç†å¤±è´¥:",e),y(e,"æ¢è„¸å¤„ç†")||t.fail(`æ¢è„¸å¤±è´¥: ${e.message}`)}finally{i.value=!1,u.value="",m.value=0}},b=()=>{if(o.value=[],l.value=null,p.value=null,r.value=null,u.value="",d.value="",f.value="",g.value){const{uploadData:e}=g.value;e["face-photos"]&&(e["face-photos"]=[]),e["target-image"]&&(e["target-image"]=null)}t.success("å·²é‡ç½®ï¼Œå¯ä»¥é‡æ–°é€‰æ‹©å›¾ç‰‡")},D=e=>{if(!e)return;const a=document.createElement("a");a.href=e,a.download=`faceswap_result_${Date.now()}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),t.success("å›¾ç‰‡ä¸‹è½½å·²å¼€å§‹")},L=e=>{console.log("ç”¨æˆ·ç™»å½•æˆåŠŸ:",e)},k=()=>{console.log("ç”¨æˆ·å·²ç™»å‡º")};U(()=>{console.log("FaceSwapç»„ä»¶å·²æŒ‚è½½ï¼ŒComfyUIæœåŠ¡å·²å‡†å¤‡å°±ç»ª")}),P(()=>{i.value&&(i.value=!1)});const _={templateRef:g,facePhotos:o,targetImage:l,originalImageForComparison:p,resultImage:r,isLoading:i,processingStatus:u,promptId:d,processingTime:f,progressPercent:m,startTime:v,canProcess:w,handleUploadChange:T,processImages:F,resetProcess:b,handleDownload:D,handleUserLogin:L,handleUserLogout:k,ref:n,computed:I,onMounted:U,onUnmounted:P,get Toast(){return t},get UnifiedImageProcessingTemplate(){return M},get processFaceSwapImage(){return C},get handleError(){return y}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}};function B(S,h,g,o,l,p){return A(),E(o.UnifiedImageProcessingTemplate,{"function-id":"face-swap","title-icon-name":"face-swap","title-icon-color":"var(--van-warning-color)","process-button-icon-name":"face-swap","is-processing":o.isLoading,progress:o.progressPercent,"processing-description":o.processingStatus,"processing-info":{promptId:o.promptId,processingTime:o.processingTime},"result-data":o.resultImage,"original-image-for-comparison":o.originalImageForComparison,onLogin:o.handleUserLogin,onLogout:o.handleUserLogout,onProcess:o.processImages,onReset:o.resetProcess,onDownload:o.handleDownload,onUploadChange:o.handleUploadChange,ref:"templateRef"},null,8,["is-processing","progress","processing-description","processing-info","result-data","original-image-for-comparison"])}const z=x(R,[["render",B],["__scopeId","data-v-76085970"],["__file","D:/workspace/AIMagic/client/src/views/FaceSwap.vue"]]);export{z as default};
