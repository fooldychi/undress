{
    "sourceFile": "test-db-connection.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1752403368649,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1752403368649,
            "name": "Commit-0",
            "content": "require('dotenv').config();\nconst mysql = require('mysql2/promise');\n\nasync function testDatabaseConnection() {\n  console.log('ğŸ” æµ‹è¯•æ•°æ®åº“è¿æ¥...');\n  console.log('æ•°æ®åº“é…ç½®:', {\n    host: process.env.DB_HOST,\n    port: process.env.DB_PORT,\n    user: process.env.DB_USER,\n    database: process.env.DB_NAME\n  });\n\n  let connection;\n  try {\n    // å°è¯•è¿æ¥æ•°æ®åº“\n    connection = await mysql.createConnection({\n      host: process.env.DB_HOST,\n      port: process.env.DB_PORT,\n      user: process.env.DB_USER,\n      password: process.env.DB_PASSWORD,\n      database: process.env.DB_NAME,\n      connectTimeout: 10000,\n      acquireTimeout: 10000,\n      timeout: 10000\n    });\n\n    console.log('âœ… æ•°æ®åº“è¿æ¥æˆåŠŸï¼');\n\n    // æµ‹è¯•æŸ¥è¯¢\n    const [rows] = await connection.execute('SELECT 1 as test');\n    console.log('âœ… æ•°æ®åº“æŸ¥è¯¢æµ‹è¯•æˆåŠŸ:', rows);\n\n    // æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨\n    const [tables] = await connection.execute('SHOW TABLES');\n    console.log('ğŸ“Š æ•°æ®åº“ä¸­çš„è¡¨:', tables.map(t => Object.values(t)[0]));\n\n    // æ£€æŸ¥ç®¡ç†å‘˜è¡¨\n    const [adminTables] = await connection.execute('SHOW TABLES LIKE \"admins\"');\n    if (adminTables.length > 0) {\n      console.log('âœ… adminsè¡¨å­˜åœ¨');\n      const [admins] = await connection.execute('SELECT id, username, role, status FROM admins');\n      console.log('ğŸ‘¥ ç®¡ç†å‘˜è´¦æˆ·:', admins);\n    } else {\n      console.log('âŒ adminsè¡¨ä¸å­˜åœ¨');\n    }\n\n    // æ£€æŸ¥é…ç½®è¡¨\n    const [configTables] = await connection.execute('SHOW TABLES LIKE \"system_config\"');\n    if (configTables.length > 0) {\n      console.log('âœ… system_configè¡¨å­˜åœ¨');\n      const [configs] = await connection.execute('SELECT config_key, config_value, config_group FROM system_config WHERE config_group = \"comfyui\"');\n      console.log('âš™ï¸ ComfyUIé…ç½®:', configs);\n    } else {\n      console.log('âŒ system_configè¡¨ä¸å­˜åœ¨');\n    }\n\n    await connection.end();\n    console.log('ğŸ‰ æ•°æ®åº“æµ‹è¯•å®Œæˆï¼');\n\n  } catch (error) {\n    console.error('âŒ æ•°æ®åº“è¿æ¥å¤±è´¥:', error.message);\n    console.error('é”™è¯¯ä»£ç :', error.code);\n    console.error('é”™è¯¯è¯¦æƒ…:', error);\n\n    if (connection) {\n      try {\n        await connection.end();\n      } catch (closeError) {\n        console.error('å…³é—­è¿æ¥æ—¶å‡ºé”™:', closeError.message);\n      }\n    }\n  }\n}\n\ntestDatabaseConnection();\n"
        }
    ]
}