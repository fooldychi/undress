{
    "sourceFile": "docs/æœåŠ¡å™¨é€‰æ‹©ä¼˜åŒ–æ€»ç»“.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1752514403704,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752514420790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,10 +14,26 @@\n 3. å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼å¤„ç†ä¸ä¸€è‡´\n \n ## è§£å†³æ–¹æ¡ˆ\n \n-### 1. ä¿®å¤å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼é—®é¢˜\n+### 1. æ›´æ–°æœåŠ¡å™¨é…ç½®\n \n+**ä¿®æ”¹æ–‡ä»¶**:\n+- `client/src/config/comfyui.config.js`\n+- `client/.env.production`\n+- `server/src/routes/public-config.js`\n+\n+**æ›´æ–°å†…å®¹**:\n+```javascript\n+// ä¸»æœåŠ¡å™¨\n+BASE_URL: 'https://l9s75ay3rp-8188.cnb.run'\n+\n+// å¤‡ç”¨æœåŠ¡å™¨\n+'comfyui.backup_servers': 'https://0rv00xh2vg-8188.cnb.run'\n+```\n+\n+### 2. ä¿®å¤å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼é—®é¢˜\n+\n **é—®é¢˜**: `comfyui.backup_servers` åœ¨ä¸åŒåœ°æ–¹ä½¿ç”¨ä¸åŒçš„åˆ†éš”ç¬¦\n - æ•°æ®åº“ä¸­å­˜å‚¨çš„æ˜¯é€—å·åˆ†éš”çš„åœ°å€åˆ—è¡¨\n - å‰ç«¯ä»£ç å°è¯•ç”¨æ¢è¡Œç¬¦åˆ†å‰²\n \n"
                },
                {
                    "date": 1752514436169,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -48,10 +48,30 @@\n     .filter(url => url && url.startsWith('http'))\n }\n ```\n \n-### 2. å¢å¼ºæœåŠ¡å™¨é€‰æ‹©åé¦ˆä¿¡æ¯\n+### 3. æ”¹è¿›å¥åº·æ£€æŸ¥é€»è¾‘\n \n+**é—®é¢˜**: åŸæ¥çš„å¥åº·æ£€æŸ¥åªä½¿ç”¨ `/system_stats` ç«¯ç‚¹ï¼Œå¯èƒ½å¯¼è‡´è¯¯åˆ¤\n+\n+**è§£å†³æ–¹æ¡ˆ**: ä¿®æ”¹ `checkServerHealth` æ–¹æ³•ï¼Œå°è¯•å¤šä¸ªç«¯ç‚¹\n+```javascript\n+const testEndpoints = [\n+  '/queue',        // ComfyUI é˜Ÿåˆ—ç«¯ç‚¹ï¼Œæœ€å¸¸ç”¨\n+  '/system_stats', // ComfyUI ç³»ç»ŸçŠ¶æ€ç«¯ç‚¹\n+  '/history',      // ComfyUI å†å²è®°å½•ç«¯ç‚¹\n+  '/'              // æ ¹è·¯å¾„ï¼Œæœ€åå°è¯•\n+]\n+```\n+\n+**æ”¹è¿›ç‚¹**:\n+- æŒ‰ä¼˜å…ˆçº§æµ‹è¯•å¤šä¸ªç«¯ç‚¹\n+- ä»»ä½•ä¸€ä¸ªç«¯ç‚¹æˆåŠŸå³è®¤ä¸ºæœåŠ¡å™¨å¥åº·\n+- æ›´è¯¦ç»†çš„é”™è¯¯æ—¥å¿—\n+- æ›´æ™ºèƒ½çš„å¥åº·åˆ¤æ–­é€»è¾‘\n+\n+### 4. å¢å¼ºæœåŠ¡å™¨é€‰æ‹©åé¦ˆä¿¡æ¯\n+\n **æ–°å¢åŠŸèƒ½**: é¡µé¢åŠ è½½æ—¶æä¾›è¯¦ç»†çš„æœåŠ¡å™¨çŠ¶æ€åé¦ˆ\n \n **ä¿®æ”¹æ–‡ä»¶**:\n - `client/src/services/loadBalancer.js`\n"
                },
                {
                    "date": 1752514456052,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -149,14 +149,25 @@\n 2. **é€æ˜çš„é€‰æ‹©é€»è¾‘**: æ˜ç¡®æ˜¾ç¤ºä¸ºä»€ä¹ˆé€‰æ‹©æŸä¸ªæœåŠ¡å™¨\n 3. **é—®é¢˜è¯Šæ–­**: å½“æœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œæä¾›å…·ä½“çš„é”™è¯¯ä¿¡æ¯\n 4. **é…ç½®çµæ´»æ€§**: æ”¯æŒå¤šç§å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼\n \n+## æµ‹è¯•å·¥å…·\n+\n+æˆ‘ä»¬åˆ›å»ºäº†å¤šä¸ªæµ‹è¯•å·¥å…·æ¥éªŒè¯ä¿®å¤æ•ˆæœï¼š\n+\n+1. **quick-test.html**: å¿«é€Ÿæµ‹è¯•æœåŠ¡å™¨è¿æ¥\n+2. **test-servers.html**: è¯¦ç»†çš„æœåŠ¡å™¨ç«¯ç‚¹æµ‹è¯•\n+3. **client/test-load-balancer.html**: è´Ÿè½½å‡è¡¡å™¨åŠŸèƒ½æµ‹è¯•\n+4. **server/scripts/update-server-config.js**: æ•°æ®åº“é…ç½®æ›´æ–°è„šæœ¬\n+\n ## æµ‹è¯•å»ºè®®\n \n-1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°\n-2. åˆ·æ–°é¡µé¢è§‚å¯ŸæœåŠ¡å™¨é€‰æ‹©è¿‡ç¨‹\n-3. æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºäº†è¯¦ç»†çš„æœåŠ¡å™¨æµ‹è¯•ä¿¡æ¯\n-4. éªŒè¯æœ€ç»ˆé€‰æ‹©çš„æœåŠ¡å™¨æ˜¯å¦åˆç†\n+1. è¿è¡Œ `node server/scripts/update-server-config.js` æ›´æ–°æ•°æ®åº“é…ç½®\n+2. æ‰“å¼€æµ‹è¯•é¡µé¢éªŒè¯æœåŠ¡å™¨è¿æ¥\n+3. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°\n+4. åˆ·æ–°é¡µé¢è§‚å¯ŸæœåŠ¡å™¨é€‰æ‹©è¿‡ç¨‹\n+5. æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºäº†è¯¦ç»†çš„æœåŠ¡å™¨æµ‹è¯•ä¿¡æ¯\n+6. éªŒè¯æœ€ç»ˆé€‰æ‹©çš„æœåŠ¡å™¨æ˜¯å¦ä¸ºå¯ç”¨æœåŠ¡å™¨\n \n ## åç»­ä¼˜åŒ–å»ºè®®\n \n 1. æ·»åŠ æœåŠ¡å™¨å¥åº·çŠ¶æ€çš„æŒä¹…åŒ–ç¼“å­˜\n"
                }
            ],
            "date": 1752514403704,
            "name": "Commit-0",
            "content": "# æœåŠ¡å™¨é€‰æ‹©ä¼˜åŒ–æ€»ç»“\n\n## é—®é¢˜æè¿°\n\nç”¨æˆ·å‘ç°ç³»ç»Ÿç¼“å­˜äº†ä¸€ä¸ªä¸å¯ç”¨çš„æœåŠ¡å™¨åœ°å€ \"https://32rmau2534-8188.cnb.run/\"ï¼Œå¹¶ä¸”å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼å¤„ç†ä¸ä¸€è‡´çš„é—®é¢˜ã€‚\n\n**ç”¨æˆ·æä¾›çš„å¯ç”¨æœåŠ¡å™¨**:\n- https://l9s75ay3rp-8188.cnb.run/\n- https://0rv00xh2vg-8188.cnb.run/\n\n**å‘ç°çš„é—®é¢˜**:\n1. ç³»ç»Ÿé…ç½®ä¸­ä½¿ç”¨äº†ä¸å¯ç”¨çš„æœåŠ¡å™¨åœ°å€\n2. å¥åº·æ£€æŸ¥é€»è¾‘è¿‡äºä¸¥æ ¼ï¼Œå¯¼è‡´å¯ç”¨æœåŠ¡å™¨è¢«è¯¯åˆ¤ä¸ºä¸å¯ç”¨\n3. å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼å¤„ç†ä¸ä¸€è‡´\n\n## è§£å†³æ–¹æ¡ˆ\n\n### 1. ä¿®å¤å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼é—®é¢˜\n\n**é—®é¢˜**: `comfyui.backup_servers` åœ¨ä¸åŒåœ°æ–¹ä½¿ç”¨ä¸åŒçš„åˆ†éš”ç¬¦\n- æ•°æ®åº“ä¸­å­˜å‚¨çš„æ˜¯é€—å·åˆ†éš”çš„åœ°å€åˆ—è¡¨\n- å‰ç«¯ä»£ç å°è¯•ç”¨æ¢è¡Œç¬¦åˆ†å‰²\n\n**è§£å†³æ–¹æ¡ˆ**: ä¿®æ”¹ `client/src/services/loadBalancer.js`\n```javascript\n// å¤‡ç”¨æœåŠ¡å™¨ - æ”¯æŒæ¢è¡Œç¬¦å’Œé€—å·ä¸¤ç§åˆ†éš”æ–¹å¼\nif (config['comfyui.backup_servers']) {\n  const backupServers = config['comfyui.backup_servers']\n    .replace(/\\s*,\\s*/g, '\\n') // å°†é€—å·æ›¿æ¢ä¸ºæ¢è¡Œç¬¦\n    .split('\\n')\n    .map(url => url.trim())\n    .filter(url => url && url.startsWith('http'))\n}\n```\n\n### 2. å¢å¼ºæœåŠ¡å™¨é€‰æ‹©åé¦ˆä¿¡æ¯\n\n**æ–°å¢åŠŸèƒ½**: é¡µé¢åŠ è½½æ—¶æä¾›è¯¦ç»†çš„æœåŠ¡å™¨çŠ¶æ€åé¦ˆ\n\n**ä¿®æ”¹æ–‡ä»¶**:\n- `client/src/services/loadBalancer.js`\n- `client/src/main.js`\n\n**ä¸»è¦æ”¹è¿›**:\n\n1. **è¯¦ç»†çš„æœåŠ¡å™¨æµ‹è¯•æ—¥å¿—**:\n   ```javascript\n   console.log(`ğŸ“‹ å‘ç° ${servers.length} ä¸ªé…ç½®çš„æœåŠ¡å™¨:`)\n   servers.forEach((server, index) => {\n     console.log(`   ${index + 1}. ${server.url} (${server.type}, ä¼˜å…ˆçº§: ${server.priority})`)\n   })\n   ```\n\n2. **å®æ—¶æµ‹è¯•ç»“æœåé¦ˆ**:\n   ```javascript\n   if (health.healthy) {\n     console.log(`âœ… ${server.url} - å¥åº· (å“åº”æ—¶é—´: ${health.responseTime}ms, é˜Ÿåˆ—: ${queue.total || 0})`)\n   } else {\n     console.log(`âŒ ${server.url} - ä¸å¯ç”¨ (${health.error || 'è¿æ¥å¤±è´¥'})`)\n   }\n   ```\n\n3. **æœ€ç»ˆé€‰æ‹©ç»“æœè¯¦æƒ…**:\n   ```javascript\n   console.log(`ğŸ¯ æœ€ç»ˆé€‰æ‹©: ${selectedServer.url}`)\n   console.log(`   ç±»å‹: ${selectedServer.type === 'primary' ? 'ä¸»æœåŠ¡å™¨' : 'å¤‡ç”¨æœåŠ¡å™¨'}`)\n   console.log(`   é˜Ÿåˆ—æ•°: ${selectedServer.queue.total || 0} (è¿è¡Œä¸­: ${selectedServer.queue.running || 0}, ç­‰å¾…ä¸­: ${selectedServer.queue.pending || 0})`)\n   console.log(`   å“åº”æ—¶é—´: ${selectedServer.responseTime}ms`)\n   console.log(`   ä¼˜å…ˆçº§: ${selectedServer.priority}`)\n   ```\n\n### 3. æ–°å¢é¡µé¢åŠ è½½æ—¶çš„æœåŠ¡å™¨åˆå§‹åŒ–\n\n**æ–°å¢æ–¹æ³•**: `initializeServerConnection()`\n- åœ¨é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•æ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨\n- æä¾›è¯¦ç»†çš„è¿æ¥æµ‹è¯•åé¦ˆ\n- æ¨èæœ€ä¼˜æœåŠ¡å™¨\n\n**é›†æˆåˆ°åº”ç”¨å¯åŠ¨æµç¨‹**:\n```javascript\n// client/src/main.js\nconsole.log('ğŸ” å¼€å§‹æœåŠ¡å™¨è¿æ¥æµ‹è¯•...')\ntry {\n  await loadBalancer.initializeServerConnection()\n} catch (error) {\n  console.warn('âš ï¸ æœåŠ¡å™¨è¿æ¥æµ‹è¯•å¤±è´¥ï¼Œå°†åœ¨éœ€è¦æ—¶é‡è¯•:', error.message)\n}\n```\n\n### 4. å¢å¼ºæœåŠ¡å™¨çŠ¶æ€æŠ¥å‘Š\n\n**æ”¹è¿›çš„çŠ¶æ€æŠ¥å‘Šæ ¼å¼**:\n```\nğŸ“Š è¯¦ç»†æœåŠ¡å™¨çŠ¶æ€æŠ¥å‘Š:\n   çŠ¶æ€ | ç±»å‹ | æœåŠ¡å™¨URL | é˜Ÿåˆ—(è¿è¡Œ/ç­‰å¾…/æ€»è®¡) | ä¼˜å…ˆçº§ | å“åº”æ—¶é—´ | é”™è¯¯ä¿¡æ¯\n   -----|------|-----------|-------------------|--------|----------|----------\n   âœ… | ä¸»æœåŠ¡å™¨ | https://server1.com | 0/2/2 | 1 | 150ms |\n   âŒ | å¤‡ç”¨ | https://server2.com | N/A | 2 | N/A | Connection failed...\n```\n\n### 5. æ›´æ–°é…ç½®æè¿°\n\n**ä¿®æ”¹æ–‡ä»¶**:\n- `admin/src/views/Config.vue`\n- `server/src/scripts/init-comfyui-config.js`\n- `server/scripts/tools/add-backup-servers.js`\n\n**ç»Ÿä¸€æè¿°**: \"ComfyUIå¤‡ç”¨æœåŠ¡å™¨åœ°å€åˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªæˆ–é€—å·åˆ†éš”ï¼‰\"\n\n## ç”¨æˆ·ä½“éªŒæ”¹è¿›\n\n1. **æ¸…æ™°çš„å¯åŠ¨åé¦ˆ**: ç”¨æˆ·å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°è¯¦ç»†çš„æœåŠ¡å™¨æµ‹è¯•è¿‡ç¨‹\n2. **é€æ˜çš„é€‰æ‹©é€»è¾‘**: æ˜ç¡®æ˜¾ç¤ºä¸ºä»€ä¹ˆé€‰æ‹©æŸä¸ªæœåŠ¡å™¨\n3. **é—®é¢˜è¯Šæ–­**: å½“æœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œæä¾›å…·ä½“çš„é”™è¯¯ä¿¡æ¯\n4. **é…ç½®çµæ´»æ€§**: æ”¯æŒå¤šç§å¤‡ç”¨æœåŠ¡å™¨åœ°å€æ ¼å¼\n\n## æµ‹è¯•å»ºè®®\n\n1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°\n2. åˆ·æ–°é¡µé¢è§‚å¯ŸæœåŠ¡å™¨é€‰æ‹©è¿‡ç¨‹\n3. æ£€æŸ¥æ˜¯å¦æ˜¾ç¤ºäº†è¯¦ç»†çš„æœåŠ¡å™¨æµ‹è¯•ä¿¡æ¯\n4. éªŒè¯æœ€ç»ˆé€‰æ‹©çš„æœåŠ¡å™¨æ˜¯å¦åˆç†\n\n## åç»­ä¼˜åŒ–å»ºè®®\n\n1. æ·»åŠ æœåŠ¡å™¨å¥åº·çŠ¶æ€çš„æŒä¹…åŒ–ç¼“å­˜\n2. å®ç°æœåŠ¡å™¨æ•…éšœè‡ªåŠ¨åˆ‡æ¢æœºåˆ¶\n3. æ·»åŠ æœåŠ¡å™¨æ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡\n4. æä¾›ç®¡ç†åå°çš„æœåŠ¡å™¨çŠ¶æ€å¯è§†åŒ–ç•Œé¢\n"
        }
    ]
}