{
    "sourceFile": "client/src/utils/test-unified-config.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1752548124489,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1752548124489,
            "name": "Commit-0",
            "content": "// æµ‹è¯•ç»Ÿä¸€çš„ComfyUIé…ç½®\nimport comfyUIConfig from '../config/comfyui.config.js'\n\n/**\n * æµ‹è¯•ç»Ÿä¸€é…ç½®çš„å¥åº·æ£€æµ‹åŠŸèƒ½\n */\nexport async function testUnifiedHealthCheck(serverUrl = 'https://l9s75ay3rp-8188.cnb.run') {\n  console.log('ğŸ§ª æµ‹è¯•ç»Ÿä¸€çš„ComfyUIå¥åº·æ£€æµ‹é…ç½®')\n  console.log('=' .repeat(60))\n\n  // 1. æµ‹è¯•é…ç½®è·å–\n  console.log('\\nğŸ“‹ é…ç½®ä¿¡æ¯:')\n  console.log('   å®˜æ–¹ç«¯ç‚¹:', comfyUIConfig.HEALTH_CHECK.ENDPOINTS)\n  console.log('   è¶…æ—¶æ—¶é—´:', comfyUIConfig.HEALTH_CHECK.TIMEOUT + 'ms')\n  console.log('   è¯·æ±‚å¤´:', Object.keys(comfyUIConfig.HEALTH_CHECK.HEADERS))\n\n  // 2. æµ‹è¯•ç«¯ç‚¹åˆ—è¡¨è·å–\n  const endpoints = comfyUIConfig.getHealthCheckEndpoints()\n  console.log('\\nğŸ”— å¥åº·æ£€æµ‹ç«¯ç‚¹åˆ—è¡¨:', endpoints)\n\n  // 3. æµ‹è¯•å®é™…å¥åº·æ£€æµ‹\n  console.log(`\\nğŸ¥ æµ‹è¯•æœåŠ¡å™¨å¥åº·æ£€æµ‹: ${serverUrl}`)\n\n  const results = []\n\n  for (const endpoint of endpoints) {\n    const fullUrl = `${serverUrl.replace(/\\/$/, '')}${endpoint}`\n    console.log(`\\nğŸ” æµ‹è¯•ç«¯ç‚¹: ${endpoint}`)\n\n    try {\n      const controller = new AbortController()\n      const timeoutId = setTimeout(() => controller.abort(), comfyUIConfig.HEALTH_CHECK.TIMEOUT)\n\n      const startTime = Date.now()\n      const response = await fetch(fullUrl, {\n        method: 'GET',\n        signal: controller.signal,\n        headers: comfyUIConfig.HEALTH_CHECK.HEADERS,\n        mode: 'cors',\n        credentials: 'omit'\n      })\n\n      clearTimeout(timeoutId)\n      const responseTime = Date.now() - startTime\n\n      const result = {\n        endpoint,\n        status: response.status,\n        ok: response.ok,\n        responseTime,\n        success: false,\n        validated: false\n      }\n\n      if (response.ok) {\n        console.log(`   âœ… çŠ¶æ€: ${response.status} (${responseTime}ms)`)\n\n        try {\n          const data = await response.json()\n          const isValid = comfyUIConfig.validateResponse(endpoint, data)\n\n          result.success = true\n          result.validated = isValid\n          result.dataKeys = Object.keys(data)\n\n          if (isValid) {\n            console.log(`   ğŸ¯ éªŒè¯æˆåŠŸ: ç¡®è®¤ä¸ºæœ‰æ•ˆçš„ComfyUIå“åº”`)\n            console.log(`   ğŸ“Š æ•°æ®å­—æ®µ:`, result.dataKeys.slice(0, 5).join(', '))\n          } else {\n            console.log(`   âš ï¸ éªŒè¯å¤±è´¥: ä¸æ˜¯é¢„æœŸçš„ComfyUIå“åº”æ ¼å¼`)\n          }\n        } catch (jsonError) {\n          result.success = true\n          result.validated = false\n          result.note = 'éJSONå“åº”ä½†è¿æ¥æ­£å¸¸'\n          console.log(`   âš ï¸ JSONè§£æå¤±è´¥ä½†è¿æ¥æ­£å¸¸: ${jsonError.message}`)\n        }\n      } else {\n        console.log(`   âŒ çŠ¶æ€: ${response.status} ${response.statusText} (${responseTime}ms)`)\n      }\n\n      results.push(result)\n\n    } catch (error) {\n      console.log(`   ğŸ’¥ è¯·æ±‚å¤±è´¥: ${error.message}`)\n      results.push({\n        endpoint,\n        success: false,\n        error: error.message,\n        errorType: error.name\n      })\n    }\n  }\n\n  // 4. æ±‡æ€»ç»“æœ\n  console.log('\\nğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»:')\n  console.log('=' .repeat(40))\n\n  const successfulEndpoints = results.filter(r => r.success)\n  const validatedEndpoints = results.filter(r => r.validated)\n\n  console.log(`   æ€»ç«¯ç‚¹æ•°: ${results.length}`)\n  console.log(`   æˆåŠŸè¿æ¥: ${successfulEndpoints.length}`)\n  console.log(`   éªŒè¯é€šè¿‡: ${validatedEndpoints.length}`)\n\n  if (validatedEndpoints.length > 0) {\n    console.log(`   âœ… æœåŠ¡å™¨å¥åº·çŠ¶æ€: æ­£å¸¸`)\n    console.log(`   ğŸ¯ æ¨èç«¯ç‚¹: ${validatedEndpoints[0].endpoint}`)\n  } else if (successfulEndpoints.length > 0) {\n    console.log(`   âš ï¸ æœåŠ¡å™¨å¥åº·çŠ¶æ€: éƒ¨åˆ†æ­£å¸¸`)\n    console.log(`   ğŸ”— å¯ç”¨ç«¯ç‚¹: ${successfulEndpoints[0].endpoint}`)\n  } else {\n    console.log(`   âŒ æœåŠ¡å™¨å¥åº·çŠ¶æ€: å¼‚å¸¸`)\n  }\n\n  return {\n    serverUrl,\n    totalEndpoints: results.length,\n    successfulEndpoints: successfulEndpoints.length,\n    validatedEndpoints: validatedEndpoints.length,\n    isHealthy: validatedEndpoints.length > 0,\n    results\n  }\n}\n\n/**\n * åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿è¡Œæµ‹è¯•\n */\nif (typeof window !== 'undefined') {\n  window.testUnifiedHealthCheck = testUnifiedHealthCheck\n  console.log('ğŸ”§ ç»Ÿä¸€é…ç½®æµ‹è¯•å·¥å…·å·²åŠ è½½ï¼Œä½¿ç”¨ testUnifiedHealthCheck() è¿›è¡Œæµ‹è¯•')\n}\n"
        }
    ]
}