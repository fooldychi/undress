{
    "sourceFile": "client/src/utils/apiConfig.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1753720973172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1753720973172,
            "name": "Commit-0",
            "content": "// ç»Ÿä¸€APIé…ç½®ç®¡ç†å·¥å…·\n// è§£å†³å¤šå¤„é…ç½®ä¸ä¸€è‡´çš„é—®é¢˜\n\n/**\n * è·å–APIåŸºç¡€URL\n * ç»Ÿä¸€ç®¡ç†æ‰€æœ‰APIè°ƒç”¨çš„åŸºç¡€åœ°å€\n * @returns {string} APIåŸºç¡€URL\n */\nexport function getAPIBaseURL() {\n  if (import.meta.env.MODE === 'development') {\n    console.log('ğŸ”§ å¼€å‘ç¯å¢ƒï¼šä½¿ç”¨ä»£ç†æ¨¡å¼')\n    return '' // å¼€å‘ç¯å¢ƒä½¿ç”¨ä»£ç†\n  }\n\n  // ç”Ÿäº§ç¯å¢ƒï¼šä»ç¯å¢ƒå˜é‡è·å–\n  const apiUrl = import.meta.env.VITE_API_BASE_URL || 'http://114.132.50.71:3007/api'\n  let baseUrl = apiUrl.replace('/api', '')\n\n  // å¼ºåˆ¶ä½¿ç”¨HTTPåè®®ï¼ˆé˜²æ­¢æ„å¤–çš„HTTPSé…ç½®ï¼‰\n  if (baseUrl.startsWith('https://')) {\n    console.warn('âš ï¸ æ£€æµ‹åˆ°HTTPSé…ç½®ï¼Œå¼ºåˆ¶è½¬æ¢ä¸ºHTTP:', baseUrl)\n    baseUrl = baseUrl.replace('https://', 'http://')\n  }\n\n  // ç¡®ä¿æ²¡æœ‰å°¾éƒ¨æ–œæ \n  baseUrl = baseUrl.replace(/\\/$/, '')\n\n  console.log('ğŸŒ ç”Ÿäº§ç¯å¢ƒAPIåŸºç¡€URL:', baseUrl)\n  return baseUrl\n}\n\n/**\n * æ„å»ºå®Œæ•´çš„API URL\n * @param {string} endpoint - APIç«¯ç‚¹è·¯å¾„ï¼ˆå¦‚ï¼š'/api/config'ï¼‰\n * @returns {string} å®Œæ•´çš„API URL\n */\nexport function buildAPIURL(endpoint) {\n  const baseUrl = getAPIBaseURL()\n\n  // ç¡®ä¿endpointä»¥/å¼€å¤´\n  if (!endpoint.startsWith('/')) {\n    endpoint = '/' + endpoint\n  }\n\n  const fullUrl = baseUrl + endpoint\n  console.log(`ğŸ”— æ„å»ºAPI URL: ${endpoint} -> ${fullUrl}`)\n  return fullUrl\n}\n\n/**\n * è·å–åç«¯APIé…ç½®å¯¹è±¡\n * @returns {Object} APIé…ç½®å¯¹è±¡\n */\nexport function getBackendAPIConfig() {\n  return {\n    BASE_URL: getAPIBaseURL(),\n    TIMEOUT: 30000 // 30ç§’\n  }\n}\n\n/**\n * åˆ›å»ºæ ‡å‡†çš„fetchè¯·æ±‚é…ç½®\n * @param {Object} options - è¯·æ±‚é€‰é¡¹\n * @returns {Object} fetché…ç½®å¯¹è±¡\n */\nexport function createFetchConfig(options = {}) {\n  const config = {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    ...options\n  }\n\n  // æ·»åŠ è®¤è¯tokenï¼ˆå¦‚æœå­˜åœ¨ï¼‰\n  const token = localStorage.getItem('auth_token')\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`\n  }\n\n  return config\n}\n\n/**\n * ç»Ÿä¸€çš„APIè¯·æ±‚å‡½æ•°\n * @param {string} endpoint - APIç«¯ç‚¹\n * @param {Object} options - è¯·æ±‚é€‰é¡¹\n * @returns {Promise} fetch Promise\n */\nexport async function apiRequest(endpoint, options = {}) {\n  const url = buildAPIURL(endpoint)\n  const config = createFetchConfig(options)\n\n  console.log(`ğŸš€ APIè¯·æ±‚: ${config.method} ${url}`)\n\n  try {\n    const response = await fetch(url, config)\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`)\n    }\n\n    const data = await response.json()\n    console.log(`âœ… APIå“åº”æˆåŠŸ: ${endpoint}`)\n    return data\n\n  } catch (error) {\n    console.error(`âŒ APIè¯·æ±‚å¤±è´¥: ${endpoint}`, error)\n    throw error\n  }\n}\n\n// å¯¼å‡ºå¸¸ç”¨çš„APIç«¯ç‚¹\nexport const API_ENDPOINTS = {\n  // é…ç½®ç›¸å…³\n  PUBLIC_CONFIG: '/api/public-config',\n  CONFIG: '/api/config',\n\n  // å·¥ä½œæµç›¸å…³\n  WORKFLOW_CONFIG_PUBLIC: '/api/workflow-config/public',\n  WORKFLOW_CONFIG_FEATURES: '/api/workflow-config/features',\n\n  // è®¤è¯ç›¸å…³\n  AUTH_LOGIN: '/api/auth/login',\n  AUTH_REGISTER: '/api/auth/register',\n  AUTH_PROFILE: '/api/auth/profile',\n  AUTH_ME: '/api/auth/me',\n  AUTH_LOGOUT: '/api/auth/logout',\n\n  // ç”¨æˆ·ç›¸å…³\n  USER_PROFILE: '/api/user/profile',\n  USER_POINTS: '/api/user/points',\n\n  // ç§¯åˆ†å’Œç­‰çº§å¡ç›¸å…³\n  LEVEL_CARDS_USER_POINTS: '/api/level-cards/user-points',\n  LEVEL_CARDS_POINT_LOGS: '/api/level-cards/point-logs',\n  LEVEL_CARDS_MY_CARDS: '/api/level-cards/my-cards',\n  LEVEL_CARDS_CONSUME_POINTS: '/api/level-cards/consume-points',\n  LEVEL_CARDS_TYPES: '/api/level-cards/types',\n\n  // AIå¤„ç†ç›¸å…³\n  AI_UNDRESS: '/api/ai/undress',\n  AI_FACESWAP: '/api/ai/faceswap'\n}\n\n// è°ƒè¯•ä¿¡æ¯\nconsole.log('ğŸ“‹ APIé…ç½®å·¥å…·å·²åŠ è½½')\nconsole.log('ğŸ”§ å½“å‰ç¯å¢ƒ:', import.meta.env.MODE)\nconsole.log('ğŸŒ APIåŸºç¡€URL:', getAPIBaseURL())\n"
        }
    ]
}