{
    "sourceFile": "client/src/components/common/VantImageUpload.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1752384914040,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752384943092,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -276,13 +276,13 @@\n \n .tip-item {\n   display: flex;\n   align-items: center;\n-  gap: 6px;\n-  font-size: 12px;\n-  color: var(--van-text-color-3, #969799);\n-  line-height: 1.4;\n-  margin-bottom: 4px;\n+  gap: 8px;\n+  font-size: 13px;\n+  color: rgba(255, 255, 255, 0.7);\n+  line-height: 1.5;\n+  margin-bottom: 6px;\n }\n \n .tip-item:last-child {\n   margin-bottom: 0;\n@@ -290,33 +290,60 @@\n \n /* 移动端优化 */\n @media (max-width: 768px) {\n   .upload-area {\n-    padding: 24px 12px;\n-    min-height: 100px;\n+    padding: 32px 16px;\n+    min-height: 120px;\n   }\n \n   .upload-text {\n-    font-size: 15px;\n+    font-size: 16px;\n   }\n \n   .upload-description {\n     font-size: 13px;\n   }\n+\n+  .upload-tips {\n+    padding: 12px;\n+    margin-top: 12px;\n+  }\n+\n+  .tip-item {\n+    font-size: 12px;\n+    margin-bottom: 4px;\n+  }\n }\n \n /* 深色主题适配 */\n @media (prefers-color-scheme: dark) {\n   .upload-area {\n-    background: var(--van-background, #2a2a2a);\n-    border-color: var(--van-border-color, #333);\n+    background: rgba(0, 0, 0, 0.3);\n+    border-color: rgba(255, 255, 255, 0.2);\n   }\n \n   .upload-area:hover {\n-    background: rgba(25, 137, 250, 0.1);\n+    background: rgba(0, 0, 0, 0.4);\n+    border-color: rgba(255, 255, 255, 0.4);\n   }\n \n   .upload-tips {\n-    background: var(--van-background-2, #1e1e1e);\n+    background: rgba(0, 0, 0, 0.2);\n+    border-color: rgba(255, 255, 255, 0.1);\n   }\n }\n+\n+/* 减少动画在低性能设备上的影响 */\n+@media (prefers-reduced-motion: reduce) {\n+  .upload-area {\n+    transition: none;\n+  }\n+\n+  .upload-area::before {\n+    display: none;\n+  }\n+\n+  .upload-area:hover {\n+    transform: none;\n+  }\n+}\n </style>\n"
                },
                {
                    "date": 1752387425924,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -192,27 +192,35 @@\n \n <style scoped>\n .vant-image-upload {\n   width: 100%;\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n }\n \n .image-uploader {\n   width: 100%;\n+  display: flex;\n+  justify-content: center;\n }\n \n .upload-area {\n+  width: 100%;\n+  max-width: 500px;\n+  padding: 40px 24px;\n+  min-height: 200px;\n   display: flex;\n   flex-direction: column;\n   align-items: center;\n   justify-content: center;\n-  padding: 40px 20px;\n+  text-align: center;\n   border: 2px dashed rgba(255, 255, 255, 0.3);\n   border-radius: 16px;\n   background: rgba(255, 255, 255, 0.1);\n   backdrop-filter: blur(10px);\n   -webkit-backdrop-filter: blur(10px);\n   transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n-  min-height: 140px;\n   position: relative;\n   overflow: hidden;\n   box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n }\n@@ -263,8 +271,10 @@\n   text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n }\n \n .upload-tips {\n+  width: 100%;\n+  max-width: 500px;\n   margin-top: 16px;\n   padding: 16px;\n   background: rgba(255, 255, 255, 0.1);\n   backdrop-filter: blur(10px);\n@@ -346,4 +356,5 @@\n     transform: none;\n   }\n }\n </style>\n+\n"
                },
                {
                    "date": 1752387510558,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -205,9 +205,9 @@\n }\n \n .upload-area {\n   width: 100%;\n-  max-width: 500px;\n+  /* Removed max-width */\n   padding: 40px 24px;\n   min-height: 200px;\n   display: flex;\n   flex-direction: column;\n@@ -272,9 +272,9 @@\n }\n \n .upload-tips {\n   width: 100%;\n-  max-width: 500px;\n+  /* Removed max-width */\n   margin-top: 16px;\n   padding: 16px;\n   background: rgba(255, 255, 255, 0.1);\n   backdrop-filter: blur(10px);\n@@ -357,4 +357,5 @@\n   }\n }\n </style>\n \n+\n"
                }
            ],
            "date": 1752384914040,
            "name": "Commit-0",
            "content": "<template>\n  <div class=\"vant-image-upload\">\n    <van-uploader\n      v-model=\"fileList\"\n      :max-count=\"maxCount\"\n      :max-size=\"maxSize\"\n      :accept=\"accept\"\n      :disabled=\"disabled\"\n      :preview-size=\"previewSize\"\n      :upload-text=\"uploadText\"\n      :upload-icon=\"uploadIcon\"\n      :deletable=\"deletable\"\n      :show-upload=\"showUpload\"\n      :before-read=\"beforeRead\"\n      @oversize=\"onOversize\"\n      @delete=\"onDelete\"\n      @click-upload=\"onClickUpload\"\n      class=\"image-uploader\"\n    >\n      <template #default>\n        <div class=\"upload-area\">\n          <van-icon\n            :name=\"uploadIcon\"\n            :size=\"iconSize\"\n            :color=\"iconColor\"\n            class=\"upload-icon\"\n          />\n          <div class=\"upload-text\">{{ uploadText }}</div>\n          <div v-if=\"description\" class=\"upload-description\">{{ description }}</div>\n        </div>\n      </template>\n    </van-uploader>\n\n    <!-- 上传提示 -->\n    <div v-if=\"showTips && tips.length > 0\" class=\"upload-tips\">\n      <div v-for=\"(tip, index) in tips\" :key=\"index\" class=\"tip-item\">\n        <van-icon name=\"info-o\" size=\"14\" color=\"var(--van-text-color-3)\" />\n        <span>{{ tip }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { Toast } from 'vant'\n\n// Props\nconst props = defineProps({\n  modelValue: {\n    type: [Array, String],\n    default: () => []\n  },\n  maxCount: {\n    type: Number,\n    default: 1\n  },\n  maxSize: {\n    type: Number,\n    default: 10 * 1024 * 1024 // 10MB\n  },\n  accept: {\n    type: String,\n    default: 'image/*'\n  },\n  disabled: {\n    type: Boolean,\n    default: false\n  },\n  previewSize: {\n    type: [String, Number],\n    default: 80\n  },\n  uploadText: {\n    type: String,\n    default: '上传图片'\n  },\n  uploadIcon: {\n    type: String,\n    default: 'photograph'\n  },\n  iconSize: {\n    type: [String, Number],\n    default: 32\n  },\n  iconColor: {\n    type: String,\n    default: 'var(--van-text-color-3, #c8c9cc)'\n  },\n  description: {\n    type: String,\n    default: ''\n  },\n  deletable: {\n    type: Boolean,\n    default: true\n  },\n  showTips: {\n    type: Boolean,\n    default: true\n  },\n  tips: {\n    type: Array,\n    default: () => [\n      '支持 JPG、PNG 格式',\n      '建议尺寸 512x512 以上',\n      '文件大小不超过 10MB'\n    ]\n  }\n})\n\n// Events\nconst emit = defineEmits(['update:modelValue', 'change', 'delete', 'oversize'])\n\n// Data\nconst fileList = ref([])\n\n// Computed\nconst showUpload = computed(() => {\n  return !props.disabled && fileList.value.length < props.maxCount\n})\n\n// Watch\nwatch(() => props.modelValue, (newValue) => {\n  if (Array.isArray(newValue)) {\n    fileList.value = newValue.map((item, index) => ({\n      url: typeof item === 'string' ? item : item.url,\n      file: typeof item === 'object' ? item.file : null,\n      status: 'done',\n      message: '',\n      uid: `${Date.now()}-${index}`\n    }))\n  } else if (newValue) {\n    fileList.value = [{\n      url: newValue,\n      status: 'done',\n      message: '',\n      uid: `${Date.now()}-0`\n    }]\n  } else {\n    fileList.value = []\n  }\n}, { immediate: true })\n\nwatch(fileList, (newValue) => {\n  const result = newValue.map(item => ({\n    url: item.url,\n    file: item.file\n  }))\n\n  if (props.maxCount === 1) {\n    emit('update:modelValue', result[0] || null)\n  } else {\n    emit('update:modelValue', result)\n  }\n\n  emit('change', result)\n}, { deep: true })\n\n// Methods\nconst beforeRead = (file) => {\n  // 检查文件类型\n  if (!file.type.startsWith('image/')) {\n    Toast.fail('请选择图片文件')\n    return false\n  }\n\n  // 检查文件大小\n  if (file.size > props.maxSize) {\n    Toast.fail(`文件大小不能超过 ${(props.maxSize / 1024 / 1024).toFixed(1)}MB`)\n    return false\n  }\n\n  return true\n}\n\nconst onOversize = (file) => {\n  Toast.fail(`文件大小不能超过 ${(props.maxSize / 1024 / 1024).toFixed(1)}MB`)\n  emit('oversize', file)\n}\n\nconst onDelete = (file, detail) => {\n  emit('delete', file, detail)\n}\n\nconst onClickUpload = () => {\n  if (props.disabled) {\n    Toast.fail('当前无法上传')\n  }\n}\n</script>\n\n<style scoped>\n.vant-image-upload {\n  width: 100%;\n}\n\n.image-uploader {\n  width: 100%;\n}\n\n.upload-area {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  border: 2px dashed rgba(255, 255, 255, 0.3);\n  border-radius: 16px;\n  background: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  min-height: 140px;\n  position: relative;\n  overflow: hidden;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n}\n\n/* 添加光泽效果 */\n.upload-area::before {\n  content: '';\n  position: absolute;\n  top: -50%;\n  left: -50%;\n  width: 200%;\n  height: 200%;\n  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);\n  transform: rotate(45deg);\n  transition: transform 0.6s ease;\n  pointer-events: none;\n}\n\n.upload-area:hover {\n  border-color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-2px);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);\n}\n\n.upload-area:hover::before {\n  transform: rotate(45deg) translate(50%, 50%);\n}\n\n.upload-icon {\n  margin-bottom: 12px;\n  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));\n}\n\n.upload-text {\n  font-size: 17px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.95);\n  margin-bottom: 6px;\n  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.upload-description {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.8);\n  text-align: center;\n  line-height: 1.5;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n.upload-tips {\n  margin-top: 16px;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(10px);\n  -webkit-backdrop-filter: blur(10px);\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);\n}\n\n.tip-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 12px;\n  color: var(--van-text-color-3, #969799);\n  line-height: 1.4;\n  margin-bottom: 4px;\n}\n\n.tip-item:last-child {\n  margin-bottom: 0;\n}\n\n/* 移动端优化 */\n@media (max-width: 768px) {\n  .upload-area {\n    padding: 24px 12px;\n    min-height: 100px;\n  }\n\n  .upload-text {\n    font-size: 15px;\n  }\n\n  .upload-description {\n    font-size: 13px;\n  }\n}\n\n/* 深色主题适配 */\n@media (prefers-color-scheme: dark) {\n  .upload-area {\n    background: var(--van-background, #2a2a2a);\n    border-color: var(--van-border-color, #333);\n  }\n\n  .upload-area:hover {\n    background: rgba(25, 137, 250, 0.1);\n  }\n\n  .upload-tips {\n    background: var(--van-background-2, #1e1e1e);\n  }\n}\n</style>\n"
        }
    ]
}