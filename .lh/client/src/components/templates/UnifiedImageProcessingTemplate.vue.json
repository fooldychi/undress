{
    "sourceFile": "client/src/components/templates/UnifiedImageProcessingTemplate.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 77,
            "patches": [
                {
                    "date": 1752395027594,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752395065305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -245,37 +245,10 @@\n   emit('input-change', panelId, data)\n }\n \n // 状态相关方法\n-const getStatusIcon = (item) => {\n-  const data = uploadData.value[item.key] || inputData.value[item.key]\n-  const hasData = Array.isArray(data) ? data.length > 0 : !!data\n-  return hasData ? item.icon : `${item.icon}-o`\n-}\n \n-const getStatusColor = (item) => {\n-  const data = uploadData.value[item.key] || inputData.value[item.key]\n-  const hasData = Array.isArray(data) ? data.length > 0 : !!data\n-  return hasData ? 'var(--van-success-color)' : 'var(--van-text-color-3)'\n-}\n \n-const getStatusTextClass = (item) => {\n-  const data = uploadData.value[item.key] || inputData.value[item.key]\n-  const hasData = Array.isArray(data) ? data.length > 0 : !!data\n-  return { 'text-success': hasData }\n-}\n-\n-const getStatusText = (item) => {\n-  const data = uploadData.value[item.key] || inputData.value[item.key]\n-\n-  if (Array.isArray(data)) {\n-    return item.countText ? item.countText.replace('{count}', data.length) :\n-           (data.length > 0 ? item.successText : item.emptyText)\n-  } else {\n-    return data ? item.successText : item.emptyText\n-  }\n-}\n-\n // 生命周期\n onMounted(() => {\n   loadConfig()\n })\n"
                },
                {
                    "date": 1752395099878,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -303,29 +303,10 @@\n   font-size: 12px;\n   color: var(--van-text-color-3);\n }\n \n-.upload-status {\n-  display: flex;\n-  flex-direction: column;\n-  gap: 8px;\n-  padding: 12px;\n-  background: var(--van-background-2, #f7f8fa);\n-  border-radius: 6px;\n-}\n \n-.status-item {\n-  display: flex;\n-  align-items: center;\n-  gap: 8px;\n-  font-size: 14px;\n-  color: var(--van-text-color-2, #646566);\n-}\n \n-.text-success {\n-  color: var(--van-success-color, #07c160);\n-}\n-\n .simple-result {\n   text-align: center;\n }\n \n"
                },
                {
                    "date": 1752395122204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -324,9 +324,7 @@\n }\n \n /* 深色主题适配 */\n @media (prefers-color-scheme: dark) {\n-  .upload-status {\n-    background: var(--van-background-2, #1e1e1e);\n-  }\n+  /* 深色主题样式 */\n }\n </style>\n"
                },
                {
                    "date": 1752395274805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n     :title-icon=\"titleIcon\"\n     :title-icon-color=\"titleIconColor\"\n     :is-processing=\"isProcessing\"\n     :can-process=\"canProcess\"\n-    :show-upload-tips=\"!canProcess\"\n+\n     :process-button-text=\"config.processButtonText\"\n     :process-button-icon=\"processButtonIcon\"\n     :progress=\"progress\"\n     :processing-title=\"config.processingTitle\"\n"
                },
                {
                    "date": 1752395657554,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n     :title-icon=\"titleIcon\"\n     :title-icon-color=\"titleIconColor\"\n     :is-processing=\"isProcessing\"\n     :can-process=\"canProcess\"\n-\n+    :show-upload-tips=\"false\"\n     :process-button-text=\"config.processButtonText\"\n     :process-button-icon=\"processButtonIcon\"\n     :progress=\"progress\"\n     :processing-title=\"config.processingTitle\"\n"
                },
                {
                    "date": 1752395935394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -327,4 +327,5 @@\n @media (prefers-color-scheme: dark) {\n   /* 深色主题样式 */\n }\n </style>\n+\n"
                },
                {
                    "date": 1752396150323,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -172,9 +172,18 @@\n // Emits\n const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'upload-change', 'input-change'])\n \n // 响应式数据\n-const config = ref({})\n+const config = ref({\n+  title: '',\n+  description: '',\n+  processButtonText: '开始处理',\n+  processingTitle: '正在处理...',\n+  processingDescription: '请耐心等待',\n+  uploadPanels: [],\n+  inputPanels: [],\n+  resultConfig: {}\n+})\n const uploadData = ref({})\n const inputData = ref({})\n \n // 计算属性\n"
                },
                {
                    "date": 1752396226291,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n <template>\n   <AIProcessingTemplate\n+    v-if=\"config.title\"\n     :title=\"config.title\"\n     :description=\"config.description\"\n     :title-icon=\"titleIcon\"\n     :title-icon-color=\"titleIconColor\"\n"
                },
                {
                    "date": 1752396264556,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -117,8 +117,14 @@\n         </div>\n       </div>\n     </template>\n   </AIProcessingTemplate>\n+\n+  <!-- 配置加载中 -->\n+  <div v-else class=\"config-loading\">\n+    <van-loading type=\"spinner\" size=\"24\" />\n+    <span>加载中...</span>\n+  </div>\n </template>\n \n <script setup>\n import { ref, computed, watch, onMounted } from 'vue'\n"
                },
                {
                    "date": 1752396282999,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -338,8 +338,20 @@\n   gap: 12px;\n   justify-content: center;\n }\n \n+/* 配置加载状态 */\n+.config-loading {\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  justify-content: center;\n+  padding: 40px 20px;\n+  gap: 12px;\n+  color: var(--van-text-color-2);\n+  font-size: 14px;\n+}\n+\n /* 深色主题适配 */\n @media (prefers-color-scheme: dark) {\n   /* 深色主题样式 */\n }\n"
                },
                {
                    "date": 1752412317146,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -78,18 +78,25 @@\n \n     <!-- 结果展示 -->\n     <template #result=\"{ result }\">\n       <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n-        <VantImageComparison\n+        <!-- 拖拽分割线对比组件 -->\n+        <ImageComparison\n           v-if=\"config.resultConfig.comparisonType === 'slider'\"\n           :original-image=\"originalImageForComparison\"\n           :result-image=\"result\"\n+          @reset=\"$emit('reset')\"\n+        />\n+\n+        <!-- 并排展示对比组件 -->\n+        <VantImageComparison\n+          v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n+          :original-image=\"originalImageForComparison\"\n+          :result-image=\"result\"\n           :process-info=\"processingInfo\"\n           @reset=\"$emit('reset')\"\n           @download=\"$emit('download', $event)\"\n         />\n-\n-        <!-- 可以在这里添加其他对比类型的组件 -->\n       </div>\n \n       <!-- 无对比的结果显示 -->\n       <div v-else class=\"simple-result\">\n"
                },
                {
                    "date": 1752412355714,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -139,8 +139,9 @@\n import {\n   AIProcessingTemplate,\n   VantImageComparison\n } from '../mobile'\n+import ImageComparison from '../ImageComparison.vue'\n import UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\n import { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\n \n // Props\n"
                },
                {
                    "date": 1752418644859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,26 +77,42 @@\n \n \n     <!-- 结果展示 -->\n     <template #result=\"{ result }\">\n-      <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n+      <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n         <!-- 拖拽分割线对比组件 -->\n         <ImageComparison\n           v-if=\"config.resultConfig.comparisonType === 'slider'\"\n           :original-image=\"originalImageForComparison\"\n           :result-image=\"result\"\n-          @reset=\"$emit('reset')\"\n         />\n \n         <!-- 并排展示对比组件 -->\n         <VantImageComparison\n           v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n           :original-image=\"originalImageForComparison\"\n           :result-image=\"result\"\n-          :process-info=\"processingInfo\"\n-          @reset=\"$emit('reset')\"\n-          @download=\"$emit('download', $event)\"\n         />\n+\n+        <!-- 操作按钮 -->\n+        <div class=\"result-actions\">\n+          <van-button\n+            v-if=\"config.resultConfig?.downloadEnabled\"\n+            type=\"primary\"\n+            size=\"small\"\n+            @click=\"$emit('download', result)\"\n+          >\n+            下载图片\n+          </van-button>\n+\n+          <van-button\n+            v-if=\"config.resultConfig?.resetEnabled\"\n+            size=\"small\"\n+            @click=\"$emit('reset')\"\n+          >\n+            重新生成\n+          </van-button>\n+        </div>\n       </div>\n \n       <!-- 无对比的结果显示 -->\n       <div v-else class=\"simple-result\">\n@@ -105,21 +121,19 @@\n         <div class=\"result-actions\">\n           <van-button\n             v-if=\"config.resultConfig?.downloadEnabled\"\n             type=\"primary\"\n-            size=\"large\"\n+            size=\"small\"\n             @click=\"$emit('download', result)\"\n           >\n-            <van-icon name=\"down\" />\n             下载图片\n           </van-button>\n \n           <van-button\n             v-if=\"config.resultConfig?.resetEnabled\"\n-            size=\"large\"\n+            size=\"small\"\n             @click=\"$emit('reset')\"\n           >\n-            <van-icon name=\"replay\" />\n             重新生成\n           </van-button>\n         </div>\n       </div>\n"
                },
                {
                    "date": 1752418675838,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -343,8 +343,15 @@\n }\n \n \n \n+.comparison-result {\n+  display: flex;\n+  flex-direction: column;\n+  align-items: center;\n+  gap: 24px;\n+}\n+\n .simple-result {\n   text-align: center;\n }\n \n"
                },
                {
                    "date": 1752421423923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,8 +17,10 @@\n     :result-data=\"resultData\"\n     @login=\"$emit('login', $event)\"\n     @logout=\"$emit('logout', $event)\"\n     @process=\"$emit('process')\"\n+    @download=\"$emit('download', $event)\"\n+    @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n       <!-- 图片上传面板 -->\n"
                },
                {
                    "date": 1752421440564,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,9 +77,9 @@\n     </template>\n \n \n \n-    <!-- 结果展示 -->\n+    <!-- 结果展示 - 只替代上传组件的位置 -->\n     <template #result=\"{ result }\">\n       <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n         <!-- 拖拽分割线对比组件 -->\n         <ImageComparison\n@@ -93,28 +93,8 @@\n           v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n           :original-image=\"originalImageForComparison\"\n           :result-image=\"result\"\n         />\n-\n-        <!-- 操作按钮 -->\n-        <div class=\"result-actions\">\n-          <van-button\n-            v-if=\"config.resultConfig?.downloadEnabled\"\n-            type=\"primary\"\n-            size=\"small\"\n-            @click=\"$emit('download', result)\"\n-          >\n-            下载图片\n-          </van-button>\n-\n-          <van-button\n-            v-if=\"config.resultConfig?.resetEnabled\"\n-            size=\"small\"\n-            @click=\"$emit('reset')\"\n-          >\n-            重新生成\n-          </van-button>\n-        </div>\n       </div>\n \n       <!-- 无对比的结果显示 -->\n       <div v-else class=\"simple-result\">\n"
                },
                {
                    "date": 1752421470444,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -180,9 +180,9 @@\n   }\n })\n \n // Emits\n-const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'upload-change', 'input-change'])\n+const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'reprocess', 'upload-change', 'input-change'])\n \n // 响应式数据\n const config = ref({\n   title: '',\n"
                },
                {
                    "date": 1752422767756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,10 +22,27 @@\n     @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n-      <!-- 图片上传面板 -->\n-      <template v-if=\"config.uploadPanels\">\n+      <!-- 有结果时显示对比组件，替换上传组件 -->\n+      <template v-if=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n+        <!-- 拖拽分割线对比组件 -->\n+        <ImageComparison\n+          v-if=\"config.resultConfig.comparisonType === 'slider'\"\n+          :original-image=\"originalImageForComparison\"\n+          :result-image=\"resultData\"\n+        />\n+\n+        <!-- 并排展示对比组件 -->\n+        <VantImageComparison\n+          v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n+          :original-image=\"originalImageForComparison\"\n+          :result-image=\"resultData\"\n+        />\n+      </template>\n+\n+      <!-- 无结果时显示图片上传面板 -->\n+      <template v-else-if=\"config.uploadPanels\">\n         <UnifiedImageUploadPanel\n           v-for=\"panel in config.uploadPanels\"\n           :key=\"panel.id\"\n           v-model=\"uploadData[panel.id]\"\n"
                },
                {
                    "date": 1752422787655,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -94,48 +94,13 @@\n     </template>\n \n \n \n-    <!-- 结果展示 - 只替代上传组件的位置 -->\n+    <!-- 结果展示 - 对比组件已移到输入区域，这里不再需要显示 -->\n     <template #result=\"{ result }\">\n-      <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n-        <!-- 拖拽分割线对比组件 -->\n-        <ImageComparison\n-          v-if=\"config.resultConfig.comparisonType === 'slider'\"\n-          :original-image=\"originalImageForComparison\"\n-          :result-image=\"result\"\n-        />\n-\n-        <!-- 并排展示对比组件 -->\n-        <VantImageComparison\n-          v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n-          :original-image=\"originalImageForComparison\"\n-          :result-image=\"result\"\n-        />\n-      </div>\n-\n-      <!-- 无对比的结果显示 -->\n-      <div v-else class=\"simple-result\">\n+      <!-- 当不使用对比功能时，显示简单的结果图片 -->\n+      <div v-if=\"!config.resultConfig?.showComparison || config.resultConfig.comparisonType === 'none'\" class=\"simple-result\">\n         <img :src=\"result\" alt=\"处理结果\" class=\"result-image\" />\n-\n-        <div class=\"result-actions\">\n-          <van-button\n-            v-if=\"config.resultConfig?.downloadEnabled\"\n-            type=\"primary\"\n-            size=\"small\"\n-            @click=\"$emit('download', result)\"\n-          >\n-            下载图片\n-          </van-button>\n-\n-          <van-button\n-            v-if=\"config.resultConfig?.resetEnabled\"\n-            size=\"small\"\n-            @click=\"$emit('reset')\"\n-          >\n-            重新生成\n-          </van-button>\n-        </div>\n       </div>\n     </template>\n   </AIProcessingTemplate>\n \n"
                },
                {
                    "date": 1752423321187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,8 +22,17 @@\n     @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n+      <!-- 调试信息 -->\n+      <!--\n+      Debug Info:\n+      resultData: {{ resultData }}\n+      config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}\n+      config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}\n+      originalImageForComparison: {{ originalImageForComparison }}\n+      -->\n+\n       <!-- 有结果时显示对比组件，替换上传组件 -->\n       <template v-if=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n         <!-- 拖拽分割线对比组件 -->\n         <ImageComparison\n"
                },
                {
                    "date": 1752423374457,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,8 +174,9 @@\n // Emits\n const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'reprocess', 'upload-change', 'input-change'])\n \n // 响应式数据\n+const configLoaded = ref(false)\n const config = ref({\n   title: '',\n   description: '',\n   processButtonText: '开始处理',\n"
                },
                {
                    "date": 1752423394163,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -217,17 +217,21 @@\n \n // 方法\n const loadConfig = async () => {\n   try {\n+    console.log('🔄 开始加载配置:', props.functionId)\n     const loadedConfig = await fetchImageProcessingConfigFromAPI(props.functionId)\n     if (loadedConfig) {\n       config.value = loadedConfig\n+      configLoaded.value = true\n+      console.log('✅ 配置加载成功:', loadedConfig)\n       initializeData()\n     } else {\n+      console.error('❌ 配置加载失败: 返回空配置')\n       Toast.fail('加载配置失败')\n     }\n   } catch (error) {\n-    console.error('加载配置失败:', error)\n+    console.error('❌ 加载配置失败:', error)\n     Toast.fail('加载配置失败')\n   }\n }\n \n"
                },
                {
                    "date": 1752423418416,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,10 +31,10 @@\n       config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}\n       originalImageForComparison: {{ originalImageForComparison }}\n       -->\n \n-      <!-- 有结果时显示对比组件，替换上传组件 -->\n-      <template v-if=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n+      <!-- 有结果且配置已加载时显示对比组件，替换上传组件 -->\n+      <template v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n         <!-- 拖拽分割线对比组件 -->\n         <ImageComparison\n           v-if=\"config.resultConfig.comparisonType === 'slider'\"\n           :original-image=\"originalImageForComparison\"\n@@ -48,10 +48,10 @@\n           :result-image=\"resultData\"\n         />\n       </template>\n \n-      <!-- 无结果时显示图片上传面板 -->\n-      <template v-else-if=\"config.uploadPanels\">\n+      <!-- 无结果或配置未加载时显示图片上传面板 -->\n+      <template v-else-if=\"configLoaded && config.uploadPanels\">\n         <UnifiedImageUploadPanel\n           v-for=\"panel in config.uploadPanels\"\n           :key=\"panel.id\"\n           v-model=\"uploadData[panel.id]\"\n"
                },
                {
                    "date": 1752423445787,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -214,8 +214,26 @@\n \n   return true\n })\n \n+// 调试用计算属性\n+const shouldShowComparison = computed(() => {\n+  const result = configLoaded.value &&\n+                 resultData.value &&\n+                 config.value.resultConfig?.showComparison &&\n+                 config.value.resultConfig.comparisonType !== 'none'\n+\n+  console.log('🔍 对比组件显示条件检查:', {\n+    configLoaded: configLoaded.value,\n+    hasResultData: !!resultData.value,\n+    showComparison: config.value.resultConfig?.showComparison,\n+    comparisonType: config.value.resultConfig?.comparisonType,\n+    shouldShow: result\n+  })\n+\n+  return result\n+})\n+\n // 方法\n const loadConfig = async () => {\n   try {\n     console.log('🔄 开始加载配置:', props.functionId)\n"
                },
                {
                    "date": 1752423463121,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n       originalImageForComparison: {{ originalImageForComparison }}\n       -->\n \n       <!-- 有结果且配置已加载时显示对比组件，替换上传组件 -->\n-      <template v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n+      <template v-if=\"shouldShowComparison\">\n         <!-- 拖拽分割线对比组件 -->\n         <ImageComparison\n           v-if=\"config.resultConfig.comparisonType === 'slider'\"\n           :original-image=\"originalImageForComparison\"\n"
                },
                {
                    "date": 1752423484303,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -278,8 +278,18 @@\n   inputData.value[panelId] = data\n   emit('input-change', panelId, data)\n }\n \n+// 监听resultData变化\n+watch(() => props.resultData, (newValue, oldValue) => {\n+  console.log('📊 resultData 变化:', {\n+    old: oldValue,\n+    new: newValue,\n+    configLoaded: configLoaded.value,\n+    resultConfig: config.value.resultConfig\n+  })\n+}, { immediate: true })\n+\n // 状态相关方法\n \n \n // 生命周期\n"
                },
                {
                    "date": 1752423500059,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,17 +22,10 @@\n     @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n-      <!-- 调试信息 -->\n-      <!--\n-      Debug Info:\n-      resultData: {{ resultData }}\n-      config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}\n-      config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}\n-      originalImageForComparison: {{ originalImageForComparison }}\n-      -->\n \n+\n       <!-- 有结果且配置已加载时显示对比组件，替换上传组件 -->\n       <template v-if=\"shouldShowComparison\">\n         <!-- 拖拽分割线对比组件 -->\n         <ImageComparison\n"
                },
                {
                    "date": 1752423941553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -210,15 +210,15 @@\n \n // 调试用计算属性\n const shouldShowComparison = computed(() => {\n   const result = configLoaded.value &&\n-                 resultData.value &&\n+                 props.resultData &&\n                  config.value.resultConfig?.showComparison &&\n                  config.value.resultConfig.comparisonType !== 'none'\n \n   console.log('🔍 对比组件显示条件检查:', {\n     configLoaded: configLoaded.value,\n-    hasResultData: !!resultData.value,\n+    hasResultData: !!props.resultData,\n     showComparison: config.value.resultConfig?.showComparison,\n     comparisonType: config.value.resultConfig?.comparisonType,\n     shouldShow: result\n   })\n"
                },
                {
                    "date": 1752424042700,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,14 +96,11 @@\n     </template>\n \n \n \n-    <!-- 结果展示 - 对比组件已移到输入区域，这里不再需要显示 -->\n+    <!-- 结果展示 - 对比组件已移到输入区域，这里不显示任何内容 -->\n     <template #result=\"{ result }\">\n-      <!-- 当不使用对比功能时，显示简单的结果图片 -->\n-      <div v-if=\"!config.resultConfig?.showComparison || config.resultConfig.comparisonType === 'none'\" class=\"simple-result\">\n-        <img :src=\"result\" alt=\"处理结果\" class=\"result-image\" />\n-      </div>\n+      <!-- 不显示任何内容，因为对比组件已经在输入区域显示 -->\n     </template>\n   </AIProcessingTemplate>\n \n   <!-- 配置加载中 -->\n"
                },
                {
                    "date": 1752424930356,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,29 +22,10 @@\n     @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n-\n-\n-      <!-- 有结果且配置已加载时显示对比组件，替换上传组件 -->\n-      <template v-if=\"shouldShowComparison\">\n-        <!-- 拖拽分割线对比组件 -->\n-        <ImageComparison\n-          v-if=\"config.resultConfig.comparisonType === 'slider'\"\n-          :original-image=\"originalImageForComparison\"\n-          :result-image=\"resultData\"\n-        />\n-\n-        <!-- 并排展示对比组件 -->\n-        <VantImageComparison\n-          v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n-          :original-image=\"originalImageForComparison\"\n-          :result-image=\"resultData\"\n-        />\n-      </template>\n-\n-      <!-- 无结果或配置未加载时显示图片上传面板 -->\n-      <template v-else-if=\"configLoaded && config.uploadPanels\">\n+      <!-- 图片上传面板 -->\n+      <template v-if=\"config.uploadPanels\">\n         <UnifiedImageUploadPanel\n           v-for=\"panel in config.uploadPanels\"\n           :key=\"panel.id\"\n           v-model=\"uploadData[panel.id]\"\n@@ -96,11 +77,49 @@\n     </template>\n \n \n \n-    <!-- 结果展示 - 对比组件已移到输入区域，这里不显示任何内容 -->\n+    <!-- 结果展示 - 只替代上传组件的位置 -->\n     <template #result=\"{ result }\">\n-      <!-- 不显示任何内容，因为对比组件已经在输入区域显示 -->\n+      <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n+        <!-- 拖拽分割线对比组件 -->\n+        <ImageComparison\n+          v-if=\"config.resultConfig.comparisonType === 'slider'\"\n+          :original-image=\"originalImageForComparison\"\n+          :result-image=\"result\"\n+        />\n+\n+        <!-- 并排展示对比组件 -->\n+        <VantImageComparison\n+          v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n+          :original-image=\"originalImageForComparison\"\n+          :result-image=\"result\"\n+        />\n+      </div>\n+\n+      <!-- 无对比的结果显示 -->\n+      <div v-else class=\"simple-result\">\n+        <img :src=\"result\" alt=\"处理结果\" class=\"result-image\" />\n+\n+        <div class=\"result-actions\">\n+          <van-button\n+            v-if=\"config.resultConfig?.downloadEnabled\"\n+            type=\"primary\"\n+            size=\"small\"\n+            @click=\"$emit('download', result)\"\n+          >\n+            下载图片\n+          </van-button>\n+\n+          <van-button\n+            v-if=\"config.resultConfig?.resetEnabled\"\n+            size=\"small\"\n+            @click=\"$emit('reset')\"\n+          >\n+            重新生成\n+          </van-button>\n+        </div>\n+      </div>\n     </template>\n   </AIProcessingTemplate>\n \n   <!-- 配置加载中 -->\n@@ -164,9 +183,8 @@\n // Emits\n const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'reprocess', 'upload-change', 'input-change'])\n \n // 响应式数据\n-const configLoaded = ref(false)\n const config = ref({\n   title: '',\n   description: '',\n   processButtonText: '开始处理',\n@@ -204,42 +222,20 @@\n \n   return true\n })\n \n-// 调试用计算属性\n-const shouldShowComparison = computed(() => {\n-  const result = configLoaded.value &&\n-                 props.resultData &&\n-                 config.value.resultConfig?.showComparison &&\n-                 config.value.resultConfig.comparisonType !== 'none'\n-\n-  console.log('🔍 对比组件显示条件检查:', {\n-    configLoaded: configLoaded.value,\n-    hasResultData: !!props.resultData,\n-    showComparison: config.value.resultConfig?.showComparison,\n-    comparisonType: config.value.resultConfig?.comparisonType,\n-    shouldShow: result\n-  })\n-\n-  return result\n-})\n-\n // 方法\n const loadConfig = async () => {\n   try {\n-    console.log('🔄 开始加载配置:', props.functionId)\n     const loadedConfig = await fetchImageProcessingConfigFromAPI(props.functionId)\n     if (loadedConfig) {\n       config.value = loadedConfig\n-      configLoaded.value = true\n-      console.log('✅ 配置加载成功:', loadedConfig)\n       initializeData()\n     } else {\n-      console.error('❌ 配置加载失败: 返回空配置')\n       Toast.fail('加载配置失败')\n     }\n   } catch (error) {\n-    console.error('❌ 加载配置失败:', error)\n+    console.error('加载配置失败:', error)\n     Toast.fail('加载配置失败')\n   }\n }\n \n@@ -268,18 +264,8 @@\n   inputData.value[panelId] = data\n   emit('input-change', panelId, data)\n }\n \n-// 监听resultData变化\n-watch(() => props.resultData, (newValue, oldValue) => {\n-  console.log('📊 resultData 变化:', {\n-    old: oldValue,\n-    new: newValue,\n-    configLoaded: configLoaded.value,\n-    resultConfig: config.value.resultConfig\n-  })\n-}, { immediate: true })\n-\n // 状态相关方法\n \n \n // 生命周期\n"
                },
                {
                    "date": 1752425894564,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,9 +31,28 @@\n           v-model=\"uploadData[panel.id]\"\n           :config=\"panel\"\n           :disabled=\"isProcessing\"\n           @change=\"handleUploadChange(panel.id, $event)\"\n-        />\n+        >\n+          <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n+          <template #comparison>\n+            <div v-if=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n+              <!-- 拖拽分割线对比组件 -->\n+              <ImageComparison\n+                v-if=\"config.resultConfig.comparisonType === 'slider'\"\n+                :original-image=\"originalImageForComparison\"\n+                :result-image=\"resultData\"\n+              />\n+\n+              <!-- 并排展示对比组件 -->\n+              <VantImageComparison\n+                v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n+                :original-image=\"originalImageForComparison\"\n+                :result-image=\"resultData\"\n+              />\n+            </div>\n+          </template>\n+        </UnifiedImageUploadPanel>\n       </template>\n \n       <!-- 文本输入面板 -->\n       <template v-if=\"config.inputPanels\">\n"
                },
                {
                    "date": 1752425913266,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -96,48 +96,12 @@\n     </template>\n \n \n \n-    <!-- 结果展示 - 只替代上传组件的位置 -->\n+    <!-- 结果展示 - 对比组件现在在插槽中，这里只处理无对比的情况 -->\n     <template #result=\"{ result }\">\n-      <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n-        <!-- 拖拽分割线对比组件 -->\n-        <ImageComparison\n-          v-if=\"config.resultConfig.comparisonType === 'slider'\"\n-          :original-image=\"originalImageForComparison\"\n-          :result-image=\"result\"\n-        />\n-\n-        <!-- 并排展示对比组件 -->\n-        <VantImageComparison\n-          v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n-          :original-image=\"originalImageForComparison\"\n-          :result-image=\"result\"\n-        />\n-      </div>\n-\n-      <!-- 无对比的结果显示 -->\n-      <div v-else class=\"simple-result\">\n+      <div v-if=\"!config.resultConfig?.showComparison || config.resultConfig.comparisonType === 'none'\" class=\"simple-result\">\n         <img :src=\"result\" alt=\"处理结果\" class=\"result-image\" />\n-\n-        <div class=\"result-actions\">\n-          <van-button\n-            v-if=\"config.resultConfig?.downloadEnabled\"\n-            type=\"primary\"\n-            size=\"small\"\n-            @click=\"$emit('download', result)\"\n-          >\n-            下载图片\n-          </van-button>\n-\n-          <van-button\n-            v-if=\"config.resultConfig?.resetEnabled\"\n-            size=\"small\"\n-            @click=\"$emit('reset')\"\n-          >\n-            重新生成\n-          </van-button>\n-        </div>\n       </div>\n     </template>\n   </AIProcessingTemplate>\n \n"
                },
                {
                    "date": 1752426248063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,8 +30,9 @@\n           :key=\"panel.id\"\n           v-model=\"uploadData[panel.id]\"\n           :config=\"panel\"\n           :disabled=\"isProcessing\"\n+          :should-hide-upload=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\"\n           @change=\"handleUploadChange(panel.id, $event)\"\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n"
                },
                {
                    "date": 1752426903862,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,8 +35,18 @@\n           @change=\"handleUploadChange(panel.id, $event)\"\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n+            <!-- 调试信息 -->\n+            <div v-if=\"true\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n+              <div>🔍 对比组件调试信息:</div>\n+              <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n+              <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\n+              <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\n+              <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\n+              <div>条件结果: {{ resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n+            </div>\n+\n             <div v-if=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n               <!-- 拖拽分割线对比组件 -->\n               <ImageComparison\n                 v-if=\"config.resultConfig.comparisonType === 'slider'\"\n"
                },
                {
                    "date": 1752427009116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -189,8 +189,9 @@\n   resultConfig: {}\n })\n const uploadData = ref({})\n const inputData = ref({})\n+const configLoaded = ref(false)\n \n // 计算属性\n const canProcess = computed(() => {\n   // 检查上传面板\n"
                },
                {
                    "date": 1752427025650,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -223,9 +223,11 @@\n   try {\n     const loadedConfig = await fetchImageProcessingConfigFromAPI(props.functionId)\n     if (loadedConfig) {\n       config.value = loadedConfig\n+      configLoaded.value = true\n       initializeData()\n+      console.log('✅ 配置加载完成:', config.value)\n     } else {\n       Toast.fail('加载配置失败')\n     }\n   } catch (error) {\n"
                },
                {
                    "date": 1752427049365,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,16 +38,17 @@\n           <template #comparison>\n             <!-- 调试信息 -->\n             <div v-if=\"true\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n               <div>🔍 对比组件调试信息:</div>\n+              <div>configLoaded: {{ configLoaded }}</div>\n               <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n               <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\n               <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\n               <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\n-              <div>条件结果: {{ resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n+              <div>条件结果: {{ configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n             </div>\n \n-            <div v-if=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n+            <div v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n               <!-- 拖拽分割线对比组件 -->\n               <ImageComparison\n                 v-if=\"config.resultConfig.comparisonType === 'slider'\"\n                 :original-image=\"originalImageForComparison\"\n"
                },
                {
                    "date": 1752427062138,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n           :key=\"panel.id\"\n           v-model=\"uploadData[panel.id]\"\n           :config=\"panel\"\n           :disabled=\"isProcessing\"\n-          :should-hide-upload=\"resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\"\n+          :should-hide-upload=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\"\n           @change=\"handleUploadChange(panel.id, $event)\"\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n"
                },
                {
                    "date": 1752427080459,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,18 +35,20 @@\n           @change=\"handleUploadChange(panel.id, $event)\"\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n-            <!-- 调试信息 -->\n-            <div v-if=\"true\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n+            <!-- 调试信息 - 开发时可启用 -->\n+            <!--\n+            <div style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n               <div>🔍 对比组件调试信息:</div>\n               <div>configLoaded: {{ configLoaded }}</div>\n               <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n               <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\n               <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\n               <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\n               <div>条件结果: {{ configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n             </div>\n+            -->\n \n             <div v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n               <!-- 拖拽分割线对比组件 -->\n               <ImageComparison\n"
                },
                {
                    "date": 1752427435976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,13 +110,11 @@\n     </template>\n \n \n \n-    <!-- 结果展示 - 对比组件现在在插槽中，这里只处理无对比的情况 -->\n+    <!-- 结果展示 - 对比组件现在在inputs插槽中，这里不需要显示任何内容 -->\n     <template #result=\"{ result }\">\n-      <div v-if=\"!config.resultConfig?.showComparison || config.resultConfig.comparisonType === 'none'\" class=\"simple-result\">\n-        <img :src=\"result\" alt=\"处理结果\" class=\"result-image\" />\n-      </div>\n+      <!-- 不显示任何内容，因为对比组件已经在inputs插槽中显示 -->\n     </template>\n   </AIProcessingTemplate>\n \n   <!-- 配置加载中 -->\n"
                },
                {
                    "date": 1752429309915,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -324,12 +324,11 @@\n \n \n \n .comparison-result {\n-  display: flex;\n-  flex-direction: column;\n-  align-items: center;\n-  gap: 24px;\n+  /* 移除flex布局，使用块级布局确保子元素占满宽度 */\n+  width: 100%;\n+  margin: 0 auto;\n }\n \n .simple-result {\n   text-align: center;\n"
                },
                {
                    "date": 1752429746602,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -324,11 +324,12 @@\n \n \n \n .comparison-result {\n-  /* 移除flex布局，使用块级布局确保子元素占满宽度 */\n+  /* 确保对比组件居中显示 */\n   width: 100%;\n   margin: 0 auto;\n+  text-align: center; /* 居中对比组件 */\n }\n \n .simple-result {\n   text-align: center;\n"
                },
                {
                    "date": 1752433395512,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,8 +132,9 @@\n   VantImageComparison\n } from '../mobile'\n import ImageComparison from '../ImageComparison.vue'\n import UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\n+import ServerStatusPanel from '../ServerStatusPanel.vue'\n import { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\n \n // Props\n const props = defineProps({\n"
                },
                {
                    "date": 1752433418380,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,8 +22,11 @@\n     @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n+      <!-- 服务器状态面板 -->\n+      <ServerStatusPanel v-if=\"showServerStatus\" />\n+\n       <!-- 图片上传面板 -->\n       <template v-if=\"config.uploadPanels\">\n         <UnifiedImageUploadPanel\n           v-for=\"panel in config.uploadPanels\"\n"
                },
                {
                    "date": 1752433448057,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -195,8 +195,9 @@\n })\n const uploadData = ref({})\n const inputData = ref({})\n const configLoaded = ref(false)\n+const showServerStatus = ref(false) // 控制服务器状态面板显示\n \n // 计算属性\n const canProcess = computed(() => {\n   // 检查上传面板\n"
                },
                {
                    "date": 1752433493117,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -270,13 +270,38 @@\n \n // 状态相关方法\n \n \n+// 切换服务器状态面板显示（可以通过快捷键或其他方式触发）\n+const toggleServerStatus = () => {\n+  showServerStatus.value = !showServerStatus.value\n+}\n+\n+// 监听键盘事件，Ctrl+Shift+S 切换服务器状态面板\n+const handleKeydown = (event) => {\n+  if (event.ctrlKey && event.shiftKey && event.key === 'S') {\n+    event.preventDefault()\n+    toggleServerStatus()\n+  }\n+}\n+\n // 生命周期\n onMounted(() => {\n   loadConfig()\n+\n+  // 在开发环境或出现网络问题时显示服务器状态面板\n+  if (import.meta.env.DEV) {\n+    showServerStatus.value = true\n+  }\n+\n+  // 添加键盘事件监听\n+  document.addEventListener('keydown', handleKeydown)\n })\n \n+onUnmounted(() => {\n+  document.removeEventListener('keydown', handleKeydown)\n+})\n+\n // 暴露数据给父组件\n defineExpose({\n   uploadData,\n   inputData,\n"
                },
                {
                    "date": 1752433508290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -127,9 +127,9 @@\n   </div>\n </template>\n \n <script setup>\n-import { ref, computed, watch, onMounted } from 'vue'\n+import { ref, computed, watch, onMounted, onUnmounted } from 'vue'\n import { Toast } from 'vant'\n import {\n   AIProcessingTemplate,\n   VantImageComparison\n"
                },
                {
                    "date": 1752435193875,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -22,11 +22,8 @@\n     @reprocess=\"$emit('reprocess')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n-      <!-- 服务器状态面板 -->\n-      <ServerStatusPanel v-if=\"showServerStatus\" />\n-\n       <!-- 图片上传面板 -->\n       <template v-if=\"config.uploadPanels\">\n         <UnifiedImageUploadPanel\n           v-for=\"panel in config.uploadPanels\"\n"
                },
                {
                    "date": 1752435209003,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -132,9 +132,8 @@\n   VantImageComparison\n } from '../mobile'\n import ImageComparison from '../ImageComparison.vue'\n import UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\n-import ServerStatusPanel from '../ServerStatusPanel.vue'\n import { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\n \n // Props\n const props = defineProps({\n"
                },
                {
                    "date": 1752435223749,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -191,9 +191,8 @@\n })\n const uploadData = ref({})\n const inputData = ref({})\n const configLoaded = ref(false)\n-const showServerStatus = ref(false) // 控制服务器状态面板显示\n \n // 计算属性\n const canProcess = computed(() => {\n   // 检查上传面板\n"
                },
                {
                    "date": 1752435244074,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -265,38 +265,13 @@\n \n // 状态相关方法\n \n \n-// 切换服务器状态面板显示（可以通过快捷键或其他方式触发）\n-const toggleServerStatus = () => {\n-  showServerStatus.value = !showServerStatus.value\n-}\n-\n-// 监听键盘事件，Ctrl+Shift+S 切换服务器状态面板\n-const handleKeydown = (event) => {\n-  if (event.ctrlKey && event.shiftKey && event.key === 'S') {\n-    event.preventDefault()\n-    toggleServerStatus()\n-  }\n-}\n-\n // 生命周期\n onMounted(() => {\n   loadConfig()\n-\n-  // 在开发环境或出现网络问题时显示服务器状态面板\n-  if (import.meta.env.DEV) {\n-    showServerStatus.value = true\n-  }\n-\n-  // 添加键盘事件监听\n-  document.addEventListener('keydown', handleKeydown)\n })\n \n-onUnmounted(() => {\n-  document.removeEventListener('keydown', handleKeydown)\n-})\n-\n // 暴露数据给父组件\n defineExpose({\n   uploadData,\n   inputData,\n"
                },
                {
                    "date": 1752435261406,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -124,9 +124,9 @@\n   </div>\n </template>\n \n <script setup>\n-import { ref, computed, watch, onMounted, onUnmounted } from 'vue'\n+import { ref, computed, watch, onMounted } from 'vue'\n import { Toast } from 'vant'\n import {\n   AIProcessingTemplate,\n   VantImageComparison\n"
                },
                {
                    "date": 1752435757812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n     @login=\"$emit('login', $event)\"\n     @logout=\"$emit('logout', $event)\"\n     @process=\"$emit('process')\"\n     @download=\"$emit('download', $event)\"\n-    @reprocess=\"$emit('reprocess')\"\n+    @reset=\"$emit('reset')\"\n   >\n     <!-- 输入区域 -->\n     <template #inputs>\n       <!-- 图片上传面板 -->\n"
                },
                {
                    "date": 1752435773106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,9 +175,9 @@\n   }\n })\n \n // Emits\n-const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'reprocess', 'upload-change', 'input-change'])\n+const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'upload-change', 'input-change'])\n \n // 响应式数据\n const config = ref({\n   title: '',\n"
                },
                {
                    "date": 1752499176165,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,19 +36,17 @@\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n             <!-- 调试信息 - 开发时可启用 -->\n-            <!--\n-            <div style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n+            <div v-if=\"import.meta.env.DEV\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n               <div>🔍 对比组件调试信息:</div>\n               <div>configLoaded: {{ configLoaded }}</div>\n               <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n               <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\n               <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\n               <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\n               <div>条件结果: {{ configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n             </div>\n-            -->\n \n             <div v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n               <!-- 拖拽分割线对比组件 -->\n               <ImageComparison\n"
                },
                {
                    "date": 1752500253046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,9 +36,9 @@\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n             <!-- 调试信息 - 开发时可启用 -->\n-            <div v-if=\"import.meta.env.DEV\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n+            <div v-if=\"isDevelopment\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n               <div>🔍 对比组件调试信息:</div>\n               <div>configLoaded: {{ configLoaded }}</div>\n               <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n               <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\n"
                },
                {
                    "date": 1752500315885,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -191,8 +191,12 @@\n const inputData = ref({})\n const configLoaded = ref(false)\n \n // 计算属性\n+const isDevelopment = computed(() => {\n+  return import.meta.env.DEV\n+})\n+\n const canProcess = computed(() => {\n   // 检查上传面板\n   if (config.value.uploadPanels) {\n     for (const panel of config.value.uploadPanels) {\n"
                },
                {
                    "date": 1752500713355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,10 @@\n           @change=\"handleUploadChange(panel.id, $event)\"\n         >\n           <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n           <template #comparison>\n-            <!-- 调试信息 - 开发时可启用 -->\n+            <!-- 调试信息 - 暂时禁用 -->\n+            <!--\n             <div v-if=\"isDevelopment\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n               <div>🔍 对比组件调试信息:</div>\n               <div>configLoaded: {{ configLoaded }}</div>\n               <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n@@ -45,8 +46,9 @@\n               <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\n               <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\n               <div>条件结果: {{ configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n             </div>\n+            -->\n \n             <div v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n               <!-- 拖拽分割线对比组件 -->\n               <ImageComparison\n"
                },
                {
                    "date": 1753531709964,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,372 +1,372 @@\n-<template>\n-  <AIProcessingTemplate\n-    v-if=\"config.title\"\n-    :title=\"config.title\"\n-    :description=\"config.description\"\n-    :title-icon=\"titleIcon\"\n-    :title-icon-color=\"titleIconColor\"\n-    :is-processing=\"isProcessing\"\n-    :can-process=\"canProcess\"\n-    :show-upload-tips=\"false\"\n-    :process-button-text=\"config.processButtonText\"\n-    :process-button-icon=\"processButtonIcon\"\n-    :progress=\"progress\"\n-    :processing-title=\"config.processingTitle\"\n-    :processing-description=\"config.processingDescription\"\n-    :processing-info=\"processingInfo\"\n-    :result-data=\"resultData\"\n-    @login=\"$emit('login', $event)\"\n-    @logout=\"$emit('logout', $event)\"\n-    @process=\"$emit('process')\"\n-    @download=\"$emit('download', $event)\"\n-    @reset=\"$emit('reset')\"\n-  >\n-    <!-- 输入区域 -->\n-    <template #inputs>\n-      <!-- 图片上传面板 -->\n-      <template v-if=\"config.uploadPanels\">\n-        <UnifiedImageUploadPanel\n-          v-for=\"panel in config.uploadPanels\"\n-          :key=\"panel.id\"\n-          v-model=\"uploadData[panel.id]\"\n-          :config=\"panel\"\n-          :disabled=\"isProcessing\"\n-          :should-hide-upload=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\"\n-          @change=\"handleUploadChange(panel.id, $event)\"\n-        >\n-          <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\n-          <template #comparison>\n-            <!-- 调试信息 - 暂时禁用 -->\n-            <!--\n-            <div v-if=\"isDevelopment\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\n-              <div>🔍 对比组件调试信息:</div>\n-              <div>configLoaded: {{ configLoaded }}</div>\n-              <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\n-              <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\n-              <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\n-              <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\n-              <div>条件结果: {{ configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\n-            </div>\n-            -->\n-\n-            <div v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\n-              <!-- 拖拽分割线对比组件 -->\n-              <ImageComparison\n-                v-if=\"config.resultConfig.comparisonType === 'slider'\"\n-                :original-image=\"originalImageForComparison\"\n-                :result-image=\"resultData\"\n-              />\n-\n-              <!-- 并排展示对比组件 -->\n-              <VantImageComparison\n-                v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\n-                :original-image=\"originalImageForComparison\"\n-                :result-image=\"resultData\"\n-              />\n-            </div>\n-          </template>\n-        </UnifiedImageUploadPanel>\n-      </template>\n-\n-      <!-- 文本输入面板 -->\n-      <template v-if=\"config.inputPanels\">\n-        <div\n-          v-for=\"panel in config.inputPanels\"\n-          :key=\"panel.id\"\n-          class=\"input-panel\"\n-        >\n-          <div class=\"panel-header\">\n-            <van-icon\n-              :name=\"panel.icon\"\n-              :color=\"panel.iconColor\"\n-              size=\"18\"\n-            />\n-            <span class=\"panel-title\">{{ panel.title }}</span>\n-          </div>\n-\n-          <van-field\n-            v-if=\"panel.type === 'text'\"\n-            v-model=\"inputData[panel.id]\"\n-            :placeholder=\"panel.placeholder\"\n-            :rows=\"panel.rows\"\n-            :maxlength=\"panel.maxLength\"\n-            :disabled=\"isProcessing\"\n-            type=\"textarea\"\n-            show-word-limit\n-            autosize\n-            class=\"text-input\"\n-            @input=\"handleInputChange(panel.id, $event)\"\n-          />\n-\n-          <!-- 提示信息 -->\n-          <div v-if=\"panel.tips && panel.tips.length > 0\" class=\"tips-section\">\n-            <div v-for=\"(tip, index) in panel.tips\" :key=\"index\" class=\"tip-item\">\n-              <van-icon name=\"info-o\" size=\"12\" color=\"var(--van-text-color-3)\" />\n-              <span>{{ tip }}</span>\n-            </div>\n-          </div>\n-        </div>\n-      </template>\n-    </template>\n-\n-\n-\n-    <!-- 结果展示 - 对比组件现在在inputs插槽中，这里不需要显示任何内容 -->\n-    <template #result=\"{ result }\">\n-      <!-- 不显示任何内容，因为对比组件已经在inputs插槽中显示 -->\n-    </template>\n-  </AIProcessingTemplate>\n-\n-  <!-- 配置加载中 -->\n-  <div v-else class=\"config-loading\">\n-    <van-loading type=\"spinner\" size=\"24\" />\n-    <span>加载中...</span>\n-  </div>\n-</template>\n-\n-<script setup>\n-import { ref, computed, watch, onMounted } from 'vue'\n-import { Toast } from 'vant'\n-import {\n-  AIProcessingTemplate,\n-  VantImageComparison\n-} from '../mobile'\n-import ImageComparison from '../ImageComparison.vue'\n-import UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\n-import { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\n-\n-// Props\n-const props = defineProps({\n-  functionId: {\n-    type: String,\n-    required: true\n-  },\n-  titleIcon: {\n-    type: [Object, String],\n-    default: null\n-  },\n-  titleIconColor: {\n-    type: String,\n-    default: 'var(--van-primary-color)'\n-  },\n-  processButtonIcon: {\n-    type: [Object, String],\n-    default: null\n-  },\n-  isProcessing: {\n-    type: Boolean,\n-    default: false\n-  },\n-  progress: {\n-    type: Number,\n-    default: 0\n-  },\n-  processingInfo: {\n-    type: Object,\n-    default: () => ({})\n-  },\n-  resultData: {\n-    type: String,\n-    default: null\n-  },\n-  originalImageForComparison: {\n-    type: String,\n-    default: null\n-  }\n-})\n-\n-// Emits\n-const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'upload-change', 'input-change'])\n-\n-// 响应式数据\n-const config = ref({\n-  title: '',\n-  description: '',\n-  processButtonText: '开始处理',\n-  processingTitle: '正在处理...',\n-  processingDescription: '请耐心等待',\n-  uploadPanels: [],\n-  inputPanels: [],\n-  resultConfig: {}\n-})\n-const uploadData = ref({})\n-const inputData = ref({})\n-const configLoaded = ref(false)\n-\n-// 计算属性\n-const isDevelopment = computed(() => {\n-  return import.meta.env.DEV\n-})\n-\n-const canProcess = computed(() => {\n-  // 检查上传面板\n-  if (config.value.uploadPanels) {\n-    for (const panel of config.value.uploadPanels) {\n-      const data = uploadData.value[panel.id]\n-      if (panel.uploadType === 'single') {\n-        if (!data && panel.minCount > 0) return false\n-      } else {\n-        const count = Array.isArray(data) ? data.length : 0\n-        if (count < panel.minCount) return false\n-      }\n-    }\n-  }\n-\n-  // 检查输入面板\n-  if (config.value.inputPanels) {\n-    for (const panel of config.value.inputPanels) {\n-      const data = inputData.value[panel.id]\n-      if (panel.required && (!data || data.trim() === '')) return false\n-    }\n-  }\n-\n-  return true\n-})\n-\n-// 方法\n-const loadConfig = async () => {\n-  try {\n-    const loadedConfig = await fetchImageProcessingConfigFromAPI(props.functionId)\n-    if (loadedConfig) {\n-      config.value = loadedConfig\n-      configLoaded.value = true\n-      initializeData()\n-      console.log('✅ 配置加载完成:', config.value)\n-    } else {\n-      Toast.fail('加载配置失败')\n-    }\n-  } catch (error) {\n-    console.error('加载配置失败:', error)\n-    Toast.fail('加载配置失败')\n-  }\n-}\n-\n-const initializeData = () => {\n-  // 初始化上传数据\n-  if (config.value.uploadPanels) {\n-    config.value.uploadPanels.forEach(panel => {\n-      uploadData.value[panel.id] = panel.uploadType === 'single' ? null : []\n-    })\n-  }\n-\n-  // 初始化输入数据\n-  if (config.value.inputPanels) {\n-    config.value.inputPanels.forEach(panel => {\n-      inputData.value[panel.id] = ''\n-    })\n-  }\n-}\n-\n-const handleUploadChange = (panelId, data) => {\n-  uploadData.value[panelId] = data\n-  emit('upload-change', panelId, data)\n-}\n-\n-const handleInputChange = (panelId, data) => {\n-  inputData.value[panelId] = data\n-  emit('input-change', panelId, data)\n-}\n-\n-// 状态相关方法\n-\n-\n-// 生命周期\n-onMounted(() => {\n-  loadConfig()\n-})\n-\n-// 暴露数据给父组件\n-defineExpose({\n-  uploadData,\n-  inputData,\n-  config\n-})\n-</script>\n-\n-<style scoped>\n-.input-panel {\n-  background: rgba(15, 15, 30, 0.6);\n-  border-radius: 12px;\n-  border: 1px solid rgba(30, 30, 60, 0.5);\n-  padding: 16px;\n-  margin-bottom: 16px;\n-}\n-\n-.panel-header {\n-  display: flex;\n-  align-items: center;\n-  gap: 8px;\n-  margin-bottom: 16px;\n-  color: var(--van-text-color, #f7f8fa);\n-}\n-\n-.panel-title {\n-  font-size: 16px;\n-  font-weight: 600;\n-}\n-\n-.text-input {\n-  --van-field-background: rgba(255, 255, 255, 0.05);\n-  --van-field-border-color: rgba(255, 255, 255, 0.1);\n-  --van-field-text-color: var(--van-text-color);\n-}\n-\n-.tips-section {\n-  display: flex;\n-  flex-direction: column;\n-  gap: 6px;\n-  margin-top: 12px;\n-}\n-\n-.tip-item {\n-  display: flex;\n-  align-items: center;\n-  gap: 6px;\n-  font-size: 12px;\n-  color: var(--van-text-color-3);\n-}\n-\n-\n-\n-.comparison-result {\n-  /* 确保对比组件居中显示 */\n-  width: 100%;\n-  margin: 0 auto;\n-  text-align: center; /* 居中对比组件 */\n-}\n-\n-.simple-result {\n-  text-align: center;\n-}\n-\n-.result-image {\n-  width: 100%;\n-  max-width: 400px;\n-  border-radius: 8px;\n-  margin-bottom: 16px;\n-}\n-\n-.result-actions {\n-  display: flex;\n-  gap: 12px;\n-  justify-content: center;\n-}\n-\n-/* 配置加载状态 */\n-.config-loading {\n-  display: flex;\n-  flex-direction: column;\n-  align-items: center;\n-  justify-content: center;\n-  padding: 40px 20px;\n-  gap: 12px;\n-  color: var(--van-text-color-2);\n-  font-size: 14px;\n-}\n-\n-/* 深色主题适配 */\n-@media (prefers-color-scheme: dark) {\n-  /* 深色主题样式 */\n-}\n-</style>\n-\n+<template>\r\n+  <AIProcessingTemplate\r\n+    v-if=\"config.title\"\r\n+    :title=\"config.title\"\r\n+    :description=\"config.description\"\r\n+    :title-icon=\"titleIcon\"\r\n+    :title-icon-color=\"titleIconColor\"\r\n+    :is-processing=\"isProcessing\"\r\n+    :can-process=\"canProcess\"\r\n+    :show-upload-tips=\"false\"\r\n+    :process-button-text=\"config.processButtonText\"\r\n+    :process-button-icon=\"processButtonIcon\"\r\n+    :progress=\"progress\"\r\n+    :processing-title=\"config.processingTitle\"\r\n+    :processing-description=\"config.processingDescription\"\r\n+    :processing-info=\"processingInfo\"\r\n+    :result-data=\"resultData\"\r\n+    @login=\"$emit('login', $event)\"\r\n+    @logout=\"$emit('logout', $event)\"\r\n+    @process=\"$emit('process')\"\r\n+    @download=\"$emit('download', $event)\"\r\n+    @reset=\"$emit('reset')\"\r\n+  >\r\n+    <!-- 输入区域 -->\r\n+    <template #inputs>\r\n+      <!-- 图片上传面板 -->\r\n+      <template v-if=\"config.uploadPanels\">\r\n+        <UnifiedImageUploadPanel\r\n+          v-for=\"panel in config.uploadPanels\"\r\n+          :key=\"panel.id\"\r\n+          v-model=\"uploadData[panel.id]\"\r\n+          :config=\"panel\"\r\n+          :disabled=\"isProcessing\"\r\n+          :should-hide-upload=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\"\r\n+          @change=\"handleUploadChange(panel.id, $event)\"\r\n+        >\r\n+          <!-- 对比组件插槽 - 在panel-header和status-section之间 -->\r\n+          <template #comparison>\r\n+            <!-- 调试信息 - 暂时禁用 -->\r\n+            <!--\r\n+            <div v-if=\"isDevelopment\" style=\"background: rgba(255,0,0,0.1); padding: 10px; margin: 10px 0; border-radius: 8px; color: white; font-size: 12px;\">\r\n+              <div>🔍 对比组件调试信息:</div>\r\n+              <div>configLoaded: {{ configLoaded }}</div>\r\n+              <div>resultData: {{ !!resultData }} ({{ typeof resultData }})</div>\r\n+              <div>originalImageForComparison: {{ !!originalImageForComparison }} ({{ typeof originalImageForComparison }})</div>\r\n+              <div>config.resultConfig?.showComparison: {{ config.resultConfig?.showComparison }}</div>\r\n+              <div>config.resultConfig?.comparisonType: {{ config.resultConfig?.comparisonType }}</div>\r\n+              <div>条件结果: {{ configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none' }}</div>\r\n+            </div>\r\n+            -->\r\n+\r\n+            <div v-if=\"configLoaded && resultData && config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\" class=\"comparison-result\">\r\n+              <!-- 拖拽分割线对比组件 -->\r\n+              <ImageComparison\r\n+                v-if=\"config.resultConfig.comparisonType === 'slider'\"\r\n+                :original-image=\"originalImageForComparison\"\r\n+                :result-image=\"resultData\"\r\n+              />\r\n+\r\n+              <!-- 并排展示对比组件 -->\r\n+              <VantImageComparison\r\n+                v-else-if=\"config.resultConfig.comparisonType === 'side-by-side'\"\r\n+                :original-image=\"originalImageForComparison\"\r\n+                :result-image=\"resultData\"\r\n+              />\r\n+            </div>\r\n+          </template>\r\n+        </UnifiedImageUploadPanel>\r\n+      </template>\r\n+\r\n+      <!-- 文本输入面板 -->\r\n+      <template v-if=\"config.inputPanels\">\r\n+        <div\r\n+          v-for=\"panel in config.inputPanels\"\r\n+          :key=\"panel.id\"\r\n+          class=\"input-panel\"\r\n+        >\r\n+          <div class=\"panel-header\">\r\n+            <van-icon\r\n+              :name=\"panel.icon\"\r\n+              :color=\"panel.iconColor\"\r\n+              size=\"18\"\r\n+            />\r\n+            <span class=\"panel-title\">{{ panel.title }}</span>\r\n+          </div>\r\n+\r\n+          <van-field\r\n+            v-if=\"panel.type === 'text'\"\r\n+            v-model=\"inputData[panel.id]\"\r\n+            :placeholder=\"panel.placeholder\"\r\n+            :rows=\"panel.rows\"\r\n+            :maxlength=\"panel.maxLength\"\r\n+            :disabled=\"isProcessing\"\r\n+            type=\"textarea\"\r\n+            show-word-limit\r\n+            autosize\r\n+            class=\"text-input\"\r\n+            @input=\"handleInputChange(panel.id, $event)\"\r\n+          />\r\n+\r\n+          <!-- 提示信息 -->\r\n+          <div v-if=\"panel.tips && panel.tips.length > 0\" class=\"tips-section\">\r\n+            <div v-for=\"(tip, index) in panel.tips\" :key=\"index\" class=\"tip-item\">\r\n+              <van-icon name=\"info-o\" size=\"12\" color=\"var(--van-text-color-3)\" />\r\n+              <span>{{ tip }}</span>\r\n+            </div>\r\n+          </div>\r\n+        </div>\r\n+      </template>\r\n+    </template>\r\n+\r\n+\r\n+\r\n+    <!-- 结果展示 - 对比组件现在在inputs插槽中，这里不需要显示任何内容 -->\r\n+    <template #result=\"{ result }\">\r\n+      <!-- 不显示任何内容，因为对比组件已经在inputs插槽中显示 -->\r\n+    </template>\r\n+  </AIProcessingTemplate>\r\n+\r\n+  <!-- 配置加载中 -->\r\n+  <div v-else class=\"config-loading\">\r\n+    <van-loading type=\"spinner\" size=\"24\" />\r\n+    <span>加载中...</span>\r\n+  </div>\r\n+</template>\r\n+\r\n+<script setup>\r\n+import { ref, computed, watch, onMounted } from 'vue'\r\n+import { Toast } from 'vant'\r\n+import {\r\n+  AIProcessingTemplate,\r\n+  VantImageComparison\r\n+} from '../mobile'\r\n+import ImageComparison from '../ImageComparison.vue'\r\n+import UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\r\n+import { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\r\n+\r\n+// Props\r\n+const props = defineProps({\r\n+  functionId: {\r\n+    type: String,\r\n+    required: true\r\n+  },\r\n+  titleIcon: {\r\n+    type: [Object, String],\r\n+    default: null\r\n+  },\r\n+  titleIconColor: {\r\n+    type: String,\r\n+    default: 'var(--van-primary-color)'\r\n+  },\r\n+  processButtonIcon: {\r\n+    type: [Object, String],\r\n+    default: null\r\n+  },\r\n+  isProcessing: {\r\n+    type: Boolean,\r\n+    default: false\r\n+  },\r\n+  progress: {\r\n+    type: Number,\r\n+    default: 0\r\n+  },\r\n+  processingInfo: {\r\n+    type: Object,\r\n+    default: () => ({})\r\n+  },\r\n+  resultData: {\r\n+    type: String,\r\n+    default: null\r\n+  },\r\n+  originalImageForComparison: {\r\n+    type: String,\r\n+    default: null\r\n+  }\r\n+})\r\n+\r\n+// Emits\r\n+const emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'upload-change', 'input-change'])\r\n+\r\n+// 响应式数据\r\n+const config = ref({\r\n+  title: '',\r\n+  description: '',\r\n+  processButtonText: '开始处理',\r\n+  processingTitle: '正在处理...',\r\n+  processingDescription: '',\r\n+  uploadPanels: [],\r\n+  inputPanels: [],\r\n+  resultConfig: {}\r\n+})\r\n+const uploadData = ref({})\r\n+const inputData = ref({})\r\n+const configLoaded = ref(false)\r\n+\r\n+// 计算属性\r\n+const isDevelopment = computed(() => {\r\n+  return import.meta.env.DEV\r\n+})\r\n+\r\n+const canProcess = computed(() => {\r\n+  // 检查上传面板\r\n+  if (config.value.uploadPanels) {\r\n+    for (const panel of config.value.uploadPanels) {\r\n+      const data = uploadData.value[panel.id]\r\n+      if (panel.uploadType === 'single') {\r\n+        if (!data && panel.minCount > 0) return false\r\n+      } else {\r\n+        const count = Array.isArray(data) ? data.length : 0\r\n+        if (count < panel.minCount) return false\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  // 检查输入面板\r\n+  if (config.value.inputPanels) {\r\n+    for (const panel of config.value.inputPanels) {\r\n+      const data = inputData.value[panel.id]\r\n+      if (panel.required && (!data || data.trim() === '')) return false\r\n+    }\r\n+  }\r\n+\r\n+  return true\r\n+})\r\n+\r\n+// 方法\r\n+const loadConfig = async () => {\r\n+  try {\r\n+    const loadedConfig = await fetchImageProcessingConfigFromAPI(props.functionId)\r\n+    if (loadedConfig) {\r\n+      config.value = loadedConfig\r\n+      configLoaded.value = true\r\n+      initializeData()\r\n+      console.log('✅ 配置加载完成:', config.value)\r\n+    } else {\r\n+      Toast.fail('加载配置失败')\r\n+    }\r\n+  } catch (error) {\r\n+    console.error('加载配置失败:', error)\r\n+    Toast.fail('加载配置失败')\r\n+  }\r\n+}\r\n+\r\n+const initializeData = () => {\r\n+  // 初始化上传数据\r\n+  if (config.value.uploadPanels) {\r\n+    config.value.uploadPanels.forEach(panel => {\r\n+      uploadData.value[panel.id] = panel.uploadType === 'single' ? null : []\r\n+    })\r\n+  }\r\n+\r\n+  // 初始化输入数据\r\n+  if (config.value.inputPanels) {\r\n+    config.value.inputPanels.forEach(panel => {\r\n+      inputData.value[panel.id] = ''\r\n+    })\r\n+  }\r\n+}\r\n+\r\n+const handleUploadChange = (panelId, data) => {\r\n+  uploadData.value[panelId] = data\r\n+  emit('upload-change', panelId, data)\r\n+}\r\n+\r\n+const handleInputChange = (panelId, data) => {\r\n+  inputData.value[panelId] = data\r\n+  emit('input-change', panelId, data)\r\n+}\r\n+\r\n+// 状态相关方法\r\n+\r\n+\r\n+// 生命周期\r\n+onMounted(() => {\r\n+  loadConfig()\r\n+})\r\n+\r\n+// 暴露数据给父组件\r\n+defineExpose({\r\n+  uploadData,\r\n+  inputData,\r\n+  config\r\n+})\r\n+</script>\r\n+\r\n+<style scoped>\r\n+.input-panel {\r\n+  background: rgba(15, 15, 30, 0.6);\r\n+  border-radius: 12px;\r\n+  border: 1px solid rgba(30, 30, 60, 0.5);\r\n+  padding: 16px;\r\n+  margin-bottom: 16px;\r\n+}\r\n+\r\n+.panel-header {\r\n+  display: flex;\r\n+  align-items: center;\r\n+  gap: 8px;\r\n+  margin-bottom: 16px;\r\n+  color: var(--van-text-color, #f7f8fa);\r\n+}\r\n+\r\n+.panel-title {\r\n+  font-size: 16px;\r\n+  font-weight: 600;\r\n+}\r\n+\r\n+.text-input {\r\n+  --van-field-background: rgba(255, 255, 255, 0.05);\r\n+  --van-field-border-color: rgba(255, 255, 255, 0.1);\r\n+  --van-field-text-color: var(--van-text-color);\r\n+}\r\n+\r\n+.tips-section {\r\n+  display: flex;\r\n+  flex-direction: column;\r\n+  gap: 6px;\r\n+  margin-top: 12px;\r\n+}\r\n+\r\n+.tip-item {\r\n+  display: flex;\r\n+  align-items: center;\r\n+  gap: 6px;\r\n+  font-size: 12px;\r\n+  color: var(--van-text-color-3);\r\n+}\r\n+\r\n+\r\n+\r\n+.comparison-result {\r\n+  /* 确保对比组件居中显示 */\r\n+  width: 100%;\r\n+  margin: 0 auto;\r\n+  text-align: center; /* 居中对比组件 */\r\n+}\r\n+\r\n+.simple-result {\r\n+  text-align: center;\r\n+}\r\n+\r\n+.result-image {\r\n+  width: 100%;\r\n+  max-width: 400px;\r\n+  border-radius: 8px;\r\n+  margin-bottom: 16px;\r\n+}\r\n+\r\n+.result-actions {\r\n+  display: flex;\r\n+  gap: 12px;\r\n+  justify-content: center;\r\n+}\r\n+\r\n+/* 配置加载状态 */\r\n+.config-loading {\r\n+  display: flex;\r\n+  flex-direction: column;\r\n+  align-items: center;\r\n+  justify-content: center;\r\n+  padding: 40px 20px;\r\n+  gap: 12px;\r\n+  color: var(--van-text-color-2);\r\n+  font-size: 14px;\r\n+}\r\n+\r\n+/* 深色主题适配 */\r\n+@media (prefers-color-scheme: dark) {\r\n+  /* 深色主题样式 */\r\n+}\r\n+</style>\r\n+\r\n"
                },
                {
                    "date": 1753533576254,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,9 @@\n     :process-button-text=\"config.processButtonText\"\r\n     :process-button-icon=\"processButtonIcon\"\r\n     :progress=\"progress\"\r\n     :processing-title=\"config.processingTitle\"\r\n-    :processing-description=\"config.processingDescription\"\r\n+    :processing-description=\"dynamicProcessingDescription\"\r\n     :processing-info=\"processingInfo\"\r\n     :result-data=\"resultData\"\r\n     @login=\"$emit('login', $event)\"\r\n     @logout=\"$emit('logout', $event)\"\r\n"
                },
                {
                    "date": 1753533592853,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -160,8 +160,12 @@\n   progress: {\r\n     type: Number,\r\n     default: 0\r\n   },\r\n+  processingDescription: {\r\n+    type: String,\r\n+    default: ''\r\n+  },\r\n   processingInfo: {\r\n     type: Object,\r\n     default: () => ({})\r\n   },\r\n"
                },
                {
                    "date": 1753533606546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -201,8 +201,13 @@\n const isDevelopment = computed(() => {\r\n   return import.meta.env.DEV\r\n })\r\n \r\n+// 动态处理描述 - 优先使用传入的processingDescription，否则使用配置中的\r\n+const dynamicProcessingDescription = computed(() => {\r\n+  return props.processingDescription || config.value.processingDescription || ''\r\n+})\r\n+\r\n const canProcess = computed(() => {\r\n   // 检查上传面板\r\n   if (config.value.uploadPanels) {\r\n     for (const panel of config.value.uploadPanels) {\r\n"
                },
                {
                    "date": 1753533924264,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,9 +203,11 @@\n })\r\n \r\n // 动态处理描述 - 优先使用传入的processingDescription，否则使用配置中的\r\n const dynamicProcessingDescription = computed(() => {\r\n-  return props.processingDescription || config.value.processingDescription || ''\r\n+  const result = props.processingDescription || config.value.processingDescription || ''\r\n+  console.log('🔍 UnifiedImageProcessingTemplate - isProcessing:', props.isProcessing, 'processingDescription:', props.processingDescription, 'config.processingDescription:', config.value.processingDescription, '最终结果:', result)\r\n+  return result\r\n })\r\n \r\n const canProcess = computed(() => {\r\n   // 检查上传面板\r\n"
                },
                {
                    "date": 1753534055659,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -203,11 +203,9 @@\n })\r\n \r\n // 动态处理描述 - 优先使用传入的processingDescription，否则使用配置中的\r\n const dynamicProcessingDescription = computed(() => {\r\n-  const result = props.processingDescription || config.value.processingDescription || ''\r\n-  console.log('🔍 UnifiedImageProcessingTemplate - isProcessing:', props.isProcessing, 'processingDescription:', props.processingDescription, 'config.processingDescription:', config.value.processingDescription, '最终结果:', result)\r\n-  return result\r\n+  return props.processingDescription || config.value.processingDescription || ''\r\n })\r\n \r\n const canProcess = computed(() => {\r\n   // 检查上传面板\r\n"
                },
                {
                    "date": 1753539773627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,8 +9,9 @@\n     :can-process=\"canProcess\"\r\n     :show-upload-tips=\"false\"\r\n     :process-button-text=\"config.processButtonText\"\r\n     :process-button-icon=\"processButtonIcon\"\r\n+    :points-cost=\"config.pointsCost\"\r\n     :progress=\"progress\"\r\n     :processing-title=\"config.processingTitle\"\r\n     :processing-description=\"dynamicProcessingDescription\"\r\n     :processing-info=\"processingInfo\"\r\n"
                },
                {
                    "date": 1753540155439,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -157,8 +157,12 @@\n   isProcessing: {\r\n     type: Boolean,\r\n     default: false\r\n   },\r\n+  canProcess: {\r\n+    type: Boolean,\r\n+    default: false\r\n+  },\r\n   progress: {\r\n     type: Number,\r\n     default: 0\r\n   },\r\n"
                },
                {
                    "date": 1753540170805,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -212,8 +212,14 @@\n   return props.processingDescription || config.value.processingDescription || ''\r\n })\r\n \r\n const canProcess = computed(() => {\r\n+  // 如果父组件传入了canProcess，优先使用\r\n+  if (props.canProcess !== undefined) {\r\n+    return props.canProcess\r\n+  }\r\n+\r\n+  // 否则使用默认的检查逻辑\r\n   // 检查上传面板\r\n   if (config.value.uploadPanels) {\r\n     for (const panel of config.value.uploadPanels) {\r\n       const data = uploadData.value[panel.id]\r\n"
                },
                {
                    "date": 1753540314753,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -212,10 +212,10 @@\n   return props.processingDescription || config.value.processingDescription || ''\r\n })\r\n \r\n const canProcess = computed(() => {\r\n-  // 如果父组件传入了canProcess，优先使用\r\n-  if (props.canProcess !== undefined) {\r\n+  // 如果父组件明确传入了canProcess，优先使用\r\n+  if (typeof props.canProcess === 'boolean') {\r\n     return props.canProcess\r\n   }\r\n \r\n   // 否则使用默认的检查逻辑\r\n"
                },
                {
                    "date": 1753540331346,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -159,9 +159,9 @@\n     default: false\r\n   },\r\n   canProcess: {\r\n     type: Boolean,\r\n-    default: false\r\n+    default: undefined\r\n   },\r\n   progress: {\r\n     type: Number,\r\n     default: 0\r\n"
                },
                {
                    "date": 1753540342602,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -213,9 +213,9 @@\n })\r\n \r\n const canProcess = computed(() => {\r\n   // 如果父组件明确传入了canProcess，优先使用\r\n-  if (typeof props.canProcess === 'boolean') {\r\n+  if (props.canProcess !== undefined) {\r\n     return props.canProcess\r\n   }\r\n \r\n   // 否则使用默认的检查逻辑\r\n"
                },
                {
                    "date": 1753540393115,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -157,12 +157,8 @@\n   isProcessing: {\r\n     type: Boolean,\r\n     default: false\r\n   },\r\n-  canProcess: {\r\n-    type: Boolean,\r\n-    default: undefined\r\n-  },\r\n   progress: {\r\n     type: Number,\r\n     default: 0\r\n   },\r\n@@ -212,14 +208,8 @@\n   return props.processingDescription || config.value.processingDescription || ''\r\n })\r\n \r\n const canProcess = computed(() => {\r\n-  // 如果父组件明确传入了canProcess，优先使用\r\n-  if (props.canProcess !== undefined) {\r\n-    return props.canProcess\r\n-  }\r\n-\r\n-  // 否则使用默认的检查逻辑\r\n   // 检查上传面板\r\n   if (config.value.uploadPanels) {\r\n     for (const panel of config.value.uploadPanels) {\r\n       const data = uploadData.value[panel.id]\r\n"
                },
                {
                    "date": 1753541168652,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,8 @@\n     :can-process=\"canProcess\"\r\n     :show-upload-tips=\"false\"\r\n     :process-button-text=\"config.processButtonText\"\r\n     :process-button-icon=\"processButtonIcon\"\r\n-    :points-cost=\"config.pointsCost\"\r\n     :progress=\"progress\"\r\n     :processing-title=\"config.processingTitle\"\r\n     :processing-description=\"dynamicProcessingDescription\"\r\n     :processing-info=\"processingInfo\"\r\n"
                },
                {
                    "date": 1753542333771,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,8 +14,9 @@\n     :processing-title=\"config.processingTitle\"\r\n     :processing-description=\"dynamicProcessingDescription\"\r\n     :processing-info=\"processingInfo\"\r\n     :result-data=\"resultData\"\r\n+    :points-cost=\"config.pointsCost\"\r\n     @login=\"$emit('login', $event)\"\r\n     @logout=\"$emit('logout', $event)\"\r\n     @process=\"$emit('process')\"\r\n     @download=\"$emit('download', $event)\"\r\n"
                },
                {
                    "date": 1753543900338,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -145,16 +145,24 @@\n   titleIcon: {\r\n     type: [Object, String],\r\n     default: null\r\n   },\r\n+  titleIconName: {\r\n+    type: String,\r\n+    default: ''\r\n+  },\r\n   titleIconColor: {\r\n     type: String,\r\n     default: 'var(--van-primary-color)'\r\n   },\r\n   processButtonIcon: {\r\n     type: [Object, String],\r\n     default: null\r\n   },\r\n+  processButtonIconName: {\r\n+    type: String,\r\n+    default: ''\r\n+  },\r\n   isProcessing: {\r\n     type: Boolean,\r\n     default: false\r\n   },\r\n"
                },
                {
                    "date": 1753543912402,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -133,8 +133,9 @@\n   VantImageComparison\r\n } from '../mobile'\r\n import ImageComparison from '../ImageComparison.vue'\r\n import UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\r\n+import { SvgIcon } from '../icons'\r\n import { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\r\n \r\n // Props\r\n const props = defineProps({\r\n"
                },
                {
                    "date": 1753543926748,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -216,8 +216,41 @@\n const dynamicProcessingDescription = computed(() => {\r\n   return props.processingDescription || config.value.processingDescription || ''\r\n })\r\n \r\n+// 图标处理 - 支持组件对象和图标名称\r\n+const titleIcon = computed(() => {\r\n+  if (props.titleIcon) {\r\n+    return props.titleIcon\r\n+  }\r\n+  if (props.titleIconName) {\r\n+    return {\r\n+      render: () => h(SvgIcon, {\r\n+        name: props.titleIconName,\r\n+        size: 24,\r\n+        color: props.titleIconColor\r\n+      })\r\n+    }\r\n+  }\r\n+  return null\r\n+})\r\n+\r\n+const processButtonIcon = computed(() => {\r\n+  if (props.processButtonIcon) {\r\n+    return props.processButtonIcon\r\n+  }\r\n+  if (props.processButtonIconName) {\r\n+    return {\r\n+      render: () => h(SvgIcon, {\r\n+        name: props.processButtonIconName,\r\n+        size: 18,\r\n+        color: 'white'\r\n+      })\r\n+    }\r\n+  }\r\n+  return null\r\n+})\r\n+\r\n const canProcess = computed(() => {\r\n   // 检查上传面板\r\n   if (config.value.uploadPanels) {\r\n     for (const panel of config.value.uploadPanels) {\r\n"
                },
                {
                    "date": 1753543937383,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -125,9 +125,9 @@\n   </div>\r\n </template>\r\n \r\n <script setup>\r\n-import { ref, computed, watch, onMounted } from 'vue'\r\n+import { ref, computed, watch, onMounted, h } from 'vue'\r\n import { Toast } from 'vant'\r\n import {\r\n   AIProcessingTemplate,\r\n   VantImageComparison\r\n"
                }
            ],
            "date": 1752395027594,
            "name": "Commit-0",
            "content": "<template>\n  <AIProcessingTemplate\n    :title=\"config.title\"\n    :description=\"config.description\"\n    :title-icon=\"titleIcon\"\n    :title-icon-color=\"titleIconColor\"\n    :is-processing=\"isProcessing\"\n    :can-process=\"canProcess\"\n    :show-upload-tips=\"!canProcess\"\n    :process-button-text=\"config.processButtonText\"\n    :process-button-icon=\"processButtonIcon\"\n    :progress=\"progress\"\n    :processing-title=\"config.processingTitle\"\n    :processing-description=\"config.processingDescription\"\n    :processing-info=\"processingInfo\"\n    :result-data=\"resultData\"\n    @login=\"$emit('login', $event)\"\n    @logout=\"$emit('logout', $event)\"\n    @process=\"$emit('process')\"\n  >\n    <!-- 输入区域 -->\n    <template #inputs>\n      <!-- 图片上传面板 -->\n      <template v-if=\"config.uploadPanels\">\n        <UnifiedImageUploadPanel\n          v-for=\"panel in config.uploadPanels\"\n          :key=\"panel.id\"\n          v-model=\"uploadData[panel.id]\"\n          :config=\"panel\"\n          :disabled=\"isProcessing\"\n          @change=\"handleUploadChange(panel.id, $event)\"\n        />\n      </template>\n\n      <!-- 文本输入面板 -->\n      <template v-if=\"config.inputPanels\">\n        <div\n          v-for=\"panel in config.inputPanels\"\n          :key=\"panel.id\"\n          class=\"input-panel\"\n        >\n          <div class=\"panel-header\">\n            <van-icon\n              :name=\"panel.icon\"\n              :color=\"panel.iconColor\"\n              size=\"18\"\n            />\n            <span class=\"panel-title\">{{ panel.title }}</span>\n          </div>\n\n          <van-field\n            v-if=\"panel.type === 'text'\"\n            v-model=\"inputData[panel.id]\"\n            :placeholder=\"panel.placeholder\"\n            :rows=\"panel.rows\"\n            :maxlength=\"panel.maxLength\"\n            :disabled=\"isProcessing\"\n            type=\"textarea\"\n            show-word-limit\n            autosize\n            class=\"text-input\"\n            @input=\"handleInputChange(panel.id, $event)\"\n          />\n\n          <!-- 提示信息 -->\n          <div v-if=\"panel.tips && panel.tips.length > 0\" class=\"tips-section\">\n            <div v-for=\"(tip, index) in panel.tips\" :key=\"index\" class=\"tip-item\">\n              <van-icon name=\"info-o\" size=\"12\" color=\"var(--van-text-color-3)\" />\n              <span>{{ tip }}</span>\n            </div>\n          </div>\n        </div>\n      </template>\n    </template>\n\n\n\n    <!-- 结果展示 -->\n    <template #result=\"{ result }\">\n      <div v-if=\"config.resultConfig?.showComparison && config.resultConfig.comparisonType !== 'none'\">\n        <VantImageComparison\n          v-if=\"config.resultConfig.comparisonType === 'slider'\"\n          :original-image=\"originalImageForComparison\"\n          :result-image=\"result\"\n          :process-info=\"processingInfo\"\n          @reset=\"$emit('reset')\"\n          @download=\"$emit('download', $event)\"\n        />\n\n        <!-- 可以在这里添加其他对比类型的组件 -->\n      </div>\n\n      <!-- 无对比的结果显示 -->\n      <div v-else class=\"simple-result\">\n        <img :src=\"result\" alt=\"处理结果\" class=\"result-image\" />\n\n        <div class=\"result-actions\">\n          <van-button\n            v-if=\"config.resultConfig?.downloadEnabled\"\n            type=\"primary\"\n            size=\"large\"\n            @click=\"$emit('download', result)\"\n          >\n            <van-icon name=\"down\" />\n            下载图片\n          </van-button>\n\n          <van-button\n            v-if=\"config.resultConfig?.resetEnabled\"\n            size=\"large\"\n            @click=\"$emit('reset')\"\n          >\n            <van-icon name=\"replay\" />\n            重新生成\n          </van-button>\n        </div>\n      </div>\n    </template>\n  </AIProcessingTemplate>\n</template>\n\n<script setup>\nimport { ref, computed, watch, onMounted } from 'vue'\nimport { Toast } from 'vant'\nimport {\n  AIProcessingTemplate,\n  VantImageComparison\n} from '../mobile'\nimport UnifiedImageUploadPanel from '../common/UnifiedImageUploadPanel.vue'\nimport { getImageProcessingConfig, fetchImageProcessingConfigFromAPI } from '../../config/imageProcessingConfigs.js'\n\n// Props\nconst props = defineProps({\n  functionId: {\n    type: String,\n    required: true\n  },\n  titleIcon: {\n    type: [Object, String],\n    default: null\n  },\n  titleIconColor: {\n    type: String,\n    default: 'var(--van-primary-color)'\n  },\n  processButtonIcon: {\n    type: [Object, String],\n    default: null\n  },\n  isProcessing: {\n    type: Boolean,\n    default: false\n  },\n  progress: {\n    type: Number,\n    default: 0\n  },\n  processingInfo: {\n    type: Object,\n    default: () => ({})\n  },\n  resultData: {\n    type: String,\n    default: null\n  },\n  originalImageForComparison: {\n    type: String,\n    default: null\n  }\n})\n\n// Emits\nconst emit = defineEmits(['login', 'logout', 'process', 'reset', 'download', 'upload-change', 'input-change'])\n\n// 响应式数据\nconst config = ref({})\nconst uploadData = ref({})\nconst inputData = ref({})\n\n// 计算属性\nconst canProcess = computed(() => {\n  // 检查上传面板\n  if (config.value.uploadPanels) {\n    for (const panel of config.value.uploadPanels) {\n      const data = uploadData.value[panel.id]\n      if (panel.uploadType === 'single') {\n        if (!data && panel.minCount > 0) return false\n      } else {\n        const count = Array.isArray(data) ? data.length : 0\n        if (count < panel.minCount) return false\n      }\n    }\n  }\n\n  // 检查输入面板\n  if (config.value.inputPanels) {\n    for (const panel of config.value.inputPanels) {\n      const data = inputData.value[panel.id]\n      if (panel.required && (!data || data.trim() === '')) return false\n    }\n  }\n\n  return true\n})\n\n// 方法\nconst loadConfig = async () => {\n  try {\n    const loadedConfig = await fetchImageProcessingConfigFromAPI(props.functionId)\n    if (loadedConfig) {\n      config.value = loadedConfig\n      initializeData()\n    } else {\n      Toast.fail('加载配置失败')\n    }\n  } catch (error) {\n    console.error('加载配置失败:', error)\n    Toast.fail('加载配置失败')\n  }\n}\n\nconst initializeData = () => {\n  // 初始化上传数据\n  if (config.value.uploadPanels) {\n    config.value.uploadPanels.forEach(panel => {\n      uploadData.value[panel.id] = panel.uploadType === 'single' ? null : []\n    })\n  }\n\n  // 初始化输入数据\n  if (config.value.inputPanels) {\n    config.value.inputPanels.forEach(panel => {\n      inputData.value[panel.id] = ''\n    })\n  }\n}\n\nconst handleUploadChange = (panelId, data) => {\n  uploadData.value[panelId] = data\n  emit('upload-change', panelId, data)\n}\n\nconst handleInputChange = (panelId, data) => {\n  inputData.value[panelId] = data\n  emit('input-change', panelId, data)\n}\n\n// 状态相关方法\nconst getStatusIcon = (item) => {\n  const data = uploadData.value[item.key] || inputData.value[item.key]\n  const hasData = Array.isArray(data) ? data.length > 0 : !!data\n  return hasData ? item.icon : `${item.icon}-o`\n}\n\nconst getStatusColor = (item) => {\n  const data = uploadData.value[item.key] || inputData.value[item.key]\n  const hasData = Array.isArray(data) ? data.length > 0 : !!data\n  return hasData ? 'var(--van-success-color)' : 'var(--van-text-color-3)'\n}\n\nconst getStatusTextClass = (item) => {\n  const data = uploadData.value[item.key] || inputData.value[item.key]\n  const hasData = Array.isArray(data) ? data.length > 0 : !!data\n  return { 'text-success': hasData }\n}\n\nconst getStatusText = (item) => {\n  const data = uploadData.value[item.key] || inputData.value[item.key]\n\n  if (Array.isArray(data)) {\n    return item.countText ? item.countText.replace('{count}', data.length) :\n           (data.length > 0 ? item.successText : item.emptyText)\n  } else {\n    return data ? item.successText : item.emptyText\n  }\n}\n\n// 生命周期\nonMounted(() => {\n  loadConfig()\n})\n\n// 暴露数据给父组件\ndefineExpose({\n  uploadData,\n  inputData,\n  config\n})\n</script>\n\n<style scoped>\n.input-panel {\n  background: rgba(15, 15, 30, 0.6);\n  border-radius: 12px;\n  border: 1px solid rgba(30, 30, 60, 0.5);\n  padding: 16px;\n  margin-bottom: 16px;\n}\n\n.panel-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 16px;\n  color: var(--van-text-color, #f7f8fa);\n}\n\n.panel-title {\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.text-input {\n  --van-field-background: rgba(255, 255, 255, 0.05);\n  --van-field-border-color: rgba(255, 255, 255, 0.1);\n  --van-field-text-color: var(--van-text-color);\n}\n\n.tips-section {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  margin-top: 12px;\n}\n\n.tip-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 12px;\n  color: var(--van-text-color-3);\n}\n\n.upload-status {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 12px;\n  background: var(--van-background-2, #f7f8fa);\n  border-radius: 6px;\n}\n\n.status-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-size: 14px;\n  color: var(--van-text-color-2, #646566);\n}\n\n.text-success {\n  color: var(--van-success-color, #07c160);\n}\n\n.simple-result {\n  text-align: center;\n}\n\n.result-image {\n  width: 100%;\n  max-width: 400px;\n  border-radius: 8px;\n  margin-bottom: 16px;\n}\n\n.result-actions {\n  display: flex;\n  gap: 12px;\n  justify-content: center;\n}\n\n/* 深色主题适配 */\n@media (prefers-color-scheme: dark) {\n  .upload-status {\n    background: var(--van-background-2, #1e1e1e);\n  }\n}\n</style>\n"
        }
    ]
}