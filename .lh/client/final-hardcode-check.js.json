{
    "sourceFile": "client/final-hardcode-check.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1752328329263,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752328657778,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,11 +24,11 @@\n     description: 'ç¡¬ç¼–ç çš„ComfyUIæœåŠ¡å™¨URL (dzqgp58z0s)',\n     severity: 'critical'\n   },\n   {\n-    pattern: /abc1373d4ad648a3a81d0587fbe5534b/g,\n-    description: 'ç¡¬ç¼–ç çš„ComfyUIå®¢æˆ·ç«¯ID',\n-    severity: 'high'\n+    pattern: /[a-f0-9]{32}/g,\n+    description: 'å¯èƒ½çš„ç¡¬ç¼–ç å®¢æˆ·ç«¯IDï¼ˆ32ä½åå…­è¿›åˆ¶ï¼‰',\n+    severity: 'medium'\n   }\n ];\n \n // éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶æ‰©å±•å\n"
                }
            ],
            "date": 1752328329263,
            "name": "Commit-0",
            "content": "#!/usr/bin/env node\n\nimport fs from 'fs';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// éœ€è¦æ£€æŸ¥çš„ç¡¬ç¼–ç æ¨¡å¼\nconst HARDCODED_PATTERNS = [\n  {\n    pattern: /https:\\/\\/5gke5y9mzc-8188\\.cnb\\.run/g,\n    description: 'ç¡¬ç¼–ç çš„ComfyUIæœåŠ¡å™¨URL (5gke5y9mzc)',\n    severity: 'critical'\n  },\n  {\n    pattern: /https:\\/\\/hwf0p724ub-8188\\.cnb\\.run/g,\n    description: 'ç¡¬ç¼–ç çš„ComfyUIæœåŠ¡å™¨URL (hwf0p724ub)',\n    severity: 'critical'\n  },\n  {\n    pattern: /https:\\/\\/dzqgp58z0s-8188\\.cnb\\.run/g,\n    description: 'ç¡¬ç¼–ç çš„ComfyUIæœåŠ¡å™¨URL (dzqgp58z0s)',\n    severity: 'critical'\n  },\n  {\n    pattern: /abc1373d4ad648a3a81d0587fbe5534b/g,\n    description: 'ç¡¬ç¼–ç çš„ComfyUIå®¢æˆ·ç«¯ID',\n    severity: 'high'\n  }\n];\n\n// éœ€è¦æ£€æŸ¥çš„æ–‡ä»¶æ‰©å±•å\nconst FILE_EXTENSIONS = ['.js', '.vue', '.ts', '.jsx', '.tsx', '.html', '.env'];\n\n// éœ€è¦æ’é™¤çš„ç›®å½•\nconst EXCLUDE_DIRS = ['node_modules', '.git', 'dist', 'build', '.vscode'];\n\n// é€’å½’æ‰«æç›®å½•\nfunction scanDirectory(dir, results = []) {\n  const files = fs.readdirSync(dir);\n\n  for (const file of files) {\n    const filePath = path.join(dir, file);\n    const stat = fs.statSync(filePath);\n\n    if (stat.isDirectory()) {\n      if (!EXCLUDE_DIRS.includes(file)) {\n        scanDirectory(filePath, results);\n      }\n    } else {\n      const ext = path.extname(file);\n      if (FILE_EXTENSIONS.includes(ext)) {\n        results.push(filePath);\n      }\n    }\n  }\n\n  return results;\n}\n\n// æ£€æŸ¥æ–‡ä»¶ä¸­çš„ç¡¬ç¼–ç \nfunction checkFileForHardcoded(filePath) {\n  try {\n    const content = fs.readFileSync(filePath, 'utf8');\n    const issues = [];\n\n    for (const pattern of HARDCODED_PATTERNS) {\n      const matches = content.match(pattern.pattern);\n      if (matches) {\n        const lines = content.split('\\n');\n        const matchedLines = [];\n\n        lines.forEach((line, index) => {\n          if (pattern.pattern.test(line)) {\n            matchedLines.push({\n              lineNumber: index + 1,\n              content: line.trim()\n            });\n          }\n        });\n\n        issues.push({\n          pattern: pattern,\n          matches: matches.length,\n          lines: matchedLines\n        });\n      }\n    }\n\n    return issues;\n  } catch (error) {\n    console.error(`âŒ è¯»å–æ–‡ä»¶å¤±è´¥: ${filePath}`, error.message);\n    return [];\n  }\n}\n\n// ä¸»å‡½æ•°\nfunction main() {\n  console.log('ğŸ” å¼€å§‹æ‰«æç¡¬ç¼–ç é…ç½®...\\n');\n\n  const clientDir = path.join(__dirname);\n  const files = scanDirectory(clientDir);\n\n  console.log(`ğŸ“ æ‰«æ ${files.length} ä¸ªæ–‡ä»¶...\\n`);\n\n  let totalIssues = 0;\n  const issuesByFile = {};\n\n  for (const file of files) {\n    const issues = checkFileForHardcoded(file);\n    if (issues.length > 0) {\n      issuesByFile[file] = issues;\n      totalIssues += issues.reduce((sum, issue) => sum + issue.matches, 0);\n    }\n  }\n\n  // è¾“å‡ºç»“æœ\n  if (totalIssues === 0) {\n    console.log('ğŸ‰ æ­å–œï¼æœªå‘ç°ç¡¬ç¼–ç é…ç½®ï¼');\n    console.log('âœ… æ‰€æœ‰ComfyUIæœåŠ¡å™¨åœ°å€éƒ½å·²åŠ¨æ€åŒ–');\n    console.log('âœ… æ‰€æœ‰å®¢æˆ·ç«¯IDéƒ½å·²åŠ¨æ€åŒ–');\n    console.log('\\nğŸ“‹ æ£€æŸ¥çš„æ¨¡å¼:');\n    HARDCODED_PATTERNS.forEach(pattern => {\n      console.log(`   - ${pattern.description}`);\n    });\n  } else {\n    console.log(`âŒ å‘ç° ${totalIssues} ä¸ªç¡¬ç¼–ç é—®é¢˜:\\n`);\n\n    for (const [file, issues] of Object.entries(issuesByFile)) {\n      const relativePath = path.relative(clientDir, file);\n      console.log(`ğŸ“„ ${relativePath}:`);\n\n      for (const issue of issues) {\n        console.log(`   ğŸš¨ ${issue.pattern.description} (${issue.pattern.severity})`);\n        console.log(`      åŒ¹é…æ¬¡æ•°: ${issue.matches}`);\n\n        for (const line of issue.lines) {\n          console.log(`      ç¬¬${line.lineNumber}è¡Œ: ${line.content}`);\n        }\n        console.log('');\n      }\n    }\n\n    console.log('ğŸ”§ ä¿®å¤å»ºè®®:');\n    console.log('1. å°†ç¡¬ç¼–ç çš„URLæ›¿æ¢ä¸ºç¯å¢ƒå˜é‡æˆ–é…ç½®è·å–');\n    console.log('2. ä½¿ç”¨ import.meta.env.VITE_COMFYUI_SERVER_URL');\n    console.log('3. ä»æœåŠ¡å™¨APIåŠ¨æ€è·å–é…ç½®');\n    console.log('4. ç¡®ä¿æ‰€æœ‰é»˜è®¤å€¼éƒ½æ˜¯é€šç”¨çš„å ä½ç¬¦');\n  }\n\n  console.log(`\\nğŸ“Š æ‰«æç»Ÿè®¡:`);\n  console.log(`   æ–‡ä»¶æ€»æ•°: ${files.length}`);\n  console.log(`   é—®é¢˜æ–‡ä»¶: ${Object.keys(issuesByFile).length}`);\n  console.log(`   é—®é¢˜æ€»æ•°: ${totalIssues}`);\n\n  // è¿”å›é€€å‡ºç \n  process.exit(totalIssues > 0 ? 1 : 0);\n}\n\n// è¿è¡Œæ£€æŸ¥\nmain();\n"
        }
    ]
}