{
    "sourceFile": "server/DEPLOYMENT_CHECKLIST.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1753705812463,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1753705826025,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -19,9 +19,9 @@\n \n ### ğŸ“ æ–‡ä»¶å‡†å¤‡\n - [ ] æ‰€æœ‰å¿…éœ€æ–‡ä»¶å·²å‡†å¤‡å®Œæ¯•\n - [ ] `.env.production` é…ç½®æ­£ç¡®\n-- [ ] `deploy.sh` æœ‰æ‰§è¡Œæƒé™\n+- [ ] `deploy.bat` Windowsæ‰¹å¤„ç†è„šæœ¬å‡†å¤‡å°±ç»ª\n - [ ] æ’é™¤äº†å¼€å‘æ–‡ä»¶ (node_modules, .gitç­‰)\n \n ## ğŸš€ éƒ¨ç½²æ­¥éª¤\n \n"
                },
                {
                    "date": 1753705844499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,29 +25,29 @@\n \n ## ğŸš€ éƒ¨ç½²æ­¥éª¤\n \n ### 1. æ–‡ä»¶ä¸Šä¼ \n-- [ ] é€šè¿‡FTPä¸Šä¼ æ‰€æœ‰å¿…éœ€æ–‡ä»¶åˆ° `/var/www/aimagic/server/`\n+- [ ] é€šè¿‡FTPä¸Šä¼ æ‰€æœ‰å¿…éœ€æ–‡ä»¶åˆ° `C:\\inetpub\\wwwroot\\aimagic\\server\\`\n - [ ] éªŒè¯æ–‡ä»¶å®Œæ•´æ€§\n-- [ ] è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™\n+- [ ] ç¡®è®¤Windowsè·¯å¾„æ ¼å¼æ­£ç¡®\n \n ### 2. ç¯å¢ƒé…ç½®\n - [ ] å¤åˆ¶ `.env.production` ä¸ºç”Ÿäº§ç¯å¢ƒé…ç½®\n-- [ ] åˆ›å»ºå¿…è¦ç›®å½• (`logs/`, `uploads/`)\n-- [ ] è®¾ç½®ç›®å½•æƒé™\n+- [ ] åˆ›å»ºå¿…è¦ç›®å½• (`logs\\`, `uploads\\`)\n+- [ ] é…ç½®Windowsé˜²ç«å¢™è§„åˆ™\n \n ### 3. ä¾èµ–å®‰è£…\n - [ ] è¿è¡Œ `npm install --production`\n - [ ] éªŒè¯ä¾èµ–å®‰è£…æˆåŠŸ\n \n ### 4. æ•°æ®åº“åˆå§‹åŒ–\n-- [ ] è¿è¡Œ `node src/scripts/init-deployment-config.js`\n+- [ ] è¿è¡Œ `node src\\scripts\\init-deployment-config.js`\n - [ ] éªŒè¯ç³»ç»Ÿé…ç½®è¡¨åˆ›å»ºæˆåŠŸ\n \n ### 5. æœåŠ¡å¯åŠ¨\n - [ ] è¿è¡Œ `pm2 start ecosystem.config.js --env production`\n - [ ] éªŒè¯æœåŠ¡å¯åŠ¨æˆåŠŸ\n-- [ ] è®¾ç½®å¼€æœºè‡ªå¯ `pm2 startup && pm2 save`\n+- [ ] è®¾ç½®Windowså¼€æœºè‡ªå¯ `pm2-startup install && pm2 save`\n \n ## âœ… éƒ¨ç½²åéªŒè¯\n \n ### ğŸŒ æœåŠ¡çŠ¶æ€æ£€æŸ¥\n"
                }
            ],
            "date": 1753705812463,
            "name": "Commit-0",
            "content": "# AIMagic åç«¯æœåŠ¡éƒ¨ç½²æ£€æŸ¥æ¸…å• (Windows Server)\n\n## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥\n\n### ğŸ”§ è…¾è®¯äº‘WindowsæœåŠ¡å™¨ç¯å¢ƒ\n- [ ] Node.js >= 16.0.0 å·²å®‰è£… (ä» https://nodejs.org/ ä¸‹è½½)\n- [ ] PM2 å·²å®‰è£… (`npm install -g pm2`)\n- [ ] PM2 WindowsæœåŠ¡æ”¯æŒ (`npm install -g pm2-windows-startup`)\n- [ ] MySQL 8.0+ è¿è¡Œæ­£å¸¸\n- [ ] Windowsé˜²ç«å¢™å·²å¼€æ”¾ç«¯å£ 3007\n- [ ] æœåŠ¡å™¨ç£ç›˜ç©ºé—´å……è¶³ (>2GB)\n- [ ] è¿œç¨‹æ¡Œé¢è¿æ¥æ­£å¸¸\n\n### ğŸ—„ï¸ æ•°æ®åº“å‡†å¤‡\n- [ ] æ•°æ®åº“ `aimagic` å·²åˆ›å»º\n- [ ] æ•°æ®åº“ç”¨æˆ· `aimagic` å·²åˆ›å»ºå¹¶æˆæƒ\n- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡\n- [ ] å¿…è¦çš„è¡¨ç»“æ„å·²åˆ›å»º\n\n### ğŸ“ æ–‡ä»¶å‡†å¤‡\n- [ ] æ‰€æœ‰å¿…éœ€æ–‡ä»¶å·²å‡†å¤‡å®Œæ¯•\n- [ ] `.env.production` é…ç½®æ­£ç¡®\n- [ ] `deploy.sh` æœ‰æ‰§è¡Œæƒé™\n- [ ] æ’é™¤äº†å¼€å‘æ–‡ä»¶ (node_modules, .gitç­‰)\n\n## ğŸš€ éƒ¨ç½²æ­¥éª¤\n\n### 1. æ–‡ä»¶ä¸Šä¼ \n- [ ] é€šè¿‡FTPä¸Šä¼ æ‰€æœ‰å¿…éœ€æ–‡ä»¶åˆ° `/var/www/aimagic/server/`\n- [ ] éªŒè¯æ–‡ä»¶å®Œæ•´æ€§\n- [ ] è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™\n\n### 2. ç¯å¢ƒé…ç½®\n- [ ] å¤åˆ¶ `.env.production` ä¸ºç”Ÿäº§ç¯å¢ƒé…ç½®\n- [ ] åˆ›å»ºå¿…è¦ç›®å½• (`logs/`, `uploads/`)\n- [ ] è®¾ç½®ç›®å½•æƒé™\n\n### 3. ä¾èµ–å®‰è£…\n- [ ] è¿è¡Œ `npm install --production`\n- [ ] éªŒè¯ä¾èµ–å®‰è£…æˆåŠŸ\n\n### 4. æ•°æ®åº“åˆå§‹åŒ–\n- [ ] è¿è¡Œ `node src/scripts/init-deployment-config.js`\n- [ ] éªŒè¯ç³»ç»Ÿé…ç½®è¡¨åˆ›å»ºæˆåŠŸ\n\n### 5. æœåŠ¡å¯åŠ¨\n- [ ] è¿è¡Œ `pm2 start ecosystem.config.js --env production`\n- [ ] éªŒè¯æœåŠ¡å¯åŠ¨æˆåŠŸ\n- [ ] è®¾ç½®å¼€æœºè‡ªå¯ `pm2 startup && pm2 save`\n\n## âœ… éƒ¨ç½²åéªŒè¯\n\n### ğŸŒ æœåŠ¡çŠ¶æ€æ£€æŸ¥\n- [ ] `pm2 status` æ˜¾ç¤ºæœåŠ¡è¿è¡Œæ­£å¸¸\n- [ ] `curl http://localhost:3007/api/health` è¿”å›æ­£å¸¸\n- [ ] æœåŠ¡æ—¥å¿—æ— é”™è¯¯ `pm2 logs aimagic-server`\n\n### ğŸ”— APIæ¥å£æµ‹è¯•\n- [ ] å¥åº·æ£€æŸ¥æ¥å£: `GET /api/health`\n- [ ] é…ç½®æ¥å£: `GET /api/config`\n- [ ] ç”¨æˆ·æ³¨å†Œæ¥å£: `POST /api/auth/register`\n- [ ] ç”¨æˆ·ç™»å½•æ¥å£: `POST /api/auth/login`\n\n### ğŸ—„ï¸ æ•°æ®åº“è¿æ¥æµ‹è¯•\n- [ ] è¿è¡Œ `node src/scripts/health-check.js`\n- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸\n- [ ] ç³»ç»Ÿé…ç½®è¯»å–æ­£å¸¸\n\n### ğŸ”’ å®‰å…¨æ£€æŸ¥\n- [ ] `.env.production` æ–‡ä»¶æƒé™ä¸º 600\n- [ ] JWTå¯†é’¥å·²ä¿®æ”¹ä¸ºç”Ÿäº§ç¯å¢ƒå¯†é’¥\n- [ ] æ•°æ®åº“å¯†ç å®‰å…¨\n- [ ] CORSé…ç½®æ­£ç¡®\n\n## ğŸ› ï¸ å¸¸ç”¨ç®¡ç†å‘½ä»¤\n\n### PM2 è¿›ç¨‹ç®¡ç†\n```bash\n# æŸ¥çœ‹æœåŠ¡çŠ¶æ€\npm2 status\n\n# æŸ¥çœ‹å®æ—¶æ—¥å¿—\npm2 logs aimagic-server\n\n# é‡å¯æœåŠ¡\npm2 restart aimagic-server\n\n# åœæ­¢æœåŠ¡\npm2 stop aimagic-server\n\n# åˆ é™¤æœåŠ¡\npm2 delete aimagic-server\n\n# ç›‘æ§é¢æ¿\npm2 monit\n```\n\n### å¥åº·æ£€æŸ¥\n```bash\n# è¿è¡Œå¥åº·æ£€æŸ¥è„šæœ¬\nnode src/scripts/health-check.js\n\n# æ£€æŸ¥æœåŠ¡å“åº”\ncurl http://114.132.50.71:3007/api/health\n\n# æ£€æŸ¥æ•°æ®åº“è¿æ¥\nmysql -h 114.132.50.71 -u aimagic -p aimagic\n```\n\n### æ—¥å¿—æŸ¥çœ‹\n```bash\n# PM2 æ—¥å¿—\npm2 logs aimagic-server --lines 50\n\n# ç³»ç»Ÿæ—¥å¿—\ntail -f /var/log/syslog\n\n# åº”ç”¨æ—¥å¿—\ntail -f logs/combined.log\n```\n\n## ğŸš¨ æ•…éšœæ’é™¤\n\n### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ\n\n#### 1. ç«¯å£è¢«å ç”¨\n```bash\n# æŸ¥çœ‹ç«¯å£å ç”¨\nlsof -i :3007\nnetstat -tulpn | grep 3007\n\n# æ€æ­»å ç”¨è¿›ç¨‹\nkill -9 [PID]\n```\n\n#### 2. æ•°æ®åº“è¿æ¥å¤±è´¥\n- æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€: `systemctl status mysql`\n- éªŒè¯è¿æ¥ä¿¡æ¯: `.env.production` é…ç½®\n- æµ‹è¯•è¿æ¥: `mysql -h 114.132.50.71 -u aimagic -p`\n\n#### 3. æƒé™é—®é¢˜\n```bash\n# è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™\nchown -R www-data:www-data /var/www/aimagic/server\nchmod 755 /var/www/aimagic/server\nchmod 600 /var/www/aimagic/server/.env.production\n```\n\n#### 4. å†…å­˜ä¸è¶³\n```bash\n# æ£€æŸ¥å†…å­˜ä½¿ç”¨\nfree -h\ntop\n\n# é‡å¯æœåŠ¡é‡Šæ”¾å†…å­˜\npm2 restart aimagic-server\n```\n\n#### 5. ç£ç›˜ç©ºé—´ä¸è¶³\n```bash\n# æ£€æŸ¥ç£ç›˜ä½¿ç”¨\ndf -h\n\n# æ¸…ç†æ—¥å¿—æ–‡ä»¶\npm2 flush\nfind logs/ -name \"*.log\" -mtime +7 -delete\n```\n\n## ğŸ“ æŠ€æœ¯æ”¯æŒ\n\n### è”ç³»æ–¹å¼\n- æŠ€æœ¯æ”¯æŒ: [æŠ€æœ¯æ”¯æŒé‚®ç®±]\n- æ–‡æ¡£åœ°å€: [æ–‡æ¡£é“¾æ¥]\n- é—®é¢˜åé¦ˆ: [é—®é¢˜åé¦ˆåœ°å€]\n\n### ç›‘æ§å’ŒæŠ¥è­¦\n- æœåŠ¡ç›‘æ§: PM2 Monit\n- æ—¥å¿—ç›‘æ§: åº”ç”¨æ—¥å¿— + ç³»ç»Ÿæ—¥å¿—\n- æ€§èƒ½ç›‘æ§: å¥åº·æ£€æŸ¥è„šæœ¬\n\n---\n\n**éƒ¨ç½²å®Œæˆæ ‡å¿—**: æ‰€æœ‰æ£€æŸ¥é¡¹éƒ½å·²å®Œæˆ âœ…\n"
        }
    ]
}