{
    "sourceFile": "server/test-config-save.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1752404983491,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752406679426,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n \n   try {\n     // 1. å…ˆç™»å½•è·å–token\n     console.log('ğŸ” ç™»å½•è·å–token...');\n-    const loginResponse = await fetch('http://localhost:3007/api/admin-auth/login', {\n+    const loginResponse = await fetch('http://localhost:3009/api/admin-auth/login', {\n       method: 'POST',\n       headers: {\n         'Content-Type': 'application/json'\n       },\n"
                },
                {
                    "date": 1752406694161,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,9 +74,9 @@\n     ];\n \n     console.log('ğŸ“‹ è¦ä¿å­˜çš„é…ç½®:', configs);\n \n-    const saveResponse = await fetch('http://localhost:3007/api/admin/config', {\n+    const saveResponse = await fetch('http://localhost:3009/api/admin/config', {\n       method: 'POST',\n       headers: {\n         'Content-Type': 'application/json',\n         'Authorization': `Bearer ${token}`\n"
                }
            ],
            "date": 1752404983491,
            "name": "Commit-0",
            "content": "const fetch = require('node-fetch');\n\nasync function testConfigSave() {\n  console.log('ğŸ§ª æµ‹è¯•é…ç½®ä¿å­˜API...');\n\n  try {\n    // 1. å…ˆç™»å½•è·å–token\n    console.log('ğŸ” ç™»å½•è·å–token...');\n    const loginResponse = await fetch('http://localhost:3007/api/admin-auth/login', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username: 'admin',\n        password: 'admin123456'\n      })\n    });\n\n    const loginData = await loginResponse.json();\n    if (!loginData.success) {\n      console.log('âŒ ç™»å½•å¤±è´¥:', loginData.message);\n      return;\n    }\n\n    const token = loginData.data.token;\n    console.log('âœ… ç™»å½•æˆåŠŸï¼Œè·å¾—token');\n\n    // 2. æµ‹è¯•é…ç½®ä¿å­˜\n    console.log('\\nğŸ’¾ æµ‹è¯•é…ç½®ä¿å­˜...');\n    const configs = [\n      {\n        config_key: 'comfyui.server_url',\n        config_value: 'https://l6ur4u3zbw-8188.cnb.run/',\n        config_type: 'string',\n        config_group: 'comfyui'\n      },\n      {\n        config_key: 'comfyui.backup_servers',\n        config_value: 'https://backup1.com\\nhttps://backup2.com',\n        config_type: 'string',\n        config_group: 'comfyui'\n      },\n      {\n        config_key: 'comfyui.request_timeout',\n        config_value: '30000',\n        config_type: 'number',\n        config_group: 'comfyui'\n      },\n      {\n        config_key: 'comfyui.health_check_timeout',\n        config_value: '10000',\n        config_type: 'number',\n        config_group: 'comfyui'\n      },\n      {\n        config_key: 'comfyui.auto_switch',\n        config_value: 'true',\n        config_type: 'boolean',\n        config_group: 'comfyui'\n      },\n      {\n        config_key: 'comfyui.client_id',\n        config_value: 'test-client-123',\n        config_type: 'string',\n        config_group: 'comfyui'\n      },\n      {\n        config_key: 'comfyui.max_retries',\n        config_value: '3',\n        config_type: 'number',\n        config_group: 'comfyui'\n      }\n    ];\n\n    console.log('ğŸ“‹ è¦ä¿å­˜çš„é…ç½®:', configs);\n\n    const saveResponse = await fetch('http://localhost:3007/api/admin/config', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      },\n      body: JSON.stringify({ configs })\n    });\n\n    console.log('ğŸ“Š ä¿å­˜å“åº”çŠ¶æ€:', saveResponse.status);\n    console.log('ğŸ“Š ä¿å­˜å“åº”å¤´:', Object.fromEntries(saveResponse.headers.entries()));\n\n    const saveData = await saveResponse.text();\n    console.log('ğŸ“‹ ä¿å­˜å“åº”å†…å®¹:', saveData);\n\n    if (saveResponse.ok) {\n      console.log('âœ… é…ç½®ä¿å­˜æˆåŠŸ');\n      try {\n        const jsonData = JSON.parse(saveData);\n        console.log('ğŸ“Š è§£æåçš„å“åº”:', jsonData);\n      } catch (e) {\n        console.log('âš ï¸ å“åº”ä¸æ˜¯æœ‰æ•ˆçš„JSON');\n      }\n    } else {\n      console.log('âŒ é…ç½®ä¿å­˜å¤±è´¥');\n    }\n\n  } catch (error) {\n    console.error('âŒ æµ‹è¯•å¤±è´¥:', error.message);\n  }\n}\n\ntestConfigSave();\n"
        }
    ]
}