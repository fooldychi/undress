{
    "sourceFile": "admin/src/utils/request.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1752308146905,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752308727131,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n import router from '@/router'\n \n // åˆ›å»ºaxioså®ä¾‹\n const service = axios.create({\n-  baseURL: 'http://localhost:3006/api', // ç›´æ¥è®¿é—®åç«¯API\n+  baseURL: '/api', // ä½¿ç”¨ä»£ç†\n   timeout: 30000, // è¯·æ±‚è¶…æ—¶æ—¶é—´\n   headers: {\n     'Content-Type': 'application/json'\n   }\n"
                }
            ],
            "date": 1752308146905,
            "name": "Commit-0",
            "content": "import axios from 'axios'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { getToken, clearAuth } from './auth'\nimport router from '@/router'\n\n// åˆ›å»ºaxioså®ä¾‹\nconst service = axios.create({\n  baseURL: 'http://localhost:3006/api', // ç›´æ¥è®¿é—®åç«¯API\n  timeout: 30000, // è¯·æ±‚è¶…æ—¶æ—¶é—´\n  headers: {\n    'Content-Type': 'application/json'\n  }\n})\n\n// è¯·æ±‚æ‹¦æˆªå™¨\nservice.interceptors.request.use(\n  config => {\n    // æ·»åŠ tokenåˆ°è¯·æ±‚å¤´\n    const token = getToken()\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n    }\n\n    console.log('ğŸš€ å‘é€è¯·æ±‚:', config.method?.toUpperCase(), config.url)\n    return config\n  },\n  error => {\n    console.error('âŒ è¯·æ±‚é”™è¯¯:', error)\n    return Promise.reject(error)\n  }\n)\n\n// å“åº”æ‹¦æˆªå™¨\nservice.interceptors.response.use(\n  response => {\n    const res = response.data\n    console.log('âœ… æ”¶åˆ°å“åº”:', response.config.url, res)\n\n    // å¦‚æœæ˜¯æ–‡ä»¶ä¸‹è½½ï¼Œç›´æ¥è¿”å›\n    if (response.config.responseType === 'blob') {\n      return response\n    }\n\n    // æ£€æŸ¥ä¸šåŠ¡çŠ¶æ€ç \n    if (res.success === false) {\n      // ç‰¹æ®Šé”™è¯¯ç å¤„ç†\n      if (res.code === 'NO_TOKEN' || res.code === 'INVALID_TOKEN' || res.code === 'ADMIN_NOT_FOUND') {\n        ElMessageBox.confirm(\n          'ç™»å½•çŠ¶æ€å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•',\n          'ç³»ç»Ÿæç¤º',\n          {\n            confirmButtonText: 'é‡æ–°ç™»å½•',\n            cancelButtonText: 'å–æ¶ˆ',\n            type: 'warning'\n          }\n        ).then(() => {\n          clearAuth()\n          router.push('/login')\n        })\n        return Promise.reject(new Error(res.message || 'ç™»å½•å·²è¿‡æœŸ'))\n      }\n\n      // å…¶ä»–ä¸šåŠ¡é”™è¯¯\n      ElMessage.error(res.message || 'è¯·æ±‚å¤±è´¥')\n      return Promise.reject(new Error(res.message || 'è¯·æ±‚å¤±è´¥'))\n    }\n\n    return res\n  },\n  error => {\n    console.error('âŒ å“åº”é”™è¯¯:', error)\n\n    let message = 'ç½‘ç»œé”™è¯¯'\n\n    if (error.response) {\n      const { status, data } = error.response\n\n      switch (status) {\n        case 401:\n          message = 'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'\n          clearAuth()\n          router.push('/login')\n          break\n        case 403:\n          message = 'æƒé™ä¸è¶³'\n          break\n        case 404:\n          message = 'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨'\n          break\n        case 500:\n          message = 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'\n          break\n        default:\n          message = data?.message || `è¯·æ±‚å¤±è´¥ (${status})`\n      }\n    } else if (error.code === 'ECONNABORTED') {\n      message = 'è¯·æ±‚è¶…æ—¶'\n    } else if (error.message.includes('Network Error')) {\n      message = 'ç½‘ç»œè¿æ¥å¤±è´¥'\n    }\n\n    ElMessage.error(message)\n    return Promise.reject(error)\n  }\n)\n\nexport default service\n"
        }
    ]
}