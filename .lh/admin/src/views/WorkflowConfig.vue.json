{
    "sourceFile": "admin/src/views/WorkflowConfig.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 38,
            "patches": [
                {
                    "date": 1752812189560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1752812665309,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -188,9 +188,9 @@\n <script setup>\n import { ref, reactive, onMounted } from 'vue'\n import { ElMessage } from 'element-plus'\n import { Check } from '@element-plus/icons-vue'\n-import { getSystemConfig, saveSystemConfig } from '@/api/config'\n+import axios from 'axios'\n \n const loading = ref(false)\n const saving = ref(false)\n \n"
                },
                {
                    "date": 1752812700176,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -230,50 +230,62 @@\n // åŠ è½½é…ç½®\n const loadConfig = async () => {\n   loading.value = true\n   try {\n-    const response = await getSystemConfig()\n-    if (response.success && response.data) {\n-      const configData = response.data\n+    const response = await axios.get('/api/workflow-config')\n+    if (response.data.success && response.data.data) {\n+      const workflowData = response.data.data\n \n       // æ˜ å°„æ¢è„¸å·¥ä½œæµé…ç½®\n-      if (configData.workflow) {\n-        const workflowConfigs = configData.workflow\n+      if (workflowData.faceswap) {\n+        const faceswap = workflowData.faceswap\n+        config.faceswap.enabled = faceswap.enabled\n+        config.faceswap.name = faceswap.name\n+        config.faceswap.description = faceswap.description\n \n-        // æ¢è„¸å·¥ä½œæµ\n-        config.faceswap.enabled = getBooleanValue(workflowConfigs, 'workflow.faceswap.enabled', true)\n-        config.faceswap.name = getStringValue(workflowConfigs, 'workflow.faceswap.name', 'Face Swap 2.0')\n-        config.faceswap.description = getStringValue(workflowConfigs, 'workflow.faceswap.description', 'é«˜è´¨é‡äººè„¸æ›¿æ¢å·¥ä½œæµ')\n+        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1?.nodeId || '670'\n+        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2?.nodeId || '662'\n+        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3?.nodeId || '658'\n+        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4?.nodeId || '655'\n+        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image?.nodeId || '737'\n \n-        config.faceswap.input_nodes.face_photo_1 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_1', '670')\n-        config.faceswap.input_nodes.face_photo_2 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_2', '662')\n-        config.faceswap.input_nodes.face_photo_3 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_3', '658')\n-        config.faceswap.input_nodes.face_photo_4 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_4', '655')\n-        config.faceswap.input_nodes.target_image = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.target_image', '737')\n+        // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n+        const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n+        config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n \n-        config.faceswap.output_nodes.primary = getStringValue(workflowConfigs, 'workflow.faceswap.output_nodes.primary', '812')\n-        config.faceswap.output_nodes.secondary = getStringValue(workflowConfigs, 'workflow.faceswap.output_nodes.secondary', '813,746,710')\n+        const secondaryOutputs = faceswap.outputNodes\n+          .filter(node => node.key.startsWith('secondary'))\n+          .sort((a, b) => a.order - b.order)\n+          .map(node => node.nodeId)\n+        config.faceswap.output_nodes.secondary = secondaryOutputs.join(',')\n+      }\n \n-        // ä¸€é”®è¤ªè¡£å·¥ä½œæµ\n-        config.undress.enabled = getBooleanValue(workflowConfigs, 'workflow.undress.enabled', true)\n-        config.undress.name = getStringValue(workflowConfigs, 'workflow.undress.name', 'Undress AI')\n-        config.undress.description = getStringValue(workflowConfigs, 'workflow.undress.description', 'ä¸€é”®è¤ªè¡£AIå·¥ä½œæµ')\n+      // æ˜ å°„ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®\n+      if (workflowData.undress) {\n+        const undress = workflowData.undress\n+        config.undress.enabled = undress.enabled\n+        config.undress.name = undress.name\n+        config.undress.description = undress.description\n \n-        config.undress.input_nodes.main_image = getStringValue(workflowConfigs, 'workflow.undress.input_nodes.main_image', '49')\n-        config.undress.input_nodes.seed_node = getStringValue(workflowConfigs, 'workflow.undress.input_nodes.seed_node', '174')\n+        config.undress.input_nodes.main_image = undress.inputNodes.main_image?.nodeId || '49'\n+        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node?.nodeId || '174'\n \n-        config.undress.output_nodes.primary = getStringValue(workflowConfigs, 'workflow.undress.output_nodes.primary', '730')\n-        config.undress.output_nodes.secondary = getStringValue(workflowConfigs, 'workflow.undress.output_nodes.secondary', '812,813,746,710')\n-      } else {\n-        // å¦‚æœæ²¡æœ‰workflowåˆ†ç»„ï¼Œä½¿ç”¨é»˜è®¤å€¼\n-        console.warn('æœªæ‰¾åˆ°workflowé…ç½®åˆ†ç»„ï¼Œä½¿ç”¨é»˜è®¤å€¼')\n+        // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n+        const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n+        config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n+\n+        const secondaryOutputs = undress.outputNodes\n+          .filter(node => node.key.startsWith('secondary'))\n+          .sort((a, b) => a.order - b.order)\n+          .map(node => node.nodeId)\n+        config.undress.output_nodes.secondary = secondaryOutputs.join(',')\n       }\n \n       ElMessage.success('é…ç½®åŠ è½½æˆåŠŸ')\n     }\n   } catch (error) {\n     console.error('åŠ è½½é…ç½®å¤±è´¥:', error)\n-    ElMessage.error('åŠ è½½é…ç½®å¤±è´¥')\n+    ElMessage.error('åŠ è½½é…ç½®å¤±è´¥: ' + (error.response?.data?.message || error.message))\n   } finally {\n     loading.value = false\n   }\n }\n"
                },
                {
                    "date": 1752812731152,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -306,40 +306,58 @@\n // ä¿å­˜é…ç½®\n const saveConfig = async () => {\n   saving.value = true\n   try {\n-    const configs = [\n-      // æ¢è„¸å·¥ä½œæµé…ç½®\n-      { config_key: 'workflow.faceswap.enabled', config_value: config.faceswap.enabled.toString() },\n-      { config_key: 'workflow.faceswap.name', config_value: config.faceswap.name },\n-      { config_key: 'workflow.faceswap.description', config_value: config.faceswap.description },\n-      { config_key: 'workflow.faceswap.input_nodes.face_photo_1', config_value: config.faceswap.input_nodes.face_photo_1 },\n-      { config_key: 'workflow.faceswap.input_nodes.face_photo_2', config_value: config.faceswap.input_nodes.face_photo_2 },\n-      { config_key: 'workflow.faceswap.input_nodes.face_photo_3', config_value: config.faceswap.input_nodes.face_photo_3 },\n-      { config_key: 'workflow.faceswap.input_nodes.face_photo_4', config_value: config.faceswap.input_nodes.face_photo_4 },\n-      { config_key: 'workflow.faceswap.input_nodes.target_image', config_value: config.faceswap.input_nodes.target_image },\n-      { config_key: 'workflow.faceswap.output_nodes.primary', config_value: config.faceswap.output_nodes.primary },\n-      { config_key: 'workflow.faceswap.output_nodes.secondary', config_value: config.faceswap.output_nodes.secondary },\n+    // æ„å»ºæ›´æ–°æ•°æ®\n+    const workflows = {\n+      faceswap: {\n+        name: config.faceswap.name,\n+        description: config.faceswap.description,\n+        enabled: config.faceswap.enabled,\n+        inputNodes: {\n+          face_photo_1: config.faceswap.input_nodes.face_photo_1,\n+          face_photo_2: config.faceswap.input_nodes.face_photo_2,\n+          face_photo_3: config.faceswap.input_nodes.face_photo_3,\n+          face_photo_4: config.faceswap.input_nodes.face_photo_4,\n+          target_image: config.faceswap.input_nodes.target_image\n+        },\n+        outputNodes: [\n+          { key: 'primary', nodeId: config.faceswap.output_nodes.primary, order: 1 },\n+          ...config.faceswap.output_nodes.secondary.split(',').map((nodeId, index) => ({\n+            key: `secondary_${index + 1}`,\n+            nodeId: nodeId.trim(),\n+            order: index + 2\n+          })).filter(node => node.nodeId)\n+        ]\n+      },\n+      undress: {\n+        name: config.undress.name,\n+        description: config.undress.description,\n+        enabled: config.undress.enabled,\n+        inputNodes: {\n+          main_image: config.undress.input_nodes.main_image,\n+          seed_node: config.undress.input_nodes.seed_node\n+        },\n+        outputNodes: [\n+          { key: 'primary', nodeId: config.undress.output_nodes.primary, order: 1 },\n+          ...config.undress.output_nodes.secondary.split(',').map((nodeId, index) => ({\n+            key: `secondary_${index + 1}`,\n+            nodeId: nodeId.trim(),\n+            order: index + 2\n+          })).filter(node => node.nodeId)\n+        ]\n+      }\n+    }\n \n-      // ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®\n-      { config_key: 'workflow.undress.enabled', config_value: config.undress.enabled.toString() },\n-      { config_key: 'workflow.undress.name', config_value: config.undress.name },\n-      { config_key: 'workflow.undress.description', config_value: config.undress.description },\n-      { config_key: 'workflow.undress.input_nodes.main_image', config_value: config.undress.input_nodes.main_image },\n-      { config_key: 'workflow.undress.input_nodes.seed_node', config_value: config.undress.input_nodes.seed_node },\n-      { config_key: 'workflow.undress.output_nodes.primary', config_value: config.undress.output_nodes.primary },\n-      { config_key: 'workflow.undress.output_nodes.secondary', config_value: config.undress.output_nodes.secondary }\n-    ]\n-\n-    const response = await saveSystemConfig(configs)\n-    if (response.success) {\n+    const response = await axios.post('/api/workflow-config/batch-update', { workflows })\n+    if (response.data.success) {\n       ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ')\n     } else {\n-      throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n+      throw new Error(response.data.message || 'ä¿å­˜å¤±è´¥')\n     }\n   } catch (error) {\n     console.error('ä¿å­˜é…ç½®å¤±è´¥:', error)\n-    ElMessage.error('ä¿å­˜é…ç½®å¤±è´¥: ' + error.message)\n+    ElMessage.error('ä¿å­˜é…ç½®å¤±è´¥: ' + (error.response?.data?.message || error.message))\n   } finally {\n     saving.value = false\n   }\n }\n"
                },
                {
                    "date": 1752812747464,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -289,21 +289,10 @@\n     loading.value = false\n   }\n }\n \n-// è¾…åŠ©å‡½æ•°ï¼šä»é…ç½®æ•°ç»„ä¸­è·å–å­—ç¬¦ä¸²å€¼\n-const getStringValue = (configs, key, defaultValue) => {\n-  const item = configs.find(c => c.config_key === key)\n-  return item ? item.config_value : defaultValue\n-}\n+// åˆ é™¤ä¸éœ€è¦çš„è¾…åŠ©å‡½æ•°\n \n-// è¾…åŠ©å‡½æ•°ï¼šä»é…ç½®æ•°ç»„ä¸­è·å–å¸ƒå°”å€¼\n-const getBooleanValue = (configs, key, defaultValue) => {\n-  const item = configs.find(c => c.config_key === key)\n-  if (!item) return defaultValue\n-  return item.config_value === 'true' || item.config_value === true\n-}\n-\n // ä¿å­˜é…ç½®\n const saveConfig = async () => {\n   saving.value = true\n   try {\n"
                },
                {
                    "date": 1752816122284,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -188,9 +188,9 @@\n <script setup>\n import { ref, reactive, onMounted } from 'vue'\n import { ElMessage } from 'element-plus'\n import { Check } from '@element-plus/icons-vue'\n-import axios from 'axios'\n+import { getWorkflowConfig, batchUpdateWorkflowConfig } from '@/api/workflow'\n \n const loading = ref(false)\n const saving = ref(false)\n \n"
                },
                {
                    "date": 1752816139407,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -230,10 +230,10 @@\n // åŠ è½½é…ç½®\n const loadConfig = async () => {\n   loading.value = true\n   try {\n-    const response = await axios.get('/api/workflow-config')\n-    if (response.data.success && response.data.data) {\n+    const response = await getWorkflowConfig()\n+    if (response.success && response.data) {\n       const workflowData = response.data.data\n \n       // æ˜ å°„æ¢è„¸å·¥ä½œæµé…ç½®\n       if (workflowData.faceswap) {\n"
                },
                {
                    "date": 1752816154760,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -232,9 +232,9 @@\n   loading.value = true\n   try {\n     const response = await getWorkflowConfig()\n     if (response.success && response.data) {\n-      const workflowData = response.data.data\n+      const workflowData = response.data\n \n       // æ˜ å°„æ¢è„¸å·¥ä½œæµé…ç½®\n       if (workflowData.faceswap) {\n         const faceswap = workflowData.faceswap\n"
                },
                {
                    "date": 1752816170793,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -283,9 +283,9 @@\n       ElMessage.success('é…ç½®åŠ è½½æˆåŠŸ')\n     }\n   } catch (error) {\n     console.error('åŠ è½½é…ç½®å¤±è´¥:', error)\n-    ElMessage.error('åŠ è½½é…ç½®å¤±è´¥: ' + (error.response?.data?.message || error.message))\n+    ElMessage.error('åŠ è½½é…ç½®å¤±è´¥: ' + (error.message || 'æœªçŸ¥é”™è¯¯'))\n   } finally {\n     loading.value = false\n   }\n }\n"
                },
                {
                    "date": 1752816187030,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -336,13 +336,13 @@\n         ]\n       }\n     }\n \n-    const response = await axios.post('/api/workflow-config/batch-update', { workflows })\n-    if (response.data.success) {\n+    const response = await batchUpdateWorkflowConfig({ workflows })\n+    if (response.success) {\n       ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ')\n     } else {\n-      throw new Error(response.data.message || 'ä¿å­˜å¤±è´¥')\n+      throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n     }\n   } catch (error) {\n     console.error('ä¿å­˜é…ç½®å¤±è´¥:', error)\n     ElMessage.error('ä¿å­˜é…ç½®å¤±è´¥: ' + (error.response?.data?.message || error.message))\n"
                },
                {
                    "date": 1752816204655,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -344,9 +344,9 @@\n       throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n     }\n   } catch (error) {\n     console.error('ä¿å­˜é…ç½®å¤±è´¥:', error)\n-    ElMessage.error('ä¿å­˜é…ç½®å¤±è´¥: ' + (error.response?.data?.message || error.message))\n+    ElMessage.error('ä¿å­˜é…ç½®å¤±è´¥: ' + (error.message || 'æœªçŸ¥é”™è¯¯'))\n   } finally {\n     saving.value = false\n   }\n }\n"
                },
                {
                    "date": 1752816316277,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -188,9 +188,9 @@\n <script setup>\n import { ref, reactive, onMounted } from 'vue'\n import { ElMessage } from 'element-plus'\n import { Check } from '@element-plus/icons-vue'\n-import { getWorkflowConfig, batchUpdateWorkflowConfig } from '@/api/workflow'\n+import { getWorkflowConfig, getPublicWorkflowConfig, batchUpdateWorkflowConfig } from '@/api/workflow'\n \n const loading = ref(false)\n const saving = ref(false)\n \n"
                },
                {
                    "date": 1752816333791,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -230,9 +230,17 @@\n // åŠ è½½é…ç½®\n const loadConfig = async () => {\n   loading.value = true\n   try {\n-    const response = await getWorkflowConfig()\n+    // å…ˆå°è¯•ä½¿ç”¨ç®¡ç†å‘˜APIï¼Œå¦‚æœå¤±è´¥åˆ™ä½¿ç”¨å…¬å¼€API\n+    let response\n+    try {\n+      response = await getWorkflowConfig()\n+    } catch (error) {\n+      console.warn('ç®¡ç†å‘˜APIå¤±è´¥ï¼Œå°è¯•ä½¿ç”¨å…¬å¼€API:', error.message)\n+      response = await getPublicWorkflowConfig()\n+    }\n+\n     if (response.success && response.data) {\n       const workflowData = response.data\n \n       // æ˜ å°„æ¢è„¸å·¥ä½œæµé…ç½®\n"
                },
                {
                    "date": 1752823926847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,13 +249,13 @@\n         config.faceswap.enabled = faceswap.enabled\n         config.faceswap.name = faceswap.name\n         config.faceswap.description = faceswap.description\n \n-        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1?.nodeId || '670'\n-        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2?.nodeId || '662'\n-        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3?.nodeId || '658'\n-        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4?.nodeId || '655'\n-        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image?.nodeId || '737'\n+        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1 || '670'\n+        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2 || '662'\n+        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3 || '658'\n+        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4 || '655'\n+        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image || '737'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n         config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n"
                },
                {
                    "date": 1752824017361,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -273,10 +273,10 @@\n         config.undress.enabled = undress.enabled\n         config.undress.name = undress.name\n         config.undress.description = undress.description\n \n-        config.undress.input_nodes.main_image = undress.inputNodes.main_image?.nodeId || '49'\n-        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node?.nodeId || '174'\n+        config.undress.input_nodes.main_image = undress.inputNodes.main_image || '49'\n+        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node || '174'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n         config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n"
                },
                {
                    "date": 1752827154063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,13 +249,14 @@\n         config.faceswap.enabled = faceswap.enabled\n         config.faceswap.name = faceswap.name\n         config.faceswap.description = faceswap.description\n \n-        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1 || '670'\n-        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2 || '662'\n-        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3 || '658'\n-        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4 || '655'\n-        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image || '737'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡æ ¼å¼ {nodeId, description, enabled}\n+        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1?.nodeId || faceswap.inputNodes.face_photo_1 || '670'\n+        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2?.nodeId || faceswap.inputNodes.face_photo_2 || '662'\n+        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3?.nodeId || faceswap.inputNodes.face_photo_3 || '658'\n+        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4?.nodeId || faceswap.inputNodes.face_photo_4 || '655'\n+        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image?.nodeId || faceswap.inputNodes.target_image || '737'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n         config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n"
                },
                {
                    "date": 1752827182925,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,10 +274,11 @@\n         config.undress.enabled = undress.enabled\n         config.undress.name = undress.name\n         config.undress.description = undress.description\n \n-        config.undress.input_nodes.main_image = undress.inputNodes.main_image || '49'\n-        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node || '174'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡æ ¼å¼ {nodeId, description, enabled}\n+        config.undress.input_nodes.main_image = undress.inputNodes.main_image?.nodeId || undress.inputNodes.main_image || '49'\n+        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node?.nodeId || undress.inputNodes.seed_node || '174'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n         config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n"
                },
                {
                    "date": 1752828895123,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,14 +249,13 @@\n         config.faceswap.enabled = faceswap.enabled\n         config.faceswap.name = faceswap.name\n         config.faceswap.description = faceswap.description\n \n-        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡æ ¼å¼ {nodeId, description, enabled}\n-        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1?.nodeId || faceswap.inputNodes.face_photo_1 || '670'\n-        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2?.nodeId || faceswap.inputNodes.face_photo_2 || '662'\n-        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3?.nodeId || faceswap.inputNodes.face_photo_3 || '658'\n-        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4?.nodeId || faceswap.inputNodes.face_photo_4 || '655'\n-        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image?.nodeId || faceswap.inputNodes.target_image || '737'\n+        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1 || '670'\n+        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2 || '662'\n+        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3 || '658'\n+        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4 || '655'\n+        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image || '737'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n         config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n@@ -274,11 +273,10 @@\n         config.undress.enabled = undress.enabled\n         config.undress.name = undress.name\n         config.undress.description = undress.description\n \n-        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡æ ¼å¼ {nodeId, description, enabled}\n-        config.undress.input_nodes.main_image = undress.inputNodes.main_image?.nodeId || undress.inputNodes.main_image || '49'\n-        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node?.nodeId || undress.inputNodes.seed_node || '174'\n+        config.undress.input_nodes.main_image = undress.inputNodes.main_image || '49'\n+        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node || '174'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n         config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n"
                },
                {
                    "date": 1752829254455,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,13 +249,14 @@\n         config.faceswap.enabled = faceswap.enabled\n         config.faceswap.name = faceswap.name\n         config.faceswap.description = faceswap.description\n \n-        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1 || '670'\n-        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2 || '662'\n-        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3 || '658'\n-        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4 || '655'\n-        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image || '737'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡ï¼Œéœ€è¦æå–nodeId\n+        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1?.nodeId || faceswap.inputNodes.face_photo_1 || '670'\n+        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2?.nodeId || faceswap.inputNodes.face_photo_2 || '662'\n+        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3?.nodeId || faceswap.inputNodes.face_photo_3 || '658'\n+        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4?.nodeId || faceswap.inputNodes.face_photo_4 || '655'\n+        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image?.nodeId || faceswap.inputNodes.target_image || '737'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n         config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n"
                },
                {
                    "date": 1752829361402,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,10 +274,11 @@\n         config.undress.enabled = undress.enabled\n         config.undress.name = undress.name\n         config.undress.description = undress.description\n \n-        config.undress.input_nodes.main_image = undress.inputNodes.main_image || '49'\n-        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node || '174'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡ï¼Œéœ€è¦æå–nodeId\n+        config.undress.input_nodes.main_image = undress.inputNodes.main_image?.nodeId || undress.inputNodes.main_image || '49'\n+        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node?.nodeId || undress.inputNodes.seed_node || '174'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n         config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n"
                },
                {
                    "date": 1752829477972,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,14 +249,14 @@\n         config.faceswap.enabled = faceswap.enabled\n         config.faceswap.name = faceswap.name\n         config.faceswap.description = faceswap.description\n \n-        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡ï¼Œéœ€è¦æå–nodeId\n-        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1?.nodeId || faceswap.inputNodes.face_photo_1 || '670'\n-        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2?.nodeId || faceswap.inputNodes.face_photo_2 || '662'\n-        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3?.nodeId || faceswap.inputNodes.face_photo_3 || '658'\n-        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4?.nodeId || faceswap.inputNodes.face_photo_4 || '655'\n-        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image?.nodeId || faceswap.inputNodes.target_image || '737'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - APIç°åœ¨è¿”å›ç»Ÿä¸€çš„å­—ç¬¦ä¸²æ ¼å¼\n+        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1 || '670'\n+        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2 || '662'\n+        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3 || '658'\n+        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4 || '655'\n+        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image || '737'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n         config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n"
                },
                {
                    "date": 1752829536589,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,11 +274,11 @@\n         config.undress.enabled = undress.enabled\n         config.undress.name = undress.name\n         config.undress.description = undress.description\n \n-        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç®¡ç†å‘˜APIè¿”å›çš„æ˜¯å¯¹è±¡ï¼Œéœ€è¦æå–nodeId\n-        config.undress.input_nodes.main_image = undress.inputNodes.main_image?.nodeId || undress.inputNodes.main_image || '49'\n-        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node?.nodeId || undress.inputNodes.seed_node || '174'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - APIç°åœ¨è¿”å›ç»Ÿä¸€çš„å­—ç¬¦ä¸²æ ¼å¼\n+        config.undress.input_nodes.main_image = undress.inputNodes.main_image || '49'\n+        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node || '174'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n         config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n"
                },
                {
                    "date": 1752831243817,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,8 +301,27 @@\n }\n \n // åˆ é™¤ä¸éœ€è¦çš„è¾…åŠ©å‡½æ•°\n \n+// è¾…åŠ©å‡½æ•°ï¼šç¡®ä¿èŠ‚ç‚¹IDæ˜¯å­—ç¬¦ä¸²æ ¼å¼\n+const ensureStringNodeId = (nodeId) => {\n+  if (typeof nodeId === 'string') {\n+    // å¦‚æœå·²ç»æ˜¯å­—ç¬¦ä¸²ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯JSONæ ¼å¼\n+    try {\n+      const parsed = JSON.parse(nodeId)\n+      // å¦‚æœèƒ½è§£æä¸ºJSONï¼Œè¯´æ˜å¯èƒ½æ˜¯åµŒå¥—çš„JSONå­—ç¬¦ä¸²ï¼Œéœ€è¦æå–å®é™…çš„nodeId\n+      if (parsed && typeof parsed === 'object' && parsed.nodeId) {\n+        return ensureStringNodeId(parsed.nodeId) // é€’å½’å¤„ç†åµŒå¥—æƒ…å†µ\n+      }\n+      return nodeId // å¦‚æœè§£æåä¸æ˜¯é¢„æœŸæ ¼å¼ï¼Œè¿”å›åŸå­—ç¬¦ä¸²\n+    } catch (e) {\n+      // ä¸æ˜¯JSONæ ¼å¼ï¼Œç›´æ¥è¿”å›\n+      return nodeId\n+    }\n+  }\n+  return String(nodeId || '')\n+}\n+\n // ä¿å­˜é…ç½®\n const saveConfig = async () => {\n   saving.value = true\n   try {\n@@ -312,19 +331,23 @@\n         name: config.faceswap.name,\n         description: config.faceswap.description,\n         enabled: config.faceswap.enabled,\n         inputNodes: {\n-          face_photo_1: config.faceswap.input_nodes.face_photo_1,\n-          face_photo_2: config.faceswap.input_nodes.face_photo_2,\n-          face_photo_3: config.faceswap.input_nodes.face_photo_3,\n-          face_photo_4: config.faceswap.input_nodes.face_photo_4,\n-          target_image: config.faceswap.input_nodes.target_image\n+          face_photo_1: ensureStringNodeId(config.faceswap.input_nodes.face_photo_1),\n+          face_photo_2: ensureStringNodeId(config.faceswap.input_nodes.face_photo_2),\n+          face_photo_3: ensureStringNodeId(config.faceswap.input_nodes.face_photo_3),\n+          face_photo_4: ensureStringNodeId(config.faceswap.input_nodes.face_photo_4),\n+          target_image: ensureStringNodeId(config.faceswap.input_nodes.target_image)\n         },\n         outputNodes: [\n-          { key: 'primary', nodeId: config.faceswap.output_nodes.primary, order: 1 },\n+          {\n+            key: 'primary',\n+            nodeId: ensureStringNodeId(config.faceswap.output_nodes.primary),\n+            order: 1\n+          },\n           ...config.faceswap.output_nodes.secondary.split(',').map((nodeId, index) => ({\n             key: `secondary_${index + 1}`,\n-            nodeId: nodeId.trim(),\n+            nodeId: ensureStringNodeId(nodeId.trim()),\n             order: index + 2\n           })).filter(node => node.nodeId)\n         ]\n       },\n@@ -332,25 +355,33 @@\n         name: config.undress.name,\n         description: config.undress.description,\n         enabled: config.undress.enabled,\n         inputNodes: {\n-          main_image: config.undress.input_nodes.main_image,\n-          seed_node: config.undress.input_nodes.seed_node\n+          main_image: ensureStringNodeId(config.undress.input_nodes.main_image),\n+          seed_node: ensureStringNodeId(config.undress.input_nodes.seed_node)\n         },\n         outputNodes: [\n-          { key: 'primary', nodeId: config.undress.output_nodes.primary, order: 1 },\n+          {\n+            key: 'primary',\n+            nodeId: ensureStringNodeId(config.undress.output_nodes.primary),\n+            order: 1\n+          },\n           ...config.undress.output_nodes.secondary.split(',').map((nodeId, index) => ({\n             key: `secondary_${index + 1}`,\n-            nodeId: nodeId.trim(),\n+            nodeId: ensureStringNodeId(nodeId.trim()),\n             order: index + 2\n           })).filter(node => node.nodeId)\n         ]\n       }\n     }\n \n+    console.log('ğŸ“Š å‡†å¤‡ä¿å­˜çš„é…ç½®æ•°æ®:', JSON.stringify(workflows, null, 2))\n+\n     const response = await batchUpdateWorkflowConfig({ workflows })\n     if (response.success) {\n       ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ')\n+      // ä¿å­˜æˆåŠŸåé‡æ–°åŠ è½½é…ç½®ï¼Œç¡®ä¿æ˜¾ç¤ºæœ€æ–°æ•°æ®\n+      await loadConfig()\n     } else {\n       throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n     }\n   } catch (error) {\n"
                },
                {
                    "date": 1752831270644,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -249,23 +249,23 @@\n         config.faceswap.enabled = faceswap.enabled\n         config.faceswap.name = faceswap.name\n         config.faceswap.description = faceswap.description\n \n-        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - APIç°åœ¨è¿”å›ç»Ÿä¸€çš„å­—ç¬¦ä¸²æ ¼å¼\n-        config.faceswap.input_nodes.face_photo_1 = faceswap.inputNodes.face_photo_1 || '670'\n-        config.faceswap.input_nodes.face_photo_2 = faceswap.inputNodes.face_photo_2 || '662'\n-        config.faceswap.input_nodes.face_photo_3 = faceswap.inputNodes.face_photo_3 || '658'\n-        config.faceswap.input_nodes.face_photo_4 = faceswap.inputNodes.face_photo_4 || '655'\n-        config.faceswap.input_nodes.target_image = faceswap.inputNodes.target_image || '737'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç¡®ä¿èŠ‚ç‚¹IDæ˜¯çº¯å­—ç¬¦ä¸²æ ¼å¼\n+        config.faceswap.input_nodes.face_photo_1 = ensureStringNodeId(faceswap.inputNodes.face_photo_1) || '670'\n+        config.faceswap.input_nodes.face_photo_2 = ensureStringNodeId(faceswap.inputNodes.face_photo_2) || '662'\n+        config.faceswap.input_nodes.face_photo_3 = ensureStringNodeId(faceswap.inputNodes.face_photo_3) || '658'\n+        config.faceswap.input_nodes.face_photo_4 = ensureStringNodeId(faceswap.inputNodes.face_photo_4) || '655'\n+        config.faceswap.input_nodes.target_image = ensureStringNodeId(faceswap.inputNodes.target_image) || '737'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = faceswap.outputNodes.find(node => node.key === 'primary')\n-        config.faceswap.output_nodes.primary = primaryOutput?.nodeId || '812'\n+        config.faceswap.output_nodes.primary = ensureStringNodeId(primaryOutput?.nodeId) || '812'\n \n         const secondaryOutputs = faceswap.outputNodes\n           .filter(node => node.key.startsWith('secondary'))\n           .sort((a, b) => a.order - b.order)\n-          .map(node => node.nodeId)\n+          .map(node => ensureStringNodeId(node.nodeId))\n         config.faceswap.output_nodes.secondary = secondaryOutputs.join(',')\n       }\n \n       // æ˜ å°„ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®\n"
                },
                {
                    "date": 1752831300358,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -274,20 +274,20 @@\n         config.undress.enabled = undress.enabled\n         config.undress.name = undress.name\n         config.undress.description = undress.description\n \n-        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - APIç°åœ¨è¿”å›ç»Ÿä¸€çš„å­—ç¬¦ä¸²æ ¼å¼\n-        config.undress.input_nodes.main_image = undress.inputNodes.main_image || '49'\n-        config.undress.input_nodes.seed_node = undress.inputNodes.seed_node || '174'\n+        // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç¡®ä¿èŠ‚ç‚¹IDæ˜¯çº¯å­—ç¬¦ä¸²æ ¼å¼\n+        config.undress.input_nodes.main_image = ensureStringNodeId(undress.inputNodes.main_image) || '49'\n+        config.undress.input_nodes.seed_node = ensureStringNodeId(undress.inputNodes.seed_node) || '174'\n \n         // å¤„ç†è¾“å‡ºèŠ‚ç‚¹\n         const primaryOutput = undress.outputNodes.find(node => node.key === 'primary')\n-        config.undress.output_nodes.primary = primaryOutput?.nodeId || '730'\n+        config.undress.output_nodes.primary = ensureStringNodeId(primaryOutput?.nodeId) || '730'\n \n         const secondaryOutputs = undress.outputNodes\n           .filter(node => node.key.startsWith('secondary'))\n           .sort((a, b) => a.order - b.order)\n-          .map(node => node.nodeId)\n+          .map(node => ensureStringNodeId(node.nodeId))\n         config.undress.output_nodes.secondary = secondaryOutputs.join(',')\n       }\n \n       ElMessage.success('é…ç½®åŠ è½½æˆåŠŸ')\n"
                },
                {
                    "date": 1752831330981,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -226,8 +226,27 @@\n     }\n   }\n })\n \n+// è¾…åŠ©å‡½æ•°ï¼šç¡®ä¿èŠ‚ç‚¹IDæ˜¯å­—ç¬¦ä¸²æ ¼å¼\n+const ensureStringNodeId = (nodeId) => {\n+  if (typeof nodeId === 'string') {\n+    // å¦‚æœå·²ç»æ˜¯å­—ç¬¦ä¸²ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯JSONæ ¼å¼\n+    try {\n+      const parsed = JSON.parse(nodeId)\n+      // å¦‚æœèƒ½è§£æä¸ºJSONï¼Œè¯´æ˜å¯èƒ½æ˜¯åµŒå¥—çš„JSONå­—ç¬¦ä¸²ï¼Œéœ€è¦æå–å®é™…çš„nodeId\n+      if (parsed && typeof parsed === 'object' && parsed.nodeId) {\n+        return ensureStringNodeId(parsed.nodeId) // é€’å½’å¤„ç†åµŒå¥—æƒ…å†µ\n+      }\n+      return nodeId // å¦‚æœè§£æåä¸æ˜¯é¢„æœŸæ ¼å¼ï¼Œè¿”å›åŸå­—ç¬¦ä¸²\n+    } catch (e) {\n+      // ä¸æ˜¯JSONæ ¼å¼ï¼Œç›´æ¥è¿”å›\n+      return nodeId\n+    }\n+  }\n+  return String(nodeId || '')\n+}\n+\n // åŠ è½½é…ç½®\n const loadConfig = async () => {\n   loading.value = true\n   try {\n"
                },
                {
                    "date": 1752831348699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -320,27 +320,8 @@\n }\n \n // åˆ é™¤ä¸éœ€è¦çš„è¾…åŠ©å‡½æ•°\n \n-// è¾…åŠ©å‡½æ•°ï¼šç¡®ä¿èŠ‚ç‚¹IDæ˜¯å­—ç¬¦ä¸²æ ¼å¼\n-const ensureStringNodeId = (nodeId) => {\n-  if (typeof nodeId === 'string') {\n-    // å¦‚æœå·²ç»æ˜¯å­—ç¬¦ä¸²ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯JSONæ ¼å¼\n-    try {\n-      const parsed = JSON.parse(nodeId)\n-      // å¦‚æœèƒ½è§£æä¸ºJSONï¼Œè¯´æ˜å¯èƒ½æ˜¯åµŒå¥—çš„JSONå­—ç¬¦ä¸²ï¼Œéœ€è¦æå–å®é™…çš„nodeId\n-      if (parsed && typeof parsed === 'object' && parsed.nodeId) {\n-        return ensureStringNodeId(parsed.nodeId) // é€’å½’å¤„ç†åµŒå¥—æƒ…å†µ\n-      }\n-      return nodeId // å¦‚æœè§£æåä¸æ˜¯é¢„æœŸæ ¼å¼ï¼Œè¿”å›åŸå­—ç¬¦ä¸²\n-    } catch (e) {\n-      // ä¸æ˜¯JSONæ ¼å¼ï¼Œç›´æ¥è¿”å›\n-      return nodeId\n-    }\n-  }\n-  return String(nodeId || '')\n-}\n-\n // ä¿å­˜é…ç½®\n const saveConfig = async () => {\n   saving.value = true\n   try {\n"
                },
                {
                    "date": 1752831409566,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -318,10 +318,8 @@\n     loading.value = false\n   }\n }\n \n-// åˆ é™¤ä¸éœ€è¦çš„è¾…åŠ©å‡½æ•°\n-\n // ä¿å­˜é…ç½®\n const saveConfig = async () => {\n   saving.value = true\n   try {\n"
                },
                {
                    "date": 1752834012221,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -196,9 +196,9 @@\n \n // é…ç½®æ•°æ®\n const config = reactive({\n   faceswap: {\n-    enabled: true,\n+    enabled: false, // åˆå§‹çŠ¶æ€è®¾ä¸ºfalseï¼Œç­‰å¾…ä»æœåŠ¡å™¨åŠ è½½\n     name: '',\n     description: '',\n     input_nodes: {\n       face_photo_1: '',\n@@ -212,9 +212,9 @@\n       secondary: ''\n     }\n   },\n   undress: {\n-    enabled: true,\n+    enabled: false, // åˆå§‹çŠ¶æ€è®¾ä¸ºfalseï¼Œç­‰å¾…ä»æœåŠ¡å™¨åŠ è½½\n     name: '',\n     description: '',\n     input_nodes: {\n       main_image: '',\n"
                },
                {
                    "date": 1752834042818,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -264,11 +264,12 @@\n \n       // æ˜ å°„æ¢è„¸å·¥ä½œæµé…ç½®\n       if (workflowData.faceswap) {\n         const faceswap = workflowData.faceswap\n-        config.faceswap.enabled = faceswap.enabled\n-        config.faceswap.name = faceswap.name\n-        config.faceswap.description = faceswap.description\n+        // ç¡®ä¿enabledçŠ¶æ€æ­£ç¡®è®¾ç½®\n+        config.faceswap.enabled = Boolean(faceswap.enabled)\n+        config.faceswap.name = faceswap.name || ''\n+        config.faceswap.description = faceswap.description || ''\n \n         // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç¡®ä¿èŠ‚ç‚¹IDæ˜¯çº¯å­—ç¬¦ä¸²æ ¼å¼\n         config.faceswap.input_nodes.face_photo_1 = ensureStringNodeId(faceswap.inputNodes.face_photo_1) || '670'\n         config.faceswap.input_nodes.face_photo_2 = ensureStringNodeId(faceswap.inputNodes.face_photo_2) || '662'\n@@ -284,8 +285,10 @@\n           .filter(node => node.key.startsWith('secondary'))\n           .sort((a, b) => a.order - b.order)\n           .map(node => ensureStringNodeId(node.nodeId))\n         config.faceswap.output_nodes.secondary = secondaryOutputs.join(',')\n+\n+        console.log('ğŸ”„ æ¢è„¸å·¥ä½œæµçŠ¶æ€å·²è®¾ç½®ä¸º:', config.faceswap.enabled)\n       }\n \n       // æ˜ å°„ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®\n       if (workflowData.undress) {\n"
                },
                {
                    "date": 1752834062143,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,11 +292,12 @@\n \n       // æ˜ å°„ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®\n       if (workflowData.undress) {\n         const undress = workflowData.undress\n-        config.undress.enabled = undress.enabled\n-        config.undress.name = undress.name\n-        config.undress.description = undress.description\n+        // ç¡®ä¿enabledçŠ¶æ€æ­£ç¡®è®¾ç½®\n+        config.undress.enabled = Boolean(undress.enabled)\n+        config.undress.name = undress.name || ''\n+        config.undress.description = undress.description || ''\n \n         // å¤„ç†è¾“å…¥èŠ‚ç‚¹ - ç¡®ä¿èŠ‚ç‚¹IDæ˜¯çº¯å­—ç¬¦ä¸²æ ¼å¼\n         config.undress.input_nodes.main_image = ensureStringNodeId(undress.inputNodes.main_image) || '49'\n         config.undress.input_nodes.seed_node = ensureStringNodeId(undress.inputNodes.seed_node) || '174'\n@@ -309,8 +310,10 @@\n           .filter(node => node.key.startsWith('secondary'))\n           .sort((a, b) => a.order - b.order)\n           .map(node => ensureStringNodeId(node.nodeId))\n         config.undress.output_nodes.secondary = secondaryOutputs.join(',')\n+\n+        console.log('ğŸ‘— ä¸€é”®è¤ªè¡£å·¥ä½œæµçŠ¶æ€å·²è®¾ç½®ä¸º:', config.undress.enabled)\n       }\n \n       ElMessage.success('é…ç½®åŠ è½½æˆåŠŸ')\n     }\n"
                },
                {
                    "date": 1752834086051,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -382,10 +382,13 @@\n \n     const response = await batchUpdateWorkflowConfig({ workflows })\n     if (response.success) {\n       ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ')\n+      console.log('ğŸ’¾ é…ç½®ä¿å­˜æˆåŠŸï¼Œé‡æ–°åŠ è½½é…ç½®ä»¥ç¡®ä¿çŠ¶æ€åŒæ­¥')\n       // ä¿å­˜æˆåŠŸåé‡æ–°åŠ è½½é…ç½®ï¼Œç¡®ä¿æ˜¾ç¤ºæœ€æ–°æ•°æ®\n       await loadConfig()\n+      // å¼ºåˆ¶è§¦å‘å“åº”å¼æ›´æ–°\n+      console.log('ğŸ”„ å½“å‰çŠ¶æ€ - æ¢è„¸:', config.faceswap.enabled, 'ä¸€é”®è¤ªè¡£:', config.undress.enabled)\n     } else {\n       throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n     }\n   } catch (error) {\n"
                },
                {
                    "date": 1752834104121,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -185,9 +185,9 @@\n   </div>\n </template>\n \n <script setup>\n-import { ref, reactive, onMounted } from 'vue'\n+import { ref, reactive, onMounted, watch, nextTick } from 'vue'\n import { ElMessage } from 'element-plus'\n import { Check } from '@element-plus/icons-vue'\n import { getWorkflowConfig, getPublicWorkflowConfig, batchUpdateWorkflowConfig } from '@/api/workflow'\n \n"
                },
                {
                    "date": 1752834118273,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -398,8 +398,21 @@\n     saving.value = false\n   }\n }\n \n+// ç›‘å¬çŠ¶æ€å˜åŒ–ï¼Œç¡®ä¿UIåŒæ­¥\n+watch(\n+  () => [config.faceswap.enabled, config.undress.enabled],\n+  ([faceswapEnabled, undressEnabled]) => {\n+    console.log('ğŸ‘€ çŠ¶æ€å˜åŒ–ç›‘å¬ - æ¢è„¸:', faceswapEnabled, 'ä¸€é”®è¤ªè¡£:', undressEnabled)\n+    // å¼ºåˆ¶è§¦å‘DOMæ›´æ–°\n+    nextTick(() => {\n+      console.log('ğŸ”„ DOMå·²æ›´æ–°ï¼Œå½“å‰çŠ¶æ€ - æ¢è„¸:', config.faceswap.enabled, 'ä¸€é”®è¤ªè¡£:', config.undress.enabled)\n+    })\n+  },\n+  { deep: true }\n+)\n+\n onMounted(() => {\n   loadConfig()\n })\n </script>\n"
                },
                {
                    "date": 1752834138518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -245,8 +245,19 @@\n   }\n   return String(nodeId || '')\n }\n \n+// è°ƒè¯•å‡½æ•°ï¼šæ£€æŸ¥å½“å‰çŠ¶æ€\n+const debugCurrentState = () => {\n+  console.log('ğŸ” å½“å‰é…ç½®çŠ¶æ€è°ƒè¯•:')\n+  console.log('  æ¢è„¸å·¥ä½œæµ enabled:', config.faceswap.enabled, typeof config.faceswap.enabled)\n+  console.log('  ä¸€é”®è¤ªè¡£å·¥ä½œæµ enabled:', config.undress.enabled, typeof config.undress.enabled)\n+  console.log('  å®Œæ•´é…ç½®å¯¹è±¡:', JSON.stringify({\n+    faceswap: { enabled: config.faceswap.enabled },\n+    undress: { enabled: config.undress.enabled }\n+  }, null, 2))\n+}\n+\n // åŠ è½½é…ç½®\n const loadConfig = async () => {\n   loading.value = true\n   try {\n"
                },
                {
                    "date": 1752834162425,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -326,8 +326,10 @@\n         console.log('ğŸ‘— ä¸€é”®è¤ªè¡£å·¥ä½œæµçŠ¶æ€å·²è®¾ç½®ä¸º:', config.undress.enabled)\n       }\n \n       ElMessage.success('é…ç½®åŠ è½½æˆåŠŸ')\n+      // è°ƒè¯•å½“å‰çŠ¶æ€\n+      debugCurrentState()\n     }\n   } catch (error) {\n     console.error('åŠ è½½é…ç½®å¤±è´¥:', error)\n     ElMessage.error('åŠ è½½é…ç½®å¤±è´¥: ' + (error.message || 'æœªçŸ¥é”™è¯¯'))\n"
                },
                {
                    "date": 1752834178301,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -398,10 +398,10 @@\n       ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ')\n       console.log('ğŸ’¾ é…ç½®ä¿å­˜æˆåŠŸï¼Œé‡æ–°åŠ è½½é…ç½®ä»¥ç¡®ä¿çŠ¶æ€åŒæ­¥')\n       // ä¿å­˜æˆåŠŸåé‡æ–°åŠ è½½é…ç½®ï¼Œç¡®ä¿æ˜¾ç¤ºæœ€æ–°æ•°æ®\n       await loadConfig()\n-      // å¼ºåˆ¶è§¦å‘å“åº”å¼æ›´æ–°\n-      console.log('ğŸ”„ å½“å‰çŠ¶æ€ - æ¢è„¸:', config.faceswap.enabled, 'ä¸€é”®è¤ªè¡£:', config.undress.enabled)\n+      // è°ƒè¯•ä¿å­˜åçš„çŠ¶æ€\n+      debugCurrentState()\n     } else {\n       throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n     }\n   } catch (error) {\n"
                },
                {
                    "date": 1752834190848,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,8 +2,12 @@\n   <div class=\"workflow-config-page\">\n     <div class=\"page-header\">\n       <h1 class=\"page-title\">å·¥ä½œæµèŠ‚ç‚¹é…ç½®</h1>\n       <div class=\"header-actions\">\n+        <el-button @click=\"loadConfig\" :loading=\"loading\">\n+          <el-icon><Refresh /></el-icon>\n+          åˆ·æ–°é…ç½®\n+        </el-button>\n         <el-button type=\"primary\" @click=\"saveConfig\" :loading=\"saving\">\n           <el-icon><Check /></el-icon>\n           ä¿å­˜é…ç½®\n         </el-button>\n"
                },
                {
                    "date": 1752834204580,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -191,9 +191,9 @@\n \n <script setup>\n import { ref, reactive, onMounted, watch, nextTick } from 'vue'\n import { ElMessage } from 'element-plus'\n-import { Check } from '@element-plus/icons-vue'\n+import { Check, Refresh } from '@element-plus/icons-vue'\n import { getWorkflowConfig, getPublicWorkflowConfig, batchUpdateWorkflowConfig } from '@/api/workflow'\n \n const loading = ref(false)\n const saving = ref(false)\n"
                }
            ],
            "date": 1752812189560,
            "name": "Commit-0",
            "content": "<template>\n  <div class=\"workflow-config-page\">\n    <div class=\"page-header\">\n      <h1 class=\"page-title\">å·¥ä½œæµèŠ‚ç‚¹é…ç½®</h1>\n      <div class=\"header-actions\">\n        <el-button type=\"primary\" @click=\"saveConfig\" :loading=\"saving\">\n          <el-icon><Check /></el-icon>\n          ä¿å­˜é…ç½®\n        </el-button>\n      </div>\n    </div>\n\n    <el-row :gutter=\"20\">\n      <!-- æ¢è„¸å·¥ä½œæµé…ç½® -->\n      <el-col :span=\"12\">\n        <el-card>\n          <template #header>\n            <div class=\"card-header\">\n              <span>ğŸ”„ æ¢è„¸å·¥ä½œæµé…ç½®</span>\n              <el-tag :type=\"config.faceswap.enabled ? 'success' : 'danger'\" size=\"small\">\n                {{ config.faceswap.enabled ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨' }}\n              </el-tag>\n            </div>\n          </template>\n\n          <el-form\n            :model=\"config.faceswap\"\n            label-width=\"140px\"\n            v-loading=\"loading\"\n          >\n            <!-- åŸºç¡€é…ç½® -->\n            <el-form-item label=\"å¯ç”¨çŠ¶æ€\">\n              <el-switch v-model=\"config.faceswap.enabled\" />\n            </el-form-item>\n\n            <el-form-item label=\"å·¥ä½œæµåç§°\">\n              <el-input v-model=\"config.faceswap.name\" placeholder=\"Face Swap 2.0\" />\n            </el-form-item>\n\n            <el-form-item label=\"å·¥ä½œæµæè¿°\">\n              <el-input v-model=\"config.faceswap.description\" placeholder=\"é«˜è´¨é‡äººè„¸æ›¿æ¢å·¥ä½œæµ\" />\n            </el-form-item>\n\n            <el-divider content-position=\"left\">è¾“å…¥èŠ‚ç‚¹é…ç½®</el-divider>\n\n            <el-form-item label=\"äººè„¸ç…§ç‰‡1èŠ‚ç‚¹\">\n              <el-input v-model=\"config.faceswap.input_nodes.face_photo_1\" placeholder=\"670\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"äººè„¸ç…§ç‰‡2èŠ‚ç‚¹\">\n              <el-input v-model=\"config.faceswap.input_nodes.face_photo_2\" placeholder=\"662\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"äººè„¸ç…§ç‰‡3èŠ‚ç‚¹\">\n              <el-input v-model=\"config.faceswap.input_nodes.face_photo_3\" placeholder=\"658\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"äººè„¸ç…§ç‰‡4èŠ‚ç‚¹\">\n              <el-input v-model=\"config.faceswap.input_nodes.face_photo_4\" placeholder=\"655\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"ç›®æ ‡å›¾ç‰‡èŠ‚ç‚¹\">\n              <el-input v-model=\"config.faceswap.input_nodes.target_image\" placeholder=\"737\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-divider content-position=\"left\">è¾“å‡ºèŠ‚ç‚¹é…ç½®</el-divider>\n\n            <el-form-item label=\"ä¸»è¦è¾“å‡ºèŠ‚ç‚¹\">\n              <el-input v-model=\"config.faceswap.output_nodes.primary\" placeholder=\"812\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"å¤‡ç”¨è¾“å‡ºèŠ‚ç‚¹\">\n              <el-input\n                v-model=\"config.faceswap.output_nodes.secondary\"\n                placeholder=\"813,746,710\"\n                type=\"textarea\"\n                :rows=\"2\"\n              >\n              </el-input>\n              <div class=\"form-tip\">å¤šä¸ªèŠ‚ç‚¹IDç”¨é€—å·åˆ†éš”ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº</div>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n\n      <!-- ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½® -->\n      <el-col :span=\"12\">\n        <el-card>\n          <template #header>\n            <div class=\"card-header\">\n              <span>ğŸ‘— ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®</span>\n              <el-tag :type=\"config.undress.enabled ? 'success' : 'danger'\" size=\"small\">\n                {{ config.undress.enabled ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨' }}\n              </el-tag>\n            </div>\n          </template>\n\n          <el-form\n            :model=\"config.undress\"\n            label-width=\"140px\"\n            v-loading=\"loading\"\n          >\n            <!-- åŸºç¡€é…ç½® -->\n            <el-form-item label=\"å¯ç”¨çŠ¶æ€\">\n              <el-switch v-model=\"config.undress.enabled\" />\n            </el-form-item>\n\n            <el-form-item label=\"å·¥ä½œæµåç§°\">\n              <el-input v-model=\"config.undress.name\" placeholder=\"Undress AI\" />\n            </el-form-item>\n\n            <el-form-item label=\"å·¥ä½œæµæè¿°\">\n              <el-input v-model=\"config.undress.description\" placeholder=\"ä¸€é”®è¤ªè¡£AIå·¥ä½œæµ\" />\n            </el-form-item>\n\n            <el-divider content-position=\"left\">è¾“å…¥èŠ‚ç‚¹é…ç½®</el-divider>\n\n            <el-form-item label=\"ä¸»å›¾ç‰‡èŠ‚ç‚¹\">\n              <el-input v-model=\"config.undress.input_nodes.main_image\" placeholder=\"49\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"éšæœºç§å­èŠ‚ç‚¹\">\n              <el-input v-model=\"config.undress.input_nodes.seed_node\" placeholder=\"174\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-divider content-position=\"left\">è¾“å‡ºèŠ‚ç‚¹é…ç½®</el-divider>\n\n            <el-form-item label=\"ä¸»è¦è¾“å‡ºèŠ‚ç‚¹\">\n              <el-input v-model=\"config.undress.output_nodes.primary\" placeholder=\"730\">\n                <template #append>èŠ‚ç‚¹ID</template>\n              </el-input>\n            </el-form-item>\n\n            <el-form-item label=\"å¤‡ç”¨è¾“å‡ºèŠ‚ç‚¹\">\n              <el-input\n                v-model=\"config.undress.output_nodes.secondary\"\n                placeholder=\"812,813,746,710\"\n                type=\"textarea\"\n                :rows=\"2\"\n              >\n              </el-input>\n              <div class=\"form-tip\">å¤šä¸ªèŠ‚ç‚¹IDç”¨é€—å·åˆ†éš”ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº</div>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n    </el-row>\n\n    <!-- é…ç½®è¯´æ˜ -->\n    <el-card style=\"margin-top: 20px;\">\n      <template #header>\n        <span>ğŸ“– é…ç½®è¯´æ˜</span>\n      </template>\n      <el-alert\n        title=\"èŠ‚ç‚¹é…ç½®è¯´æ˜\"\n        type=\"info\"\n        :closable=\"false\"\n        show-icon\n      >\n        <ul>\n          <li><strong>è¾“å…¥èŠ‚ç‚¹ï¼š</strong>æŒ‡å®šå“ªäº›èŠ‚ç‚¹æ¥æ”¶ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡</li>\n          <li><strong>è¾“å‡ºèŠ‚ç‚¹ï¼š</strong>æŒ‡å®šå“ªäº›èŠ‚ç‚¹ä½œä¸ºæœ€ç»ˆç»“æœè¾“å‡º</li>\n          <li><strong>ä¸»è¦è¾“å‡ºèŠ‚ç‚¹ï¼š</strong>ä¼˜å…ˆæŸ¥æ‰¾çš„è¾“å‡ºèŠ‚ç‚¹</li>\n          <li><strong>å¤‡ç”¨è¾“å‡ºèŠ‚ç‚¹ï¼š</strong>å½“ä¸»è¦èŠ‚ç‚¹æ— è¾“å‡ºæ—¶ï¼ŒæŒ‰é¡ºåºæŸ¥æ‰¾çš„å¤‡ç”¨èŠ‚ç‚¹</li>\n          <li><strong>èŠ‚ç‚¹IDï¼š</strong>å¯¹åº”ComfyUIå·¥ä½œæµJSONæ–‡ä»¶ä¸­çš„èŠ‚ç‚¹ç¼–å·</li>\n        </ul>\n      </el-alert>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport { Check } from '@element-plus/icons-vue'\nimport { getSystemConfig, saveSystemConfig } from '@/api/config'\n\nconst loading = ref(false)\nconst saving = ref(false)\n\n// é…ç½®æ•°æ®\nconst config = reactive({\n  faceswap: {\n    enabled: true,\n    name: '',\n    description: '',\n    input_nodes: {\n      face_photo_1: '',\n      face_photo_2: '',\n      face_photo_3: '',\n      face_photo_4: '',\n      target_image: ''\n    },\n    output_nodes: {\n      primary: '',\n      secondary: ''\n    }\n  },\n  undress: {\n    enabled: true,\n    name: '',\n    description: '',\n    input_nodes: {\n      main_image: '',\n      seed_node: ''\n    },\n    output_nodes: {\n      primary: '',\n      secondary: ''\n    }\n  }\n})\n\n// åŠ è½½é…ç½®\nconst loadConfig = async () => {\n  loading.value = true\n  try {\n    const response = await getSystemConfig()\n    if (response.success && response.data) {\n      const configData = response.data\n\n      // æ˜ å°„æ¢è„¸å·¥ä½œæµé…ç½®\n      if (configData.workflow) {\n        const workflowConfigs = configData.workflow\n\n        // æ¢è„¸å·¥ä½œæµ\n        config.faceswap.enabled = getBooleanValue(workflowConfigs, 'workflow.faceswap.enabled', true)\n        config.faceswap.name = getStringValue(workflowConfigs, 'workflow.faceswap.name', 'Face Swap 2.0')\n        config.faceswap.description = getStringValue(workflowConfigs, 'workflow.faceswap.description', 'é«˜è´¨é‡äººè„¸æ›¿æ¢å·¥ä½œæµ')\n\n        config.faceswap.input_nodes.face_photo_1 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_1', '670')\n        config.faceswap.input_nodes.face_photo_2 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_2', '662')\n        config.faceswap.input_nodes.face_photo_3 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_3', '658')\n        config.faceswap.input_nodes.face_photo_4 = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.face_photo_4', '655')\n        config.faceswap.input_nodes.target_image = getStringValue(workflowConfigs, 'workflow.faceswap.input_nodes.target_image', '737')\n\n        config.faceswap.output_nodes.primary = getStringValue(workflowConfigs, 'workflow.faceswap.output_nodes.primary', '812')\n        config.faceswap.output_nodes.secondary = getStringValue(workflowConfigs, 'workflow.faceswap.output_nodes.secondary', '813,746,710')\n\n        // ä¸€é”®è¤ªè¡£å·¥ä½œæµ\n        config.undress.enabled = getBooleanValue(workflowConfigs, 'workflow.undress.enabled', true)\n        config.undress.name = getStringValue(workflowConfigs, 'workflow.undress.name', 'Undress AI')\n        config.undress.description = getStringValue(workflowConfigs, 'workflow.undress.description', 'ä¸€é”®è¤ªè¡£AIå·¥ä½œæµ')\n\n        config.undress.input_nodes.main_image = getStringValue(workflowConfigs, 'workflow.undress.input_nodes.main_image', '49')\n        config.undress.input_nodes.seed_node = getStringValue(workflowConfigs, 'workflow.undress.input_nodes.seed_node', '174')\n\n        config.undress.output_nodes.primary = getStringValue(workflowConfigs, 'workflow.undress.output_nodes.primary', '730')\n        config.undress.output_nodes.secondary = getStringValue(workflowConfigs, 'workflow.undress.output_nodes.secondary', '812,813,746,710')\n      } else {\n        // å¦‚æœæ²¡æœ‰workflowåˆ†ç»„ï¼Œä½¿ç”¨é»˜è®¤å€¼\n        console.warn('æœªæ‰¾åˆ°workflowé…ç½®åˆ†ç»„ï¼Œä½¿ç”¨é»˜è®¤å€¼')\n      }\n\n      ElMessage.success('é…ç½®åŠ è½½æˆåŠŸ')\n    }\n  } catch (error) {\n    console.error('åŠ è½½é…ç½®å¤±è´¥:', error)\n    ElMessage.error('åŠ è½½é…ç½®å¤±è´¥')\n  } finally {\n    loading.value = false\n  }\n}\n\n// è¾…åŠ©å‡½æ•°ï¼šä»é…ç½®æ•°ç»„ä¸­è·å–å­—ç¬¦ä¸²å€¼\nconst getStringValue = (configs, key, defaultValue) => {\n  const item = configs.find(c => c.config_key === key)\n  return item ? item.config_value : defaultValue\n}\n\n// è¾…åŠ©å‡½æ•°ï¼šä»é…ç½®æ•°ç»„ä¸­è·å–å¸ƒå°”å€¼\nconst getBooleanValue = (configs, key, defaultValue) => {\n  const item = configs.find(c => c.config_key === key)\n  if (!item) return defaultValue\n  return item.config_value === 'true' || item.config_value === true\n}\n\n// ä¿å­˜é…ç½®\nconst saveConfig = async () => {\n  saving.value = true\n  try {\n    const configs = [\n      // æ¢è„¸å·¥ä½œæµé…ç½®\n      { config_key: 'workflow.faceswap.enabled', config_value: config.faceswap.enabled.toString() },\n      { config_key: 'workflow.faceswap.name', config_value: config.faceswap.name },\n      { config_key: 'workflow.faceswap.description', config_value: config.faceswap.description },\n      { config_key: 'workflow.faceswap.input_nodes.face_photo_1', config_value: config.faceswap.input_nodes.face_photo_1 },\n      { config_key: 'workflow.faceswap.input_nodes.face_photo_2', config_value: config.faceswap.input_nodes.face_photo_2 },\n      { config_key: 'workflow.faceswap.input_nodes.face_photo_3', config_value: config.faceswap.input_nodes.face_photo_3 },\n      { config_key: 'workflow.faceswap.input_nodes.face_photo_4', config_value: config.faceswap.input_nodes.face_photo_4 },\n      { config_key: 'workflow.faceswap.input_nodes.target_image', config_value: config.faceswap.input_nodes.target_image },\n      { config_key: 'workflow.faceswap.output_nodes.primary', config_value: config.faceswap.output_nodes.primary },\n      { config_key: 'workflow.faceswap.output_nodes.secondary', config_value: config.faceswap.output_nodes.secondary },\n\n      // ä¸€é”®è¤ªè¡£å·¥ä½œæµé…ç½®\n      { config_key: 'workflow.undress.enabled', config_value: config.undress.enabled.toString() },\n      { config_key: 'workflow.undress.name', config_value: config.undress.name },\n      { config_key: 'workflow.undress.description', config_value: config.undress.description },\n      { config_key: 'workflow.undress.input_nodes.main_image', config_value: config.undress.input_nodes.main_image },\n      { config_key: 'workflow.undress.input_nodes.seed_node', config_value: config.undress.input_nodes.seed_node },\n      { config_key: 'workflow.undress.output_nodes.primary', config_value: config.undress.output_nodes.primary },\n      { config_key: 'workflow.undress.output_nodes.secondary', config_value: config.undress.output_nodes.secondary }\n    ]\n\n    const response = await saveSystemConfig(configs)\n    if (response.success) {\n      ElMessage.success('é…ç½®ä¿å­˜æˆåŠŸ')\n    } else {\n      throw new Error(response.message || 'ä¿å­˜å¤±è´¥')\n    }\n  } catch (error) {\n    console.error('ä¿å­˜é…ç½®å¤±è´¥:', error)\n    ElMessage.error('ä¿å­˜é…ç½®å¤±è´¥: ' + error.message)\n  } finally {\n    saving.value = false\n  }\n}\n\nonMounted(() => {\n  loadConfig()\n})\n</script>\n\n<style scoped>\n.workflow-config-page {\n  padding: 20px;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.page-title {\n  margin: 0;\n  font-size: 24px;\n  font-weight: 600;\n  color: #303133;\n}\n\n.header-actions {\n  display: flex;\n  gap: 12px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.form-tip {\n  font-size: 12px;\n  color: #909399;\n  margin-top: 4px;\n}\n\n:deep(.el-divider__text) {\n  font-weight: 600;\n  color: #409eff;\n}\n</style>\n"
        }
    ]
}